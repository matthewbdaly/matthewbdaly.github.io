<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.e3adbc0bd75eaf448024.css" data-identity="gatsby-global-css">/*! tailwindcss v2.2.4 | MIT License | https://tailwindcss.com */

/*! modern-normalize v1.1.0 | MIT License | https://github.com/sindresorhus/modern-normalize */html{-webkit-text-size-adjust:100%;line-height:1.15;-moz-tab-size:4;-o-tab-size:4;tab-size:4}body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;margin:0}hr{color:inherit;height:0}abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,select{text-transform:none}[type=button],[type=submit],button{-webkit-appearance:button}legend{padding:0}progress{vertical-align:baseline}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}button{background-color:transparent;background-image:none}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}html{font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5}body{font-family:inherit;line-height:inherit}*,:after,:before{border:0 solid;box-sizing:border-box}hr{border-top-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{color:inherit;line-height:inherit;padding:0}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}*,:after,:before{--tw-border-opacity:1;border-color:rgba(229,231,235,var(--tw-border-opacity))}.float-right{float:right}.float-left{float:left}.float-none{float:none}.clear-both{clear:both}.m-0{margin:0}.mx-0{margin-left:0;margin-right:0}.mx-auto{margin-left:auto;margin-right:auto}.my-2{margin-bottom:.5rem;margin-top:.5rem}.my-4{margin-bottom:1rem;margin-top:1rem}.mt-2{margin-top:.5rem}.mt-16{margin-top:4rem}.mr-2{margin-right:.5rem}.mr-8{margin-right:2rem}.-mb-4{margin-bottom:-1rem}.-mb-8{margin-bottom:-2rem}.box-border{box-sizing:border-box}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.table{display:table}.hidden{display:none}.h-2{height:.5rem}.h-4{height:1rem}.min-h-screen{min-height:100vh}.w-1\/2{width:50%}.w-1\/3{width:33.333333%}.w-1\/4{width:25%}.w-3\/4{width:75%}.w-full{width:100%}.flex-grow{flex-grow:1}@-webkit-keyframes spin{to{transform:rotate(1turn)}}@keyframes spin{to{transform:rotate(1turn)}}@-webkit-keyframes ping{75%,to{opacity:0;transform:scale(2)}}@keyframes ping{75%,to{opacity:0;transform:scale(2)}}@-webkit-keyframes pulse{50%{opacity:.5}}@keyframes pulse{50%{opacity:.5}}@-webkit-keyframes bounce{0%,to{-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1);transform:translateY(-25%)}50%{-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1);transform:none}}@keyframes bounce{0%,to{-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1);transform:translateY(-25%)}50%{-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1);transform:none}}.list-disc{list-style-type:disc}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.justify-center{justify-content:center}.space-y-8>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(2rem*var(--tw-space-y-reverse));margin-top:calc(2rem*(1 - var(--tw-space-y-reverse)))}.space-y-16>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(4rem*var(--tw-space-y-reverse));margin-top:calc(4rem*(1 - var(--tw-space-y-reverse)))}.space-y-32>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(8rem*var(--tw-space-y-reverse));margin-top:calc(8rem*(1 - var(--tw-space-y-reverse)))}.divide-y>:not([hidden])~:not([hidden]){--tw-divide-y-reverse:0;border-bottom-width:calc(1px*var(--tw-divide-y-reverse));border-top-width:calc(1px*(1 - var(--tw-divide-y-reverse)))}.divide-gray-800>:not([hidden])~:not([hidden]){--tw-divide-opacity:1;border-color:rgba(31,41,55,var(--tw-divide-opacity))}@media (prefers-color-scheme:dark){.dark\:divide-gray-200>:not([hidden])~:not([hidden]){--tw-divide-opacity:1;border-color:rgba(229,231,235,var(--tw-divide-opacity))}}.overflow-x-auto{overflow-x:auto}.overflow-x-scroll{overflow-x:scroll}.rounded-full{border-radius:9999px}.rounded-t-lg{border-top-left-radius:.5rem;border-top-right-radius:.5rem}.border-2{border-width:2px}.border-b-2{border-bottom-width:2px}.border-b-4{border-bottom-width:4px}.border-l-8{border-left-width:8px}.border-transparent{border-color:transparent}.border-gray-100{--tw-border-opacity:1;border-color:rgba(243,244,246,var(--tw-border-opacity))}.border-gray-500{--tw-border-opacity:1;border-color:rgba(107,114,128,var(--tw-border-opacity))}.border-gray-800{--tw-border-opacity:1;border-color:rgba(31,41,55,var(--tw-border-opacity))}.border-green-400,.hover\:border-green-400:hover{--tw-border-opacity:1;border-color:rgba(52,211,153,var(--tw-border-opacity))}.focus\:border-blue-300:focus{--tw-border-opacity:1;border-color:rgba(147,197,253,var(--tw-border-opacity))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgba(249,250,251,var(--tw-bg-opacity))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgba(243,244,246,var(--tw-bg-opacity))}.bg-gray-300{--tw-bg-opacity:1;background-color:rgba(209,213,219,var(--tw-bg-opacity))}.bg-gray-800{--tw-bg-opacity:1;background-color:rgba(31,41,55,var(--tw-bg-opacity))}.bg-purple-200{--tw-bg-opacity:1;background-color:rgba(221,214,254,var(--tw-bg-opacity))}.hover\:bg-gray-200:hover{--tw-bg-opacity:1;background-color:rgba(229,231,235,var(--tw-bg-opacity))}.hover\:bg-purple-800:hover{--tw-bg-opacity:1;background-color:rgba(91,33,182,var(--tw-bg-opacity))}@media (prefers-color-scheme:dark){.dark\:bg-gray-700{--tw-bg-opacity:1;background-color:rgba(55,65,81,var(--tw-bg-opacity))}.dark\:bg-gray-800{--tw-bg-opacity:1;background-color:rgba(31,41,55,var(--tw-bg-opacity))}.dark\:bg-gray-900{--tw-bg-opacity:1;background-color:rgba(17,24,39,var(--tw-bg-opacity))}.dark\:hover\:bg-gray-800:hover{--tw-bg-opacity:1;background-color:rgba(31,41,55,var(--tw-bg-opacity))}}.bg-gradient-to-r{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.bg-gradient-to-b{background-image:linear-gradient(to bottom,var(--tw-gradient-stops))}.from-gray-200{--tw-gradient-from:#e5e7eb;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to,rgba(229,231,235,0))}.from-green-400{--tw-gradient-from:#34d399;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to,rgba(52,211,153,0))}.via-blue-500{--tw-gradient-stops:var(--tw-gradient-from),#3b82f6,var(--tw-gradient-to,rgba(59,130,246,0))}.to-gray-300{--tw-gradient-to:#d1d5db}.to-purple-500{--tw-gradient-to:#8b5cf6}.p-2{padding:.5rem}.p-4{padding:1rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-4{padding-left:1rem;padding-right:1rem}.px-8{padding-left:2rem;padding-right:2rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.py-4{padding-bottom:1rem}.pt-4,.py-4{padding-top:1rem}.pb-16{padding-bottom:4rem}.pl-4{padding-left:1rem}.pl-6{padding-left:1.5rem}.text-center{text-align:center}.font-sans{font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}.font-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.text-sm{font-size:.875rem;line-height:1.25rem}.text-lg{font-size:1.125rem}.text-lg,.text-xl{line-height:1.75rem}.text-xl{font-size:1.25rem}.text-2xl{font-size:1.5rem;line-height:2rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.font-semibold{font-weight:600}.font-bold{font-weight:700}.lowercase{text-transform:lowercase}.italic{font-style:italic}.leading-6{line-height:1.5rem}.text-gray-100{--tw-text-opacity:1;color:rgba(243,244,246,var(--tw-text-opacity))}.text-gray-200{--tw-text-opacity:1;color:rgba(229,231,235,var(--tw-text-opacity))}.text-gray-800{--tw-text-opacity:1;color:rgba(31,41,55,var(--tw-text-opacity))}.text-gray-900{--tw-text-opacity:1;color:rgba(17,24,39,var(--tw-text-opacity))}.hover\:text-gray-200:hover{--tw-text-opacity:1;color:rgba(229,231,235,var(--tw-text-opacity))}@media (prefers-color-scheme:dark){.dark\:text-gray-100{--tw-text-opacity:1;color:rgba(243,244,246,var(--tw-text-opacity))}.dark\:text-gray-200{--tw-text-opacity:1;color:rgba(229,231,235,var(--tw-text-opacity))}.dark\:text-gray-300{--tw-text-opacity:1;color:rgba(209,213,219,var(--tw-text-opacity))}}.antialiased{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}*,:after,:before{--tw-shadow:0 0 #0000}.shadow-sm{--tw-shadow:0 1px 2px 0 rgba(0,0,0,0.05)}.shadow-lg,.shadow-sm{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgba(0,0,0,0.1),0 4px 6px -2px rgba(0,0,0,0.05)}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}*,:after,:before{--tw-ring-inset:var(--tw-empty,/*!*/ /*!*/);--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000}.focus\:ring:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(3px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}.filter{--tw-blur:var(--tw-empty,/*!*/ /*!*/);--tw-brightness:var(--tw-empty,/*!*/ /*!*/);--tw-contrast:var(--tw-empty,/*!*/ /*!*/);--tw-grayscale:var(--tw-empty,/*!*/ /*!*/);--tw-hue-rotate:var(--tw-empty,/*!*/ /*!*/);--tw-invert:var(--tw-empty,/*!*/ /*!*/);--tw-saturate:var(--tw-empty,/*!*/ /*!*/);--tw-sepia:var(--tw-empty,/*!*/ /*!*/);--tw-drop-shadow:var(--tw-empty,/*!*/ /*!*/);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-duration:.15s;transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-colors{transition-duration:.15s;transition-property:background-color,border-color,color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.duration-300{transition-duration:.3s}.duration-500{transition-duration:.5s}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}code[class*=language-],pre[class*=language-]{display:block}@media (min-width:768px){.md\:float-none{float:none}.md\:block{display:block}.md\:w-2\/3{width:66.666667%}.md\:w-1\/5{width:20%}}@media (min-width:1024px){.lg\:float-right{float:right}.lg\:float-left{float:left}.lg\:mt-4{margin-top:1rem}.lg\:text-left{text-align:left}}.prism-code{-webkit-overflow-scrolling:touch;background-color:transparent;border-radius:.2em;float:left;font-size:1rem;margin-bottom:1rem;margin-top:1rem;overflow:initial;padding-bottom:1rem;padding-top:1rem;position:relative}.prism-code.title{border-radius:0 0 .2em .2em}pre.prism-code{float:left;min-width:100%;overflow:initial;padding:20px}.token{display:inline-block}li>code,p>code{word-wrap:break-word;background:#011627;border-radius:.2em;color:#d6deeb;padding:.2em;white-space:pre-wrap}.gatsby-highlight{-webkit-overflow-scrolling:touch;font-size:1rem;overflow:auto;position:relative}.gatsby-highlight::-webkit-scrollbar{display:none}.gatsby-highlight>code[class*=language-],.gatsby>pre[class*=language-]{-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;overflow-wrap:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-break:normal;word-spacing:normal}.gatsby-highlight .token-line{border-left:4px solid transparent;margin-left:-20px;margin-right:-20px}.line-number-style{display:inline-block;opacity:.3;padding-left:1em;padding-right:2em;position:relative;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1.2em}.gatsby-highlight .token-line.highlight-line{background-color:#023751;border-left:4px solid #029bce}.gatsby-highlight .token-line.highlight-line .line-number-style{left:0;opacity:.5;width:calc(1.2em - 4px)}</style><meta name="generator" content="Gatsby 3.8.0"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="search" type="application/opensearchdescription+xml" crossorigin="anonymous" href="/opensearch.xml"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><title data-react-helmet="true">Exploring the HStoreField in Django 1.8 | Matthew Daly</title><link data-react-helmet="true" href="https://matthewdaly.co.uk" rel="canonical"/><link data-react-helmet="true" href="https://twitter.com/mattbd" rel="me"/><link data-react-helmet="true" href="https://github.com/matthewbdaly" rel="me"/><link data-react-helmet="true" href="mailto:matthew@matthewdaly.co.uk" rel="me"/><link data-react-helmet="true" href="/key.pub" rel="pgpkey"/><link data-react-helmet="true" href="https://webmention.io/matthewdaly.co.uk/xmlrpc" rel="pingback"/><link data-react-helmet="true" href="https://webmention.io/matthewdaly.co.uk/webmention" rel="webmention"/><link data-react-helmet="true" rel="authorization_endpoint" href="https://indieauth.com/auth"/><link data-react-helmet="true" rel="token_endpoint" href="https://tokens.indieauth.com/token"/><link data-react-helmet="true" rel="openid.delegate" href="https://matthewdaly.co.uk"/><link data-react-helmet="true" rel="openid.server" href="https://openid.indieauth.com/openid"/><link data-react-helmet="true" rel="alternate" type="application/rss+xml" title="Matthew Daly - feed" href="/rss.xml"/><link data-react-helmet="true" rel="alternate" type="application/atom+xml" title="Matthew Daly - feed" href="/atom.xml"/><link data-react-helmet="true" rel="alternate" type="application/feed+json" title="Matthew Daly - feed" href="/feed.json"/><meta data-react-helmet="true" name="description" content="One of the most interesting additions in Django 1.8 is the new Postgres-specific fields. I started using PostgreSQL in preference to MySQL for Django apps last year, and so I was…"/><meta data-react-helmet="true" property="og:title" content="Exploring the HStoreField in Django 1.8"/><meta data-react-helmet="true" property="og:description" content="One of the most interesting additions in Django 1.8 is the new Postgres-specific fields. I started using PostgreSQL in preference to MySQL for Django apps last year, and so I was…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="mattbd"/><meta data-react-helmet="true" name="twitter:title" content="Exploring the HStoreField in Django 1.8"/><meta data-react-helmet="true" name="twitter:description" content="One of the most interesting additions in Django 1.8 is the new Postgres-specific fields. I started using PostgreSQL in preference to MySQL for Django apps last year, and so I was…"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link rel="icon" href="/favicon-32x32.png?v=53aa06cf17e4239d0dba6ffd09854e02" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#3b82f6"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link as="script" rel="preload" href="/webpack-runtime-88d477ac36829d76e952.js"/><link as="script" rel="preload" href="/framework-cb6229a8adb5817307a4.js"/><link as="script" rel="preload" href="/532a2f07-672258f0b4da4ed2ff53.js"/><link as="script" rel="preload" href="/app-5e95bfecb5da57fd1ffa.js"/><link as="script" rel="preload" href="/f0e45107-763177929e8eed3c13bb.js"/><link as="script" rel="preload" href="/e87769ff526c098a69bffbfff9ee9d57397fcb93-49d3f7242fa2c053e36d.js"/><link as="script" rel="preload" href="/15a3be27178e285ff113e12c60c30466a8f4d4c5-26cc17c8e4fe76c4927b.js"/><link as="script" rel="preload" href="/7840d69eefded84ab93ff6e879351e9a3a16821f-3cc77dc4aa7437d407dd.js"/><link as="script" rel="preload" href="/component---src-templates-post-tsx-493c03ff50c97c3525f1.js"/><link as="fetch" rel="preload" href="/page-data/blog/2015/08/01/exploring-the-hstorefield-in-django-1-dot-8/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/290055352.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2909664151.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="flex flex-col min-h-screen font-sans text-lg antialiased text-gray-800 bg-gray-50 dark:text-gray-100 dark:bg-gray-700 leading-6 pb-16"><div class="w-full h-2 bg-gradient-to-r from-green-400 via-blue-500 to-purple-500"></div><nav class="w-full p-4 mx-auto lowercase md:w-2/3"><h1 class="block float-none py-4 text-4xl text-center lg:float-left lg:text-left"><a href="/">Matthew Daly</a></h1><ul class="py-2 text-center lg:float-right md:block lg:text-left"><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/blog/archives">Archives</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/about">About</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/uses">Uses</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/posts/1">Blog</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/blog/categories">Categories</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/search">Search</a></li></ul></nav><div class="w-full h-4 clear"></div><main class="flex-grow w-full p-4 mx-auto md:w-2/3"><article class="h-entry"><header><h2 class="py-4 text-2xl font-bold e-content p-name"><a class="u-url" href="https://matthewdaly.co.uk/blog/2015/08/01/exploring-the-hstorefield-in-django-1-dot-8/">Exploring the HStoreField in Django 1.8</a></h2><p class="my-4 text-lg font-semibold">Published by <a href="/" rel="author">Matthew Daly</a> at <!-- -->1st August 2015 5:26 pm</p><time class="hidden dt-published">2015-08-01T17:26:54+00:00</time></header><section><p class="py-2">One of the most interesting additions in Django 1.8 is the new Postgres-specific fields. I started using PostgreSQL in preference to MySQL for Django apps last year, and so I was interested in the additional functionality they offer.</p><p class="py-2">By far the biggest deal out of all of these was the new <code>HStoreField</code> type. PostgreSQL added a JSON data type a little while back, and <code>HStoreField</code> allows you to use that field type. This is a really big deal because it allows you to store arbitrary data as JSON and query it. Previously, you could of course just store data as JSON in a text field, but that lacked the same ability to query it. This gives you many of the advantages of a NoSQL document database such as MongoDB in a relational database. For instance, you can store different products with different data about them, and crucially, query them by that data. Previously, the only way to add arbitrary product data and be able to query it was to have it in a separate table, and it was often cumbersome to join them when fetching multiple products.</p><p class="py-2">Let&#x27;s see a working example. We might be building an online store where products can have all kinds of arbitrary data stored about them. One product might be a plastic box, and you&#x27;d need to list the capacity as an additional attribute. Another product might be a pair of shoes, which have no capacity, but do have a size. It might be difficult to model this otherwise, but <code>HStoreField</code> is perfect for this kind of data.</p><p class="py-2">First, let&#x27;s set up our database. I&#x27;ll assume you already have PostgreSQL up and running via your package manager. First, we need to create our database:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ createdb djangostore</span></div></pre></div></pre><p class="py-2">Next, we need to create a new user for this database with superuser access:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ createuser store -s -P</span></div></pre></div></pre><p class="py-2">You&#x27;ll be prompted for a password - I&#x27;m assuming this will just be <code>password</code> here. Next, we need to connect to PostgreSQL using the <code>psql</code> utility:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ psql djangostore -U store -W</span></div></pre></div></pre><p class="py-2">You&#x27;ll be prompted for your new password. Next, run the following command:</p><pre><div class="gatsby-highlight" data-language="psql"><pre class="prism-code language-psql" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain"># CREATE EXTENSION hstore;</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain"># GRANT ALL PRIVILEGES ON DATABASE djangostore TO store;</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain"># \q</span></div></pre></div></pre><p class="py-2">The first command installs the HStore extension. Next we make sure our new user has the privileges required on the new database:</p><p class="py-2">We&#x27;ve now created our database and a user to interact with it. Next, we&#x27;ll set up our Django install:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">$ </span><span class="token builtin class-name" style="color:#FAC863">cd</span><span class="token plain"> Projects</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">$ </span><span class="token function" style="color:#79b6f2">mkdir</span><span class="token plain"> djangostore</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain">$ </span><span class="token builtin class-name" style="color:#FAC863">cd</span><span class="token plain"> djangostore</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain">$ pyvenv venv</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain">$ </span><span class="token builtin class-name" style="color:#FAC863">source</span><span class="token plain"> venv/bin/activate</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain">$ pip </span><span class="token function" style="color:#79b6f2">install</span><span class="token plain"> Django psycopg2 ipdb</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain">$ django-admin.py startproject djangostore</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain">$ python manage.py startapp store</span></div></pre></div></pre><p class="py-2">I&#x27;m assuming here that you&#x27;re using Python 3.4. On Ubuntu, getting it working is <a href="https://gist.github.com/denilsonsa/21e50a357f2d4920091e" class="border-b-2 border-green-400">a bit more involved</a>.</p><p class="py-2">Next, open up <code>djangostore/settings.py</code> and amend <code>INSTALLED_APPS</code> to include the new app and the PostgreSQL-specific functionality:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">INSTALLED_APPS </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">    </span><span class="token string" style="color:#8dc891">&#x27;django.contrib.admin&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain">    </span><span class="token string" style="color:#8dc891">&#x27;django.contrib.auth&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain">    </span><span class="token string" style="color:#8dc891">&#x27;django.contrib.contenttypes&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain">    </span><span class="token string" style="color:#8dc891">&#x27;django.contrib.sessions&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain">    </span><span class="token string" style="color:#8dc891">&#x27;django.contrib.messages&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain">    </span><span class="token string" style="color:#8dc891">&#x27;django.contrib.staticfiles&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain">    </span><span class="token string" style="color:#8dc891">&#x27;django.contrib.postgres&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain">    </span><span class="token string" style="color:#8dc891">&#x27;store&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">You&#x27;ll also need to configure the database settings:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">DATABASES </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">    </span><span class="token string" style="color:#8dc891">&#x27;default&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain">        </span><span class="token string" style="color:#8dc891">&#x27;ENGINE&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;django.db.backends.postgresql_psycopg2&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain">        </span><span class="token string" style="color:#8dc891">&#x27;NAME&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;djangostore&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain">        </span><span class="token string" style="color:#8dc891">&#x27;USER&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;store&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain">        </span><span class="token string" style="color:#8dc891">&#x27;PASSWORD&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;password&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain">        </span><span class="token string" style="color:#8dc891">&#x27;HOST&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;localhost&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain">        </span><span class="token string" style="color:#8dc891">&#x27;PORT&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">We need to create an empty migration to use <code>HStoreField</code>:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ python manage.py makemigrations --empty store</span></div></pre></div></pre><p class="py-2">This command should create the file <code>store/migrations/0001_initial.py</code>. Open this up and edit it to look like this:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token comment" style="color:#999999"># -*- coding: utf-8 -*-</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">from</span><span class="token plain"> __future__ </span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> unicode_literals</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">db </span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> migrations</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">contrib</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">postgres</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">operations </span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> HStoreExtension</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">Migration</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">migrations</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Migration</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token plain">    dependencies </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">12</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">13</span><span class="token plain">    operations </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">14</span><span class="token plain">        HStoreExtension</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">15</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">This will make sure the HStore extension is installed. Next, let&#x27;s run these migrations:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">$ python manage.py migrate</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">Operations to perform:</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain">  Synchronize unmigrated apps: messages, staticfiles, postgres</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain">  Apply all migrations: sessions, store, admin, auth, contenttypes</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain">Synchronizing apps without migrations:</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain">  Creating tables</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain">    Running deferred SQL</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain">  Installing custom SQL</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token plain">.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain">Running migrations:</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token plain">  Rendering model states</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token plain">. DONE</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token plain">  Applying contenttypes.0001_initial</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token plain">. OK</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">12</span><span class="token plain">  Applying auth.0001_initial</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token plain">. OK</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">13</span><span class="token plain">  Applying admin.0001_initial</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token plain">. OK</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">14</span><span class="token plain">  Applying contenttypes.0002_remove_content_type_name</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token plain">. OK</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">15</span><span class="token plain">  Applying auth.0002_alter_permission_name_max_length</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token plain">. OK</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">16</span><span class="token plain">  Applying auth.0003_alter_user_email_max_length</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token plain">. OK</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">17</span><span class="token plain">  Applying auth.0004_alter_user_username_opts</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token plain">. OK</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">18</span><span class="token plain">  Applying auth.0005_alter_user_last_login_null</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token plain">. OK</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">19</span><span class="token plain">  Applying auth.0006_require_contenttypes_0002</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token plain">. OK</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">20</span><span class="token plain">  Applying sessions.0001_initial</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token plain">. OK</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">21</span><span class="token plain">  Applying store.0001_initial</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token plain">. OK</span></div></pre></div></pre><p class="py-2">Now, we&#x27;re ready to start creating our <code>Product</code> model. Open up <code>store/models.py</code> and amend it as follows:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token keyword" style="color:#c5a5c5">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">contrib</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">postgres</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">fields </span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> HStoreField</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">db </span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> models</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain"></span><span class="token comment" style="color:#999999"># Create your models here.</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">Product</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">Model</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain">    created_at </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">DateTimeField</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">auto_now_add</span><span class="token operator" style="color:#d7deea">=</span><span class="token boolean" style="color:#ff8b50">True</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain">    updated_at </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">DateTimeField</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">auto_now</span><span class="token operator" style="color:#d7deea">=</span><span class="token boolean" style="color:#ff8b50">True</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain">    name </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">CharField</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">max_length</span><span class="token operator" style="color:#d7deea">=</span><span class="token number" style="color:#5a9bcf">200</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain">    description </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">TextField</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token plain">    price </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> models</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">FloatField</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token plain">    attributes </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> HStoreField</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">12</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">13</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">def</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">__str__</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">14</span><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> self</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">name</span></div></pre></div></pre><p class="py-2">Note that <code>HStoreField</code> is not part of the standard group of model fields, and needs to be imported from the Postgres-specific fields module. Next, let&#x27;s create and run our migrations:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">$ python manage.py makemigrations</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">$ python manage.py migrate</span></div></pre></div></pre><p class="py-2">We should now have a <code>Product</code> model where the <code>attributes</code> field can be any arbitrary data we want. Note that we installed <code>ipdb</code> earlier - if you&#x27;re not familiar with it, this is an improved Python debugger, and also pulls in <code>ipython</code>, an improved Python shell, which Django will use if available.</p><p class="py-2">Open up the Django shell:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ python manage.py shell</span></div></pre></div></pre><p class="py-2">Then, import the <code>Product</code> model:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token keyword" style="color:#c5a5c5">from</span><span class="token plain"> store</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">models </span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> Product</span></div></pre></div></pre><p class="py-2">Let&#x27;s create our first product - a plastic storage box:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">box </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> Product</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">box</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">name </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;Box&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain">box</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">description </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;A big box&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain">box</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">price </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">5.99</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain">box</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">attributes </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;capacity&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;1L&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;colour&quot;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;blue&quot;</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain">box</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">save</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">If we take a look, we can see that the attributes can be returned as a Python dictionary:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">In </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">12</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Product</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token builtin" style="color:#D8DEE9">all</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">attributes</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">Out</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">12</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token string" style="color:#8dc891">&#x27;capacity&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;1L&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;colour&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;blue&#x27;</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">We can easily retrieve single values:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">In </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">15</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Product</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token builtin" style="color:#D8DEE9">all</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">attributes</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token string" style="color:#8dc891">&#x27;capacity&#x27;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">Out</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">15</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;1L&#x27;</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Let&#x27;s add a second product - a mop:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">mop </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> Product</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">mop</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">name </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;Mop&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain">mop</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">description </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;A mop&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain">mop</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">price </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">12.99</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain">mop</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">attributes </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;colour&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;red&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain">mop</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">save</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Now, we can filter out only the red items easily:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">In </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">2</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Product</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token builtin" style="color:#D8DEE9">filter</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">attributes__contains</span><span class="token operator" style="color:#d7deea">=</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token string" style="color:#8dc891">&#x27;colour&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;red&#x27;</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">Out</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">2</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token operator" style="color:#d7deea">&lt;</span><span class="token plain">Product</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Mop</span><span class="token operator" style="color:#d7deea">&gt;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Here we search for items where the <code>colour</code> attribute is set to <code>red</code>, and we only get back the mop. Let&#x27;s do the same for blue items:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">In </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">3</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Product</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token builtin" style="color:#D8DEE9">filter</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">attributes__contains</span><span class="token operator" style="color:#d7deea">=</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token string" style="color:#8dc891">&#x27;colour&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;blue&#x27;</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">Out</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">3</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token operator" style="color:#d7deea">&lt;</span><span class="token plain">Product</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Box</span><span class="token operator" style="color:#d7deea">&gt;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Here it returns the box. Let&#x27;s now search for an item with a capacity of 1L:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">In </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">4</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Product</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token builtin" style="color:#D8DEE9">filter</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">attributes__contains</span><span class="token operator" style="color:#d7deea">=</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token string" style="color:#8dc891">&#x27;capacity&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;1L&#x27;</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">Out</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">4</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token operator" style="color:#d7deea">&lt;</span><span class="token plain">Product</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Box</span><span class="token operator" style="color:#d7deea">&gt;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Only the box has the capacity attribute at all, and it&#x27;s the only one returned. Let&#x27;s see what happens when we search for an item with a capacity of 2L, which we know is not present:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">In </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">5</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Product</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token builtin" style="color:#D8DEE9">filter</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">attributes__contains</span><span class="token operator" style="color:#d7deea">=</span><span class="token punctuation" style="color:#8dc891">{</span><span class="token string" style="color:#8dc891">&#x27;capacity&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;2L&#x27;</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">Out</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">5</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">No items returned, as expected. Let&#x27;s look for any item with the <code>capacity</code> attribute:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">In </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">6</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Product</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token builtin" style="color:#D8DEE9">filter</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">attributes__has_key</span><span class="token operator" style="color:#d7deea">=</span><span class="token string" style="color:#8dc891">&#x27;capacity&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">Out</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">6</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token operator" style="color:#d7deea">&lt;</span><span class="token plain">Product</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Box</span><span class="token operator" style="color:#d7deea">&gt;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Again, it only returns the box, as that&#x27;s the only one where that key exists. Note that all of this is tightly integrated with the existing API for the Django ORM. Let&#x27;s add a third product, a food hamper:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">In </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">3</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> hamper </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> Product</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain">In </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">4</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> hamper</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">name </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;Hamper&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain">In </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">5</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> hamper</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">description </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;A food hamper&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain">In </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">6</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> hamper</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">price </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">19.99</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain">In </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">7</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> hamper</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">attributes </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token plain">   </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;contents&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;ham, cheese, coffee&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token plain">   </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;size&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;90cmx60cm&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">12</span><span class="token plain">   </span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">13</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">14</span><span class="token plain">In </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">8</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> hamper</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">save</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Next, let&#x27;s return only those items that have a <code>contents</code> attribute that contains <code>cheese</code>:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">In </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">9</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Product</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token builtin" style="color:#D8DEE9">filter</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">attributes__contents__contains</span><span class="token operator" style="color:#d7deea">=</span><span class="token string" style="color:#8dc891">&#x27;cheese&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">Out</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">9</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token operator" style="color:#d7deea">&lt;</span><span class="token plain">Product</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Hamper</span><span class="token operator" style="color:#d7deea">&gt;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">As you can see, the <code>HStoreField</code> type allows for quite complex queries, while allowing you to set arbitrary values for an individual item. This overcomes one of the biggest issues with relational databases - the inability to set arbitrary data. Previously, you might have to work around it in some fashion, such as creating a table containing attributes for individual items which had to be joined on the product table. This is very cumbersome and difficult to use, especially when you wanted to work with more than one product. With this approach, it&#x27;s easy to filter products by multiple values in the HStore field, and you get back all of the attributes at once, as in this example:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">In </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">13</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Product</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token builtin" style="color:#D8DEE9">filter</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">attributes__capacity</span><span class="token operator" style="color:#d7deea">=</span><span class="token string" style="color:#8dc891">&#x27;1L&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> attributes__colour</span><span class="token operator" style="color:#d7deea">=</span><span class="token string" style="color:#8dc891">&#x27;blue&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">Out</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">13</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token operator" style="color:#d7deea">&lt;</span><span class="token plain">Product</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Box</span><span class="token operator" style="color:#d7deea">&gt;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain">In </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">14</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> Product</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token builtin" style="color:#D8DEE9">filter</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">attributes__capacity</span><span class="token operator" style="color:#d7deea">=</span><span class="token string" style="color:#8dc891">&#x27;1L&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> attributes__colour</span><span class="token operator" style="color:#d7deea">=</span><span class="token string" style="color:#8dc891">&#x27;blue&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">attributes</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain">Out</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">14</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token string" style="color:#8dc891">&#x27;capacity&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;1L&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;colour&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;blue&#x27;</span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Similar functionality is coming in a future version of MySQL, so it wouldn&#x27;t be entirely surprising to see <code>HStoreField</code> become more generally available in Django in the near future. For now, this functionality is extremely useful and makes for a good reason to ditch MySQL in favour of PostgreSQL for your future Django apps.</p></section><hr/><div class="py-4"><a class="p-category" href="/blog/categories/python/"><span class="inline-block px-4 py-2 my-2 mr-2 text-sm font-bold text-gray-900 bg-purple-200 rounded-full hover:bg-purple-800 hover:text-gray-200 transition-colors duration-500">python</span></a><a class="p-category" href="/blog/categories/django/"><span class="inline-block px-4 py-2 my-2 mr-2 text-sm font-bold text-gray-900 bg-purple-200 rounded-full hover:bg-purple-800 hover:text-gray-200 transition-colors duration-500">django</span></a><a class="p-category" href="/blog/categories/postgresql/"><span class="inline-block px-4 py-2 my-2 mr-2 text-sm font-bold text-gray-900 bg-purple-200 rounded-full hover:bg-purple-800 hover:text-gray-200 transition-colors duration-500">postgresql</span></a></div><nav class="pt-4 clear-both box-border"><a rel="prev" class="float-left w-1/2 p-2 shadow-sm hover:bg-gray-200 dark:hover:bg-gray-800 transition duration-300 ease-in-out" href="/blog/2015/07/21/new-laptop/"><p><strong class="font-bold clear-both">← Previous page</strong></p><p class="pl-6">New laptop</p></a><a rel="next" class="float-right w-1/2 p-2 shadow-sm hover:bg-gray-200 dark:hover:bg-gray-800 transition duration-300 ease-in-out" href="/blog/2015/08/02/testing-django-views-in-isolation/"><p><strong>→ Next page</strong></p><p class="pl-6">Testing Django views in isolation</p></a></nav><div id="disqus_thread"></div></article></main></div><footer class="w-full p-4 text-gray-100 bg-gray-800"><ul class="flex flex-row flex-wrap justify-center w-full p-2 mx-auto text-center md:w-2/3 box-border"><li class="w-1/3 my-2 md:w-1/5"><a href="/posts/1">Blog</a></li><li class="w-1/3 my-2 md:w-1/5"><a href="/about">About</a></li><li class="w-1/3 my-2 md:w-1/5"><a href="https://twitter.com/mattbd">Twitter</a></li><li class="w-1/3 my-2 md:w-1/5"><a href="https://github.com/matthewbdaly">Github</a></li><li class="w-1/3 my-2 md:w-1/5"><a href="/rss.xml">Feed</a></li></ul><div class="w-full p-4 mx-auto text-center md:w-2/3"><p>© Matthew Daly <!-- -->2021</p></div></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-17043630-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/2015/08/01/exploring-the-hstorefield-in-django-1-dot-8/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-31be65513fba52a5a50c.js"],"app":["/app-5e95bfecb5da57fd1ffa.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-e15fb7b4e4c3e068158e.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-a8bec21bd19e150cd447.js"],"component---src-pages-search-tsx":["/component---src-pages-search-tsx-de35131b8b54d707dd3c.js"],"component---src-templates-404-tsx":["/component---src-templates-404-tsx-1e9ca5e77d61c162fbb8.js"],"component---src-templates-archives-tsx":["/component---src-templates-archives-tsx-df7825ea34c62a098040.js"],"component---src-templates-categories-tsx":["/component---src-templates-categories-tsx-151c44ef3edeea819ec2.js"],"component---src-templates-category-tsx":["/component---src-templates-category-tsx-249488b5bc3e35b8519c.js"],"component---src-templates-chunk-tsx":["/component---src-templates-chunk-tsx-e37127127dfaebd5f552.js"],"component---src-templates-page-tsx":["/component---src-templates-page-tsx-43a798b7c40f1e0cff4e.js"],"component---src-templates-post-tsx":["/component---src-templates-post-tsx-493c03ff50c97c3525f1.js"]};/*]]>*/</script><script src="/polyfill-31be65513fba52a5a50c.js" nomodule=""></script><script src="/component---src-templates-post-tsx-493c03ff50c97c3525f1.js" async=""></script><script src="/7840d69eefded84ab93ff6e879351e9a3a16821f-3cc77dc4aa7437d407dd.js" async=""></script><script src="/15a3be27178e285ff113e12c60c30466a8f4d4c5-26cc17c8e4fe76c4927b.js" async=""></script><script src="/e87769ff526c098a69bffbfff9ee9d57397fcb93-49d3f7242fa2c053e36d.js" async=""></script><script src="/f0e45107-763177929e8eed3c13bb.js" async=""></script><script src="/app-5e95bfecb5da57fd1ffa.js" async=""></script><script src="/532a2f07-672258f0b4da4ed2ff53.js" async=""></script><script src="/framework-cb6229a8adb5817307a4.js" async=""></script><script src="/webpack-runtime-88d477ac36829d76e952.js" async=""></script></body></html>