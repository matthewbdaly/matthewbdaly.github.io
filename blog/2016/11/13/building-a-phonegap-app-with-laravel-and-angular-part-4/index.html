<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta http-equiv="Content-Security-Policy" content="base-uri &#x27;self&#x27;; default-src &#x27;self&#x27; *.google-analytics.com disqus.com *.disqus.com *.disquscdn.com getform.io; script-src &#x27;self&#x27; localhost:* *.addthis.com *.google-analytics.com *.disquscdn.com *.disqus.com disqus.com *.addthisedge.com graph.facebook.com &#x27;unsafe-inline&#x27; &#x27;unsafe-eval&#x27;; style-src &#x27;self&#x27; fonts.googleapis.com *.addthis.com google-analytics.com *.disquscdn.com *.disqus.com &#x27;unsafe-inline&#x27;; object-src &#x27;none&#x27;; form-action &#x27;self&#x27;; font-src &#x27;self&#x27; data: fonts.google-apis.com fonts.gstatic.com; connect-src &#x27;self&#x27; ws://localhost:* *.google-analytics.com stats.g.doubleclick.net; img-src &#x27;self&#x27; *.google-analytics.com *.disquscdn.com *.disqus.com stats.g.doubleclick.net; child-src &#x27;self&#x27;; frame-src disqus.com *.addthis.com;"/><style data-href="/styles.f7f9295044ce5fc4d504.css" data-identity="gatsby-global-css">/*! tailwindcss v2.2.15 | MIT License | https://tailwindcss.com */

/*! modern-normalize v1.1.0 | MIT License | https://github.com/sindresorhus/modern-normalize */html{-webkit-text-size-adjust:100%;line-height:1.15;-moz-tab-size:4;-o-tab-size:4;tab-size:4}body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;margin:0}hr{color:inherit;height:0}abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,select{text-transform:none}[type=button],[type=submit],button{-webkit-appearance:button}legend{padding:0}progress{vertical-align:baseline}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}button{background-color:transparent;background-image:none}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}html{font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5}body{font-family:inherit;line-height:inherit}*,:after,:before{border:0 solid;box-sizing:border-box}hr{border-top-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{color:inherit;line-height:inherit;padding:0}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}*,:after,:before{--tw-border-opacity:1;border-color:rgba(229,231,235,var(--tw-border-opacity))}.float-right{float:right}.float-left{float:left}.float-none{float:none}.clear-both{clear:both}.m-0{margin:0}.mx-0{margin-left:0;margin-right:0}.mx-auto{margin-left:auto;margin-right:auto}.my-2{margin-bottom:.5rem;margin-top:.5rem}.my-4{margin-bottom:1rem;margin-top:1rem}.my-8{margin-bottom:2rem;margin-top:2rem}.mt-2{margin-top:.5rem}.mt-8{margin-top:2rem}.mt-16{margin-top:4rem}.mr-2{margin-right:.5rem}.mr-8{margin-right:2rem}.mb-4{margin-bottom:1rem}.-mb-4{margin-bottom:-1rem}.-mb-8{margin-bottom:-2rem}.box-border{box-sizing:border-box}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.table{display:table}.hidden{display:none}.h-2{height:.5rem}.h-4{height:1rem}.min-h-screen{min-height:100vh}.w-1\/2{width:50%}.w-1\/3{width:33.333333%}.w-2\/3{width:66.666667%}.w-1\/4{width:25%}.w-3\/4{width:75%}.w-full{width:100%}.flex-grow{flex-grow:1}@-webkit-keyframes spin{to{transform:rotate(1turn)}}@keyframes spin{to{transform:rotate(1turn)}}@-webkit-keyframes ping{75%,to{opacity:0;transform:scale(2)}}@keyframes ping{75%,to{opacity:0;transform:scale(2)}}@-webkit-keyframes pulse{50%{opacity:.5}}@keyframes pulse{50%{opacity:.5}}@-webkit-keyframes bounce{0%,to{-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1);transform:translateY(-25%)}50%{-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1);transform:none}}@keyframes bounce{0%,to{-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1);transform:translateY(-25%)}50%{-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1);transform:none}}.resize-none{resize:none}.list-disc{list-style-type:disc}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.justify-center{justify-content:center}.space-y-8>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(2rem*var(--tw-space-y-reverse));margin-top:calc(2rem*(1 - var(--tw-space-y-reverse)))}.space-y-16>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(4rem*var(--tw-space-y-reverse));margin-top:calc(4rem*(1 - var(--tw-space-y-reverse)))}.space-y-32>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(8rem*var(--tw-space-y-reverse));margin-top:calc(8rem*(1 - var(--tw-space-y-reverse)))}.divide-y>:not([hidden])~:not([hidden]){--tw-divide-y-reverse:0;border-bottom-width:calc(1px*var(--tw-divide-y-reverse));border-top-width:calc(1px*(1 - var(--tw-divide-y-reverse)))}.divide-gray-800>:not([hidden])~:not([hidden]){--tw-divide-opacity:1;border-color:rgba(31,41,55,var(--tw-divide-opacity))}@media (prefers-color-scheme:dark){.dark\:divide-gray-200>:not([hidden])~:not([hidden]){--tw-divide-opacity:1;border-color:rgba(229,231,235,var(--tw-divide-opacity))}}.overflow-x-auto{overflow-x:auto}.overflow-x-scroll{overflow-x:scroll}.rounded-lg{border-radius:.5rem}.rounded-full{border-radius:9999px}.rounded-t-lg{border-top-left-radius:.5rem;border-top-right-radius:.5rem}.border-2{border-width:2px}.border-b-2{border-bottom-width:2px}.border-b-4{border-bottom-width:4px}.border-l-8{border-left-width:8px}.border-transparent{border-color:transparent}.border-white{--tw-border-opacity:1;border-color:rgba(255,255,255,var(--tw-border-opacity))}.border-gray-100{--tw-border-opacity:1;border-color:rgba(243,244,246,var(--tw-border-opacity))}.border-gray-500{--tw-border-opacity:1;border-color:rgba(107,114,128,var(--tw-border-opacity))}.border-gray-800{--tw-border-opacity:1;border-color:rgba(31,41,55,var(--tw-border-opacity))}.border-green-400,.hover\:border-green-400:hover{--tw-border-opacity:1;border-color:rgba(52,211,153,var(--tw-border-opacity))}.focus\:border-blue-300:focus{--tw-border-opacity:1;border-color:rgba(147,197,253,var(--tw-border-opacity))}@media (prefers-color-scheme:dark){.dark\:border-black{--tw-border-opacity:1;border-color:rgba(0,0,0,var(--tw-border-opacity))}}.bg-white{--tw-bg-opacity:1;background-color:rgba(255,255,255,var(--tw-bg-opacity))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgba(249,250,251,var(--tw-bg-opacity))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgba(243,244,246,var(--tw-bg-opacity))}.bg-gray-300{--tw-bg-opacity:1;background-color:rgba(209,213,219,var(--tw-bg-opacity))}.bg-gray-800{--tw-bg-opacity:1;background-color:rgba(31,41,55,var(--tw-bg-opacity))}.bg-blue-600{--tw-bg-opacity:1;background-color:rgba(37,99,235,var(--tw-bg-opacity))}.bg-purple-200{--tw-bg-opacity:1;background-color:rgba(221,214,254,var(--tw-bg-opacity))}.hover\:bg-gray-200:hover{--tw-bg-opacity:1;background-color:rgba(229,231,235,var(--tw-bg-opacity))}.hover\:bg-purple-800:hover{--tw-bg-opacity:1;background-color:rgba(91,33,182,var(--tw-bg-opacity))}@media (prefers-color-scheme:dark){.dark\:bg-gray-700{--tw-bg-opacity:1;background-color:rgba(55,65,81,var(--tw-bg-opacity))}.dark\:bg-gray-800{--tw-bg-opacity:1;background-color:rgba(31,41,55,var(--tw-bg-opacity))}.dark\:bg-gray-900{--tw-bg-opacity:1;background-color:rgba(17,24,39,var(--tw-bg-opacity))}.dark\:hover\:bg-gray-800:hover{--tw-bg-opacity:1;background-color:rgba(31,41,55,var(--tw-bg-opacity))}}.bg-gradient-to-r{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.bg-gradient-to-b{background-image:linear-gradient(to bottom,var(--tw-gradient-stops))}.from-gray-200{--tw-gradient-from:#e5e7eb;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to,rgba(229,231,235,0))}.from-green-400{--tw-gradient-from:#34d399;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to,rgba(52,211,153,0))}.via-blue-500{--tw-gradient-stops:var(--tw-gradient-from),#3b82f6,var(--tw-gradient-to,rgba(59,130,246,0))}.to-gray-300{--tw-gradient-to:#d1d5db}.to-purple-500{--tw-gradient-to:#8b5cf6}.p-2{padding:.5rem}.p-4{padding:1rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-4{padding-left:1rem;padding-right:1rem}.px-8{padding-left:2rem;padding-right:2rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.py-4{padding-bottom:1rem}.pt-4,.py-4{padding-top:1rem}.pb-16{padding-bottom:4rem}.pl-4{padding-left:1rem}.pl-6{padding-left:1.5rem}.text-center{text-align:center}.font-sans{font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}.font-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.text-sm{font-size:.875rem;line-height:1.25rem}.text-lg{font-size:1.125rem}.text-lg,.text-xl{line-height:1.75rem}.text-xl{font-size:1.25rem}.text-2xl{font-size:1.5rem;line-height:2rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.font-semibold{font-weight:600}.font-bold{font-weight:700}.lowercase{text-transform:lowercase}.italic{font-style:italic}.leading-6{line-height:1.5rem}.text-black{--tw-text-opacity:1;color:rgba(0,0,0,var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgba(255,255,255,var(--tw-text-opacity))}.text-gray-100{--tw-text-opacity:1;color:rgba(243,244,246,var(--tw-text-opacity))}.text-gray-200{--tw-text-opacity:1;color:rgba(229,231,235,var(--tw-text-opacity))}.text-gray-800{--tw-text-opacity:1;color:rgba(31,41,55,var(--tw-text-opacity))}.text-gray-900{--tw-text-opacity:1;color:rgba(17,24,39,var(--tw-text-opacity))}.hover\:text-gray-200:hover{--tw-text-opacity:1;color:rgba(229,231,235,var(--tw-text-opacity))}@media (prefers-color-scheme:dark){.dark\:text-gray-100{--tw-text-opacity:1;color:rgba(243,244,246,var(--tw-text-opacity))}.dark\:text-gray-200{--tw-text-opacity:1;color:rgba(229,231,235,var(--tw-text-opacity))}.dark\:text-gray-300{--tw-text-opacity:1;color:rgba(209,213,219,var(--tw-text-opacity))}}.antialiased{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}*,:after,:before{--tw-shadow:0 0 #0000}.shadow-sm{--tw-shadow:0 1px 2px 0 rgba(0,0,0,0.05)}.shadow-lg,.shadow-sm{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgba(0,0,0,0.1),0 4px 6px -2px rgba(0,0,0,0.05)}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}*,:after,:before{--tw-ring-inset:var(--tw-empty,/*!*/ /*!*/);--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000}.focus\:ring:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(3px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}.filter{--tw-blur:var(--tw-empty,/*!*/ /*!*/);--tw-brightness:var(--tw-empty,/*!*/ /*!*/);--tw-contrast:var(--tw-empty,/*!*/ /*!*/);--tw-grayscale:var(--tw-empty,/*!*/ /*!*/);--tw-hue-rotate:var(--tw-empty,/*!*/ /*!*/);--tw-invert:var(--tw-empty,/*!*/ /*!*/);--tw-saturate:var(--tw-empty,/*!*/ /*!*/);--tw-sepia:var(--tw-empty,/*!*/ /*!*/);--tw-drop-shadow:var(--tw-empty,/*!*/ /*!*/);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-duration:.15s;transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-colors{transition-duration:.15s;transition-property:background-color,border-color,color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.duration-300{transition-duration:.3s}.duration-500{transition-duration:.5s}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}code[class*=language-],pre[class*=language-]{display:block}@media (min-width:768px){.md\:float-none{float:none}.md\:block{display:block}.md\:w-40{width:10rem}.md\:w-2\/3{width:66.666667%}.md\:w-1\/6{width:16.666667%}}@media (min-width:1024px){.lg\:float-right{float:right}.lg\:float-left{float:left}.lg\:mt-4{margin-top:1rem}.lg\:text-left{text-align:left}}.prism-code{-webkit-overflow-scrolling:touch;background-color:transparent;border-radius:.2em;float:left;font-size:1rem;margin-bottom:1rem;margin-top:1rem;overflow:initial;padding-bottom:1rem;padding-top:1rem;position:relative}.prism-code.title{border-radius:0 0 .2em .2em}pre.prism-code{float:left;min-width:100%;overflow:initial;padding:20px}.token{display:inline-block}li>code,p>code{word-wrap:break-word;background:#011627;border-radius:.2em;color:#d6deeb;padding:.2em;white-space:pre-wrap}.gatsby-highlight{-webkit-overflow-scrolling:touch;font-size:1rem;overflow:auto;position:relative}.gatsby-highlight::-webkit-scrollbar{display:none}.gatsby-highlight>code[class*=language-],.gatsby>pre[class*=language-]{-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;overflow-wrap:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-break:normal;word-spacing:normal}.gatsby-highlight .token-line{border-left:4px solid transparent;margin-left:-20px;margin-right:-20px}.line-number-style{display:inline-block;opacity:.3;padding-left:1em;padding-right:2em;position:relative;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:1.2em}.gatsby-highlight .token-line.highlight-line{background-color:#023751;border-left:4px solid #029bce}.gatsby-highlight .token-line.highlight-line .line-number-style{left:0;opacity:.5;width:calc(1.2em - 4px)}</style><meta name="generator" content="Gatsby 3.14.0"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="search" type="application/opensearchdescription+xml" crossorigin="anonymous" href="/opensearch.xml"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><title data-react-helmet="true">Building a Phonegap App with Laravel and Angular - Part 4 | Matthew Daly</title><link data-react-helmet="true" href="https://matthewdaly.co.uk/blog/2016/11/13/building-a-phonegap-app-with-laravel-and-angular-part-4/" rel="canonical"/><link data-react-helmet="true" href="https://twitter.com/mattbd" rel="me"/><link data-react-helmet="true" href="https://github.com/matthewbdaly" rel="me"/><link data-react-helmet="true" href="mailto:matthew@matthewdaly.co.uk" rel="me"/><link data-react-helmet="true" href="/key.pub" rel="pgpkey"/><link data-react-helmet="true" href="https://webmention.io/matthewdaly.co.uk/xmlrpc" rel="pingback"/><link data-react-helmet="true" href="https://webmention.io/matthewdaly.co.uk/webmention" rel="webmention"/><link data-react-helmet="true" rel="authorization_endpoint" href="https://indieauth.com/auth"/><link data-react-helmet="true" rel="token_endpoint" href="https://tokens.indieauth.com/token"/><link data-react-helmet="true" rel="openid.delegate" href="https://matthewdaly.co.uk"/><link data-react-helmet="true" rel="openid.server" href="https://openid.indieauth.com/openid"/><link data-react-helmet="true" rel="alternate" type="application/rss+xml" title="Matthew Daly - feed" href="/rss.xml"/><link data-react-helmet="true" rel="alternate" type="application/atom+xml" title="Matthew Daly - feed" href="/atom.xml"/><link data-react-helmet="true" rel="alternate" type="application/feed+json" title="Matthew Daly - feed" href="/feed.json"/><meta data-react-helmet="true" name="description" content="In this instalment we&#x27;ll return to the back end. What we&#x27;ve done so far is typical of the kind of proof of concept we might do for a client early on, before going back and…"/><meta data-react-helmet="true" property="og:title" content="Building a Phonegap App with Laravel and Angular - Part 4"/><meta data-react-helmet="true" property="og:description" content="In this instalment we&#x27;ll return to the back end. What we&#x27;ve done so far is typical of the kind of proof of concept we might do for a client early on, before going back and…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="mattbd"/><meta data-react-helmet="true" name="twitter:title" content="Building a Phonegap App with Laravel and Angular - Part 4"/><meta data-react-helmet="true" name="twitter:description" content="In this instalment we&#x27;ll return to the back end. What we&#x27;ve done so far is typical of the kind of proof of concept we might do for a client early on, before going back and…"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link rel="icon" href="/favicon-32x32.png?v=53aa06cf17e4239d0dba6ffd09854e02" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#3b82f6"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link as="script" rel="preload" href="/webpack-runtime-18e46328f4c5ead59e69.js"/><link as="script" rel="preload" href="/framework-aeedefbd40854c93cd6e.js"/><link as="script" rel="preload" href="/app-d77411d2a9a71ac63dc7.js"/><link as="script" rel="preload" href="/f0e45107-1ab5e6e9877396d2cf44.js"/><link as="script" rel="preload" href="/751e6587c41c404721231b94fec2753859fa1aad-238a8becfca1bae1e52b.js"/><link as="script" rel="preload" href="/15a3be27178e285ff113e12c60c30466a8f4d4c5-05c94d59cdf70f961f79.js"/><link as="script" rel="preload" href="/7840d69eefded84ab93ff6e879351e9a3a16821f-3cc77dc4aa7437d407dd.js"/><link as="script" rel="preload" href="/component---src-templates-post-tsx-cc8c6bdbcd5a1c0c91b6.js"/><link as="fetch" rel="preload" href="/page-data/blog/2016/11/13/building-a-phonegap-app-with-laravel-and-angular-part-4/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/290055352.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2909664151.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="flex flex-col min-h-screen pb-16 font-sans text-lg antialiased text-gray-800 bg-gray-50 dark:text-gray-100 dark:bg-gray-700 leading-6"><div class="w-full h-2 bg-gradient-to-r from-green-400 via-blue-500 to-purple-500"></div><nav class="w-full p-4 mx-auto lowercase md:w-2/3"><h1 class="block float-none py-4 text-4xl text-center lg:float-left lg:text-left"><a href="/">Matthew Daly</a></h1><ul class="py-2 text-center lg:float-right md:block lg:text-left"><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/blog/archives">Archives</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/about">About</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/uses">Uses</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/posts/1">Blog</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/blog/categories">Categories</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/search">Search</a></li></ul></nav><div class="w-full h-4 clear"></div><main class="flex-grow w-full p-4 mx-auto md:w-2/3"><article class="h-entry"><header><h2 class="py-4 text-2xl font-bold e-content p-name"><a class="u-url" href="https://matthewdaly.co.uk/blog/2016/11/13/building-a-phonegap-app-with-laravel-and-angular-part-4/">Building a Phonegap App with Laravel and Angular - Part 4</a></h2><p class="my-4 text-lg font-semibold">Published by <a href="/" rel="author">Matthew Daly</a> at <!-- -->13th November 2016 4:15 pm</p><time class="hidden dt-published">2016-11-13T16:15:00+00:00</time></header><section><p class="py-2">In this instalment we&#x27;ll return to the back end. What we&#x27;ve done so far is typical of the kind of proof of concept we might do for a client early on, before going back and implementing the full set of features later on. Now we&#x27;ll go back and start to improve on that rather quick-and-dirty API by making sure we follow a few best practices.</p><p class="py-2">For those of you who want to follow the Laravel Phonegap tutorials, I&#x27;ve created a dedicated category <a href="/blog/categories/laravel-phonegap-tutorial/" class="border-b-2 border-green-400">here</a> for those tutorials. This category include RSS and Atom feeds, so if you only want to read those posts, you can do so. I&#x27;ve also done the same for the <a href="/blog/categories/django-blog-tutorial/" class="border-b-2 border-green-400">Django tutorials</a>.</p><h2 class="py-4 text-2xl font-bold">The Repository pattern</h2><p class="py-2">One of the issues we currently have with our API is that we&#x27;re passing our Eloquent models into our controllers. This may not seem like a huge issue, but it means that our controllers are tightly coupled to the Eloquent ORM, so if we wanted to switch to another ORM, or to a completely different database such as MongoDB, we&#x27;d have to amend our controllers. That&#x27;s not good.</p><p class="py-2">However, using the <a href="http://designpatternsphp.readthedocs.io/en/latest/More/Repository/README.html" class="border-b-2 border-green-400">Repository pattern</a> we can first of all define an interface for our repository, and then create a repository class that implements that interface. That way we can interact with the repository class in our controllers, rather than using Eloquent models directly. Then, if we want to switch databases, we merely amend the repository class to change the implementation of those methods, without having to touch our controllers. Also, it makes it much easier to test our controllers in isolation, because we can easily mock our repository class using Mockery and hard-code the response, so our tests won&#x27;t touch the database and will therefore run more quickly. We won&#x27;t touch on that this time, but it&#x27;s a very significant advantage.</p><p class="py-2">If you haven&#x27;t used interfaces before in PHP, they aren&#x27;t that hard. They merely specify what methods an object implementing that method must have and what arguments they must accept, but do not specify the details of the implementation. This makes it easy to determine if a class implements an interface correctly, because it will throw an exception if it doesn&#x27;t.</p><pre><div class="gatsby-highlight" data-language="php"><pre class="prism-code language-php" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token delimiter important" style="font-weight:400">&lt;?php</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">namespace</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Repositories</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Interfaces</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">interface</span><span class="token plain"> </span><span class="token class-name-definition class-name" style="color:#FAC863">PetRepositoryInterface</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">all</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">findOrFail</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">create</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$input</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">That&#x27;s all there is to it. We define it using the <code>interface</code> keyword and we specify the methods it must implement. Save this file at <code>app/Repositories/Interfaces/PetRepositoryInterface.php</code>.</p><p class="py-2">Next, we implement the repository class:</p><pre><div class="gatsby-highlight" data-language="php"><pre class="prism-code language-php" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token delimiter important" style="font-weight:400">&lt;?php</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">namespace</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Repositories</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain"> </span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Pet</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Repositories</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Interfaces</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">PetRepositoryInterface</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain"> </span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token plain"> </span><span class="token class-name-definition class-name" style="color:#FAC863">EloquentPetRepository</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">implements</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">PetRepositoryInterface</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain"> </span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">private</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">12</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">__construct</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name type-declaration" style="color:#FAC863">Pet</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">13</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">14</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">pet</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">15</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">16</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">17</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">all</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">18</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">19</span><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">pet</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">all</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">20</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">21</span><span class="token plain"> </span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">22</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">findOrFail</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">23</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">24</span><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">pet</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">findOrFail</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">25</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">26</span><span class="token plain"> </span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">27</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">create</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$input</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">28</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">29</span><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">pet</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">create</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$input</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">30</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">31</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Save this to <code>app/Repositories/EloquentPetRepository.php</code>. Note how the methods closely mirror the underlying Eloquent methods, but they don&#x27;t need to - you could change the underlying implementation of each method, but the repository would still work in exactly the same way.</p><p class="py-2">To make this work, we need to make a few changes elsewhere. In <code>composer.json</code>, we need to add the new <code>Repositories</code> folder to our classmap:</p><pre><div class="gatsby-highlight" data-language="json"><pre class="prism-code language-json" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;autoload&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;classmap&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain">            </span><span class="token string" style="color:#8dc891">&quot;database&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain">            </span><span class="token string" style="color:#8dc891">&quot;app/Repositories&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;psr-4&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain">            </span><span class="token property" style="color:#5a9bcf">&quot;AnimalFriend\\&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;app/&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">And in <code>app/Providers/AppServiceProvider.php</code>, we need to bind our new files:</p><pre><div class="gatsby-highlight" data-language="php"><pre class="prism-code language-php" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token delimiter important" style="font-weight:400">&lt;?php</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">namespace</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Providers</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">Illuminate</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Support</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">ServiceProvider</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token plain"> </span><span class="token class-name-definition class-name" style="color:#FAC863">AppServiceProvider</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">extends</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">ServiceProvider</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token comment" style="color:#999999">     * Bootstrap any application services.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">12</span><span class="token comment" style="color:#999999">     * @return void</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">13</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">14</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">boot</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">15</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">16</span><span class="token plain">        </span><span class="token comment" style="color:#999999">//</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">17</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">18</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">19</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">20</span><span class="token comment" style="color:#999999">     * Register any application services.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">21</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">22</span><span class="token comment" style="color:#999999">     * @return void</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">23</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">24</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">register</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">25</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">26</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">app</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">bind</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">27</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;AnimalFriend\Repositories\Interfaces\PetRepositoryInterface&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">28</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;AnimalFriend\Repositories\EloquentPetRepository&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">29</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">30</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">31</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">With that done, we can now update <code>app/Http/Controllers/PetController.php</code> to use the repository:</p><pre><div class="gatsby-highlight" data-language="php"><pre class="prism-code language-php" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token delimiter important" style="font-weight:400">&lt;?php</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">namespace</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Http</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Controllers</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">Illuminate</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Http</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Request</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Http</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Requests</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Repositories</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Interfaces</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">PetRepositoryInterface</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">as</span><span class="token plain"> Pet</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token plain"> </span><span class="token class-name-definition class-name" style="color:#FAC863">PetController</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">extends</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">Controller</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">12</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">private</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">13</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">14</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">__construct</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name type-declaration" style="color:#FAC863">Pet</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">15</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">pet</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">16</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">17</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">18</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">19</span><span class="token comment" style="color:#999999">     * Display a listing of the resource.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">20</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">21</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">22</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">23</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">index</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">24</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">25</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Get all pets</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">26</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$pets</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">pet</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">all</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">27</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">28</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Send response</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">29</span><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">response</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">json</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$pets</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">200</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">30</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">31</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">32</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">33</span><span class="token comment" style="color:#999999">     * Show the form for creating a new resource.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">34</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">35</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">36</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">37</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">create</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">38</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">39</span><span class="token plain">        </span><span class="token comment" style="color:#999999">//</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">40</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">41</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">42</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">43</span><span class="token comment" style="color:#999999">     * Store a newly created resource in storage.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">44</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">45</span><span class="token comment" style="color:#999999">     * @param  \Illuminate\Http\Request  $request</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">46</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">47</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">48</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">store</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name type-declaration" style="color:#FAC863">Request</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$request</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">49</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">50</span><span class="token plain">        </span><span class="token comment" style="color:#999999">//</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">51</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">52</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">53</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">54</span><span class="token comment" style="color:#999999">     * Display the specified resource.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">55</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">56</span><span class="token comment" style="color:#999999">     * @param  int  $id</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">57</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">58</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">59</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">show</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">60</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">61</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Get pet</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">62</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">pet</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">findOrFail</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">63</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">64</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Send response</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">65</span><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">response</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">json</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">200</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">66</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">67</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">68</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">69</span><span class="token comment" style="color:#999999">     * Show the form for editing the specified resource.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">70</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">71</span><span class="token comment" style="color:#999999">     * @param  int  $id</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">72</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">73</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">74</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">edit</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">75</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">76</span><span class="token plain">        </span><span class="token comment" style="color:#999999">//</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">77</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">78</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">79</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">80</span><span class="token comment" style="color:#999999">     * Update the specified resource in storage.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">81</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">82</span><span class="token comment" style="color:#999999">     * @param  \Illuminate\Http\Request  $request</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">83</span><span class="token comment" style="color:#999999">     * @param  int  $id</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">84</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">85</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">86</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">update</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name type-declaration" style="color:#FAC863">Request</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$request</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">87</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">88</span><span class="token plain">        </span><span class="token comment" style="color:#999999">//</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">89</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">90</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">91</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">92</span><span class="token comment" style="color:#999999">     * Remove the specified resource from storage.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">93</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">94</span><span class="token comment" style="color:#999999">     * @param  int  $id</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">95</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">96</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">97</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">destroy</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">98</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">99</span><span class="token plain">        </span><span class="token comment" style="color:#999999">//</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">100</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">101</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Our repository is now injected automatically into the controller. To make this work we need to run the following command:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ </span><span class="token function" style="color:#79b6f2">composer</span><span class="token plain"> dump-autoload</span></div></pre></div></pre><p class="py-2">Running our tests should confirm that everything is still working:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">$ vendor/bin/phpunit</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">PHPUnit </span><span class="token number" style="color:#5a9bcf">5.5</span><span class="token plain">.4 by Sebastian Bergmann and contributors.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">..</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token plain">                                                      </span><span class="token number" style="color:#5a9bcf">12</span><span class="token plain"> / </span><span class="token number" style="color:#5a9bcf">12</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">100</span><span class="token plain">%</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain">Time: </span><span class="token number" style="color:#5a9bcf">897</span><span class="token plain"> ms, Memory: </span><span class="token number" style="color:#5a9bcf">18</span><span class="token plain">.00MB</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain">OK </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">12</span><span class="token plain"> tests, </span><span class="token number" style="color:#5a9bcf">46</span><span class="token plain"> assertions</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Let&#x27;s do the same for the User model. First we implement our interface in <code>app/Repositories/Interfaces/UserRepositoryInterface.php</code>:</p><pre><div class="gatsby-highlight" data-language="php"><pre class="prism-code language-php" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token delimiter important" style="font-weight:400">&lt;?php</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">namespace</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Repositories</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Interfaces</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">interface</span><span class="token plain"> </span><span class="token class-name-definition class-name" style="color:#FAC863">UserRepositoryInterface</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">all</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">findOrFail</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">create</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$input</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Next we create our repository at <code>app/Repositories/EloquentUserRepository.php</code>:</p><pre><div class="gatsby-highlight" data-language="php"><pre class="prism-code language-php" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token delimiter important" style="font-weight:400">&lt;?php</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">namespace</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Repositories</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain"> </span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">User</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Repositories</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Interfaces</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">UserRepositoryInterface</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">JWTAuth</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">Hash</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain"> </span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token plain"> </span><span class="token class-name-definition class-name" style="color:#FAC863">EloquentUserRepository</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">implements</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">UserRepositoryInterface</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token plain"> </span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">12</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">private</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$user</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">13</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">14</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">__construct</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name type-declaration" style="color:#FAC863">User</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$user</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">15</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">16</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">user</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$user</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">17</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">18</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">19</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">all</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">20</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">21</span><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">user</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">all</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">22</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">23</span><span class="token plain"> </span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">24</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">findOrFail</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">25</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">26</span><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">user</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">findOrFail</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">27</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">28</span><span class="token plain"> </span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">29</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">create</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$input</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">30</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">31</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$user</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">new</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">user</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">32</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$user</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">email</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$input</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;email&#x27;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">33</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$user</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">name</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$input</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;name&#x27;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">34</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$user</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">password</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token class-name static-context" style="color:#FAC863">Hash</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">make</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$input</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;password&#x27;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">35</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$user</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">save</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">36</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">37</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Create token</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">38</span><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token class-name static-context" style="color:#FAC863">JWTAuth</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">fromUser</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$user</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">39</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">40</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Note how we&#x27;ve moved much of the logic for creating a user into the <code>create()</code> method, and we return the token, not the user model. This makes sense as right now we only ever want to get a token back when we create a user. Later that may change, but there&#x27;s nothing stopping us adding a new method to implement that behaviour alongside this.</p><p class="py-2">Then we update <code>app/Http/Controllers/UserController.php</code> to use our repository:</p><pre><div class="gatsby-highlight" data-language="php"><pre class="prism-code language-php" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token delimiter important" style="font-weight:400">&lt;?php</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">namespace</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Http</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Controllers</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">Illuminate</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Http</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Request</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Http</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Requests</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Repositories</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Interfaces</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">UserRepositoryInterface</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">as</span><span class="token plain"> User</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">JWTAuth</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">Hash</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">12</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token plain"> </span><span class="token class-name-definition class-name" style="color:#FAC863">UserController</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">extends</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">Controller</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">13</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">14</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">private</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$user</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">15</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">16</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">__construct</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name type-declaration" style="color:#FAC863">User</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$user</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">17</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">user</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$user</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">18</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">19</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">20</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">21</span><span class="token comment" style="color:#999999">     * Display a listing of the resource.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">22</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">23</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">24</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">25</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">index</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">26</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">27</span><span class="token plain">        </span><span class="token comment" style="color:#999999">//</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">28</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">29</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">30</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">31</span><span class="token comment" style="color:#999999">     * Show the form for creating a new resource.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">32</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">33</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">34</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">35</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">create</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">36</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">37</span><span class="token plain">        </span><span class="token comment" style="color:#999999">//</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">38</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">39</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">40</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">41</span><span class="token comment" style="color:#999999">     * Store a newly created resource in storage.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">42</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">43</span><span class="token comment" style="color:#999999">     * @param  \Illuminate\Http\Request  $request</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">44</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">45</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">46</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">store</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name type-declaration" style="color:#FAC863">Request</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$request</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">47</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">48</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Validate request</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">49</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$valid</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">validate</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$request</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">50</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;email&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;required|email|unique:users,email&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">51</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;name&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;required|string&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">52</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;password&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;required|confirmed&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">53</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">54</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">55</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Create token</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">56</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$token</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">user</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">create</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$request</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">only</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">57</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;email&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">58</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;name&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">59</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;password&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">60</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">61</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">62</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Send response</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">63</span><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">response</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">json</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;token&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$token</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">201</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">64</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">65</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">66</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">67</span><span class="token comment" style="color:#999999">     * Display the specified resource.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">68</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">69</span><span class="token comment" style="color:#999999">     * @param  int  $id</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">70</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">71</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">72</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">show</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">73</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">74</span><span class="token plain">        </span><span class="token comment" style="color:#999999">//</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">75</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">76</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">77</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">78</span><span class="token comment" style="color:#999999">     * Show the form for editing the specified resource.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">79</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">80</span><span class="token comment" style="color:#999999">     * @param  int  $id</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">81</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">82</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">83</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">edit</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">84</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">85</span><span class="token plain">        </span><span class="token comment" style="color:#999999">//</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">86</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">87</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">88</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">89</span><span class="token comment" style="color:#999999">     * Update the specified resource in storage.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">90</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">91</span><span class="token comment" style="color:#999999">     * @param  \Illuminate\Http\Request  $request</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">92</span><span class="token comment" style="color:#999999">     * @param  int  $id</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">93</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">94</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">95</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">update</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name type-declaration" style="color:#FAC863">Request</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$request</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">96</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">97</span><span class="token plain">        </span><span class="token comment" style="color:#999999">//</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">98</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">99</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">100</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">101</span><span class="token comment" style="color:#999999">     * Remove the specified resource from storage.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">102</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">103</span><span class="token comment" style="color:#999999">     * @param  int  $id</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">104</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">105</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">106</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">destroy</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">107</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">108</span><span class="token plain">        </span><span class="token comment" style="color:#999999">//</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">109</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">110</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">And add a new binding in <code>app/Providers/AppServiceProvider.php</code>:</p><pre><div class="gatsby-highlight" data-language="php"><pre class="prism-code language-php" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token delimiter important" style="font-weight:400">&lt;?php</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">namespace</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Providers</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">Illuminate</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Support</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">ServiceProvider</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token plain"> </span><span class="token class-name-definition class-name" style="color:#FAC863">AppServiceProvider</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">extends</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">ServiceProvider</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token comment" style="color:#999999">     * Bootstrap any application services.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">12</span><span class="token comment" style="color:#999999">     * @return void</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">13</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">14</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">boot</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">15</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">16</span><span class="token plain">        </span><span class="token comment" style="color:#999999">//</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">17</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">18</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">19</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">20</span><span class="token comment" style="color:#999999">     * Register any application services.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">21</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">22</span><span class="token comment" style="color:#999999">     * @return void</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">23</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">24</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">register</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">25</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">26</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">app</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">bind</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">27</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;AnimalFriend\Repositories\Interfaces\PetRepositoryInterface&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">28</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;AnimalFriend\Repositories\EloquentPetRepository&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">29</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">30</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">app</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">bind</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">31</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;AnimalFriend\Repositories\Interfaces\UserRepositoryInterface&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">32</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;AnimalFriend\Repositories\EloquentUserRepository&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">33</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">34</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">35</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Note that we bind the two sets separately - this allows Laravel to figure out which one maps to which.</p><p class="py-2">Let&#x27;s run our tests to make sure nothing is broken:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">$ vendor/bin/phpunit </span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">PHPUnit </span><span class="token number" style="color:#5a9bcf">5.5</span><span class="token plain">.4 by Sebastian Bergmann and contributors.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">..</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token plain">                                                      </span><span class="token number" style="color:#5a9bcf">12</span><span class="token plain"> / </span><span class="token number" style="color:#5a9bcf">12</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">100</span><span class="token plain">%</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain">Time: </span><span class="token number" style="color:#5a9bcf">956</span><span class="token plain"> ms, Memory: </span><span class="token number" style="color:#5a9bcf">18</span><span class="token plain">.00MB</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain">OK </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">12</span><span class="token plain"> tests, </span><span class="token number" style="color:#5a9bcf">46</span><span class="token plain"> assertions</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Now that we&#x27;ve got our repositories in place, we&#x27;re no longer tightly coupled to Eloquent, and have a more flexible implementation which is easier to test.</p><h2 class="py-4 text-2xl font-bold">Separating our models from our JSON with Fractal</h2><p class="py-2">Another problem with our API is that our representation of our data is tightly coupled to our underlying implementation of our models. We therefore can&#x27;t change our models without potentially changing the data returned by the API. We need to separate our representation of our data from our actual model so that we can more easily specify the exact data we want to return, regardless of the underlying database structure.</p><p class="py-2">Enter <a href="http://fractal.thephpleague.com/" class="border-b-2 border-green-400">Fractal</a>. From the website:</p><blockquote class="pl-4 italic text-gray-200 text-gray-900 bg-gray-100 border-l-8 border-gray-500 dark:text-gray-300 dark:bg-gray-800"><p class="py-2">Fractal provides a presentation and transformation layer for complex data output, the like found in RESTful APIs, and works really well with JSON. Think of this as a view layer for your JSON/YAML/etc.</p></blockquote><p class="py-2">In other words, Fractal lets you specify the format your data will take in one place so that it&#x27;s easier to return that data in a desired format. We&#x27;ll use Fractal to specify how we want our API responses to be formatted.</p><p class="py-2">Install Fractal with the following command:</p><pre><div class="gatsby-highlight" data-language="php"><pre class="prism-code language-php" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ composer </span><span class="token keyword" style="color:#c5a5c5">require</span><span class="token plain"> league</span><span class="token operator" style="color:#d7deea">/</span><span class="token plain">fractal</span></div></pre></div></pre><p class="py-2">Then amend the classmap in <code>composer.json</code>:</p><pre><div class="gatsby-highlight" data-language="json"><pre class="prism-code language-json" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">    </span><span class="token property" style="color:#5a9bcf">&quot;autoload&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;classmap&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain">            </span><span class="token string" style="color:#8dc891">&quot;database&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain">            </span><span class="token string" style="color:#8dc891">&quot;app/Repositories&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain">            </span><span class="token string" style="color:#8dc891">&quot;app/Transformers&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain">        </span><span class="token property" style="color:#5a9bcf">&quot;psr-4&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain">            </span><span class="token property" style="color:#5a9bcf">&quot;AnimalFriend\\&quot;</span><span class="token operator" style="color:#d7deea">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;app/&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Then create the folder <code>app/Transformers</code> and run <code>composer dump-autoload</code>. We&#x27;re now ready to write our first transformer. Save this as <code>app/Transformers/PetTransformer.php</code>:</p><pre><div class="gatsby-highlight" data-language="php"><pre class="prism-code language-php" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token delimiter important" style="font-weight:400">&lt;?php</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">namespace</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Transformers</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Pet</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">League</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Fractal</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token plain"> </span><span class="token class-name-definition class-name" style="color:#FAC863">PetTransformer</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">extends</span><span class="token plain"> </span><span class="token class-name class-name-fully-qualified" style="color:#FAC863">Fractal</span><span class="token class-name class-name-fully-qualified punctuation" style="color:#8dc891">\</span><span class="token class-name class-name-fully-qualified" style="color:#FAC863">TransformerAbstract</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">transform</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name type-declaration" style="color:#FAC863">Pet</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">12</span><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">13</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;id&#x27;</span><span class="token plain">            </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword type-casting" style="color:#c5a5c5">int</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">id</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">14</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;name&#x27;</span><span class="token plain">          </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword type-casting" style="color:#c5a5c5">string</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">name</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">15</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;type&#x27;</span><span class="token plain">          </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword type-casting" style="color:#c5a5c5">string</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">type</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">16</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;available&#x27;</span><span class="token plain">     </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword type-casting" style="color:#c5a5c5">bool</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">available</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">17</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;picture&#x27;</span><span class="token plain">       </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token keyword type-casting" style="color:#c5a5c5">string</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">picture</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">18</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">19</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">20</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">The <code>transform</code> method specifies how we want to represent our objects with our API. We can return only those attributes we want to expose, and amend the structure as we see fit. We could easily represent relations in whatever manner we see fit, whereas before we needed to amend our queries to return the data in the right format, which would potentially be cumbersome.</p><p class="py-2">Now let&#x27;s amend <code>PetController.php</code> to use this:</p><pre><div class="gatsby-highlight" data-language="php"><pre class="prism-code language-php" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token delimiter important" style="font-weight:400">&lt;?php</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">namespace</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Http</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Controllers</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">Illuminate</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Http</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Request</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Http</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Requests</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Repositories</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Interfaces</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">PetRepositoryInterface</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">as</span><span class="token plain"> Pet</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">AnimalFriend</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Transformers</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">PetTransformer</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">League</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Fractal</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">League</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Fractal</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Manager</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">12</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">13</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token plain"> </span><span class="token class-name-definition class-name" style="color:#FAC863">PetController</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">extends</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">Controller</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">14</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">15</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">private</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$fractal</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">16</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">17</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">__construct</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name type-declaration" style="color:#FAC863">Pet</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token class-name type-declaration" style="color:#FAC863">Manager</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$fractal</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">18</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">pet</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">19</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">fractal</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$fractal</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">20</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">21</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">22</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">23</span><span class="token comment" style="color:#999999">     * Display a listing of the resource.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">24</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">25</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">26</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">27</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">index</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">28</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">29</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Get all pets</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">30</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$pets</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">pet</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">all</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">31</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">32</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Format it</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">33</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$resource</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">new</span><span class="token plain"> </span><span class="token class-name class-name-fully-qualified" style="color:#FAC863">Fractal</span><span class="token class-name class-name-fully-qualified punctuation" style="color:#8dc891">\</span><span class="token class-name class-name-fully-qualified" style="color:#FAC863">Resource</span><span class="token class-name class-name-fully-qualified punctuation" style="color:#8dc891">\</span><span class="token class-name class-name-fully-qualified" style="color:#FAC863">Collection</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$pets</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">new</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">PetTransformer</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">34</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$data</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">fractal</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">createData</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$resource</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">toArray</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">35</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">36</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Send response</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">37</span><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">response</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">json</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$data</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">200</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">38</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">39</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">40</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">41</span><span class="token comment" style="color:#999999">     * Show the form for creating a new resource.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">42</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">43</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">44</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">45</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">create</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">46</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">47</span><span class="token plain">        </span><span class="token comment" style="color:#999999">//</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">48</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">49</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">50</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">51</span><span class="token comment" style="color:#999999">     * Store a newly created resource in storage.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">52</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">53</span><span class="token comment" style="color:#999999">     * @param  \Illuminate\Http\Request  $request</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">54</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">55</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">56</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">store</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name type-declaration" style="color:#FAC863">Request</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$request</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">57</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">58</span><span class="token plain">        </span><span class="token comment" style="color:#999999">//</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">59</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">60</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">61</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">62</span><span class="token comment" style="color:#999999">     * Display the specified resource.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">63</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">64</span><span class="token comment" style="color:#999999">     * @param  int  $id</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">65</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">66</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">67</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">show</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">68</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">69</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Get pet</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">70</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">pet</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">findOrFail</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">71</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">72</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Format it</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">73</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$resource</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">new</span><span class="token plain"> </span><span class="token class-name class-name-fully-qualified" style="color:#FAC863">Fractal</span><span class="token class-name class-name-fully-qualified punctuation" style="color:#8dc891">\</span><span class="token class-name class-name-fully-qualified" style="color:#FAC863">Resource</span><span class="token class-name class-name-fully-qualified punctuation" style="color:#8dc891">\</span><span class="token class-name class-name-fully-qualified" style="color:#FAC863">Item</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$pet</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">new</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">PetTransformer</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">74</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$data</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">fractal</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">createData</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$resource</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">toArray</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">75</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">76</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Send response</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">77</span><span class="token plain">        </span><span class="token keyword" style="color:#c5a5c5">return</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">response</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">json</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$data</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">200</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">78</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">79</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">80</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">81</span><span class="token comment" style="color:#999999">     * Show the form for editing the specified resource.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">82</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">83</span><span class="token comment" style="color:#999999">     * @param  int  $id</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">84</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">85</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">86</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">edit</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">87</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">88</span><span class="token plain">        </span><span class="token comment" style="color:#999999">//</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">89</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">90</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">91</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">92</span><span class="token comment" style="color:#999999">     * Update the specified resource in storage.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">93</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">94</span><span class="token comment" style="color:#999999">     * @param  \Illuminate\Http\Request  $request</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">95</span><span class="token comment" style="color:#999999">     * @param  int  $id</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">96</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">97</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">98</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">update</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name type-declaration" style="color:#FAC863">Request</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$request</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">99</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">100</span><span class="token plain">        </span><span class="token comment" style="color:#999999">//</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">101</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">102</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">103</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">104</span><span class="token comment" style="color:#999999">     * Remove the specified resource from storage.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">105</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">106</span><span class="token comment" style="color:#999999">     * @param  int  $id</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">107</span><span class="token comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">108</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">109</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">destroy</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">110</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">111</span><span class="token plain">        </span><span class="token comment" style="color:#999999">//</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">112</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">113</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Note that by default, Fractal places our data inside a dedicated <code>data</code> namespace. This is good because it leaves a place for us to put metadata such as pagination links, but it does mean our controller test has been broken. Let&#x27;s fix it:</p><pre><div class="gatsby-highlight" data-language="php"><pre class="prism-code language-php" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token delimiter important" style="font-weight:400">&lt;?php</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">Illuminate</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Foundation</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">Testing</span><span class="token package punctuation" style="color:#8dc891">\</span><span class="token package">DatabaseMigrations</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token plain"> </span><span class="token class-name-definition class-name" style="color:#FAC863">PetControllerTest</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">extends</span><span class="token plain"> </span><span class="token class-name" style="color:#FAC863">TestCase</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">use</span><span class="token plain"> </span><span class="token package">DatabaseMigrations</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token comment" style="color:#999999">     * Test fetching pets when unauthorised</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">12</span><span class="token comment" style="color:#999999">     * @return void</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">13</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">14</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">testFetchingPetsWhenUnauthorised</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">15</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">16</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Create a Pet</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">17</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">factory</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name class-name-fully-qualified static-context" style="color:#FAC863">AnimalFriend</span><span class="token class-name class-name-fully-qualified static-context punctuation" style="color:#8dc891">\</span><span class="token class-name class-name-fully-qualified static-context" style="color:#FAC863">Pet</span><span class="token operator" style="color:#d7deea">::</span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">create</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">18</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;name&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;Freddie&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">19</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;type&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;Cat&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">20</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">21</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">seeInDatabase</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;pets&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;type&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;Cat&#x27;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">22</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">23</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Create request</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">24</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$response</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">call</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;GET&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;/api/pets&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">25</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">assertResponseStatus</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">400</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">26</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">27</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">28</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">29</span><span class="token comment" style="color:#999999">     * Test fetching pets when authorised</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">30</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">31</span><span class="token comment" style="color:#999999">     * @return void</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">32</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">33</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">testFetchingPets</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">34</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">35</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Create a Pet</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">36</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">factory</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name class-name-fully-qualified static-context" style="color:#FAC863">AnimalFriend</span><span class="token class-name class-name-fully-qualified static-context punctuation" style="color:#8dc891">\</span><span class="token class-name class-name-fully-qualified static-context" style="color:#FAC863">Pet</span><span class="token operator" style="color:#d7deea">::</span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">create</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">37</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;name&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;Freddie&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">38</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;type&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;Cat&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">39</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">40</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">seeInDatabase</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;pets&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;type&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;Cat&#x27;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">41</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">42</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Create a User</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">43</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$user</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">factory</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name class-name-fully-qualified static-context" style="color:#FAC863">AnimalFriend</span><span class="token class-name class-name-fully-qualified static-context punctuation" style="color:#8dc891">\</span><span class="token class-name class-name-fully-qualified static-context" style="color:#FAC863">User</span><span class="token operator" style="color:#d7deea">::</span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">create</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">44</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;name&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;bobsmith&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">45</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;email&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;bob@example.com&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">46</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">47</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">seeInDatabase</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;users&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;email&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;bob@example.com&#x27;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">48</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">49</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Create request</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">50</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$token</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token class-name static-context" style="color:#FAC863">JWTAuth</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">fromUser</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$user</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">51</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$headers</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">array</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">52</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;Authorization&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;Bearer &#x27;</span><span class="token operator" style="color:#d7deea">.</span><span class="token variable" style="color:#d7deea">$token</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">53</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">54</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">55</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Send it</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">56</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">json</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;GET&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;/api/pets&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$headers</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">57</span><span class="token plain">            </span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">seeJsonStructure</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">58</span><span class="token plain">                </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;data&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">59</span><span class="token plain">                    </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;*&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">60</span><span class="token plain">                        </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;id&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">61</span><span class="token plain">                        </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;name&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">62</span><span class="token plain">                        </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;type&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">63</span><span class="token plain">                        </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;available&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">64</span><span class="token plain">                        </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;picture&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">65</span><span class="token plain">                    </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">66</span><span class="token plain">                </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">67</span><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">68</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">assertResponseStatus</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">200</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">69</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">70</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">71</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">72</span><span class="token comment" style="color:#999999">     * Test fetching pet when unauthorised</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">73</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">74</span><span class="token comment" style="color:#999999">     * @return void</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">75</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">76</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">testFetchingPetWhenUnauthorised</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">77</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">78</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Create a Pet</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">79</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">factory</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name class-name-fully-qualified static-context" style="color:#FAC863">AnimalFriend</span><span class="token class-name class-name-fully-qualified static-context punctuation" style="color:#8dc891">\</span><span class="token class-name class-name-fully-qualified static-context" style="color:#FAC863">Pet</span><span class="token operator" style="color:#d7deea">::</span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">create</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">80</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;name&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;Freddie&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">81</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;type&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;Cat&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">82</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">83</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">seeInDatabase</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;pets&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;type&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;Cat&#x27;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">84</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">85</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Send request</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">86</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$response</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">call</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;GET&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;/api/pets/&#x27;</span><span class="token operator" style="color:#d7deea">.</span><span class="token variable" style="color:#d7deea">$pet</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">id</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">87</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">assertResponseStatus</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">400</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">88</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">89</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">90</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">91</span><span class="token comment" style="color:#999999">     * Test fetching pet which does not exist</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">92</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">93</span><span class="token comment" style="color:#999999">     * @return void</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">94</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">95</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">testFetchingPetDoesNotExist</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">96</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">97</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Create a User</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">98</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$user</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">factory</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name class-name-fully-qualified static-context" style="color:#FAC863">AnimalFriend</span><span class="token class-name class-name-fully-qualified static-context punctuation" style="color:#8dc891">\</span><span class="token class-name class-name-fully-qualified static-context" style="color:#FAC863">User</span><span class="token operator" style="color:#d7deea">::</span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">create</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">99</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;name&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;bobsmith&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">100</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;email&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;bob@example.com&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">101</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">102</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">seeInDatabase</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;users&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;email&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;bob@example.com&#x27;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">103</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">104</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Create request</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">105</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$token</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token class-name static-context" style="color:#FAC863">JWTAuth</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">fromUser</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$user</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">106</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$headers</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">array</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">107</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;Authorization&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;Bearer &#x27;</span><span class="token operator" style="color:#d7deea">.</span><span class="token variable" style="color:#d7deea">$token</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">108</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">109</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">110</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Send it</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">111</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">json</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;GET&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;/api/pets/1&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$headers</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">112</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">assertResponseStatus</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">404</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">113</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">114</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">115</span><span class="token plain">    </span><span class="token comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">116</span><span class="token comment" style="color:#999999">     * Test fetching pet when authorised</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">117</span><span class="token comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">118</span><span class="token comment" style="color:#999999">     * @return void</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">119</span><span class="token comment" style="color:#999999">     */</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">120</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">public</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">function</span><span class="token plain"> </span><span class="token function-definition function" style="color:#79b6f2">testFetchingPet</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">121</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">122</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Create a Pet</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">123</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$pet</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">factory</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name class-name-fully-qualified static-context" style="color:#FAC863">AnimalFriend</span><span class="token class-name class-name-fully-qualified static-context punctuation" style="color:#8dc891">\</span><span class="token class-name class-name-fully-qualified static-context" style="color:#FAC863">Pet</span><span class="token operator" style="color:#d7deea">::</span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">create</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">124</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;name&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;Freddie&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">125</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;type&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;Cat&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">126</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">127</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">seeInDatabase</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;pets&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;type&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;Cat&#x27;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">128</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">129</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Create a User</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">130</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$user</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">factory</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token class-name class-name-fully-qualified static-context" style="color:#FAC863">AnimalFriend</span><span class="token class-name class-name-fully-qualified static-context punctuation" style="color:#8dc891">\</span><span class="token class-name class-name-fully-qualified static-context" style="color:#FAC863">User</span><span class="token operator" style="color:#d7deea">::</span><span class="token keyword" style="color:#c5a5c5">class</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">create</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">131</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;name&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;bobsmith&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">132</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;email&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;bob@example.com&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">133</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">134</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">seeInDatabase</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;users&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;email&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;bob@example.com&#x27;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">135</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">136</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Create request</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">137</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$token</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token class-name static-context" style="color:#FAC863">JWTAuth</span><span class="token operator" style="color:#d7deea">::</span><span class="token function" style="color:#79b6f2">fromUser</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token variable" style="color:#d7deea">$user</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">138</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$headers</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">array</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">139</span><span class="token plain">            </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;Authorization&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;Bearer &#x27;</span><span class="token operator" style="color:#d7deea">.</span><span class="token variable" style="color:#d7deea">$token</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">140</span><span class="token plain">        </span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">141</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">142</span><span class="token plain">        </span><span class="token comment" style="color:#999999">// Send it</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">143</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">json</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;GET&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;/api/pets/&#x27;</span><span class="token operator" style="color:#d7deea">.</span><span class="token variable" style="color:#d7deea">$pet</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token property" style="color:#5a9bcf">id</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token variable" style="color:#d7deea">$headers</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">144</span><span class="token plain">            </span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">seeJsonStructure</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">145</span><span class="token plain">                </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;data&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">146</span><span class="token plain">                    </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;id&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">147</span><span class="token plain">                    </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;name&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">148</span><span class="token plain">                    </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;type&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">149</span><span class="token plain">                    </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;available&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">150</span><span class="token plain">                    </span><span class="token string single-quoted-string" style="color:#8dc891">&#x27;picture&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">151</span><span class="token plain">                </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">152</span><span class="token plain">            </span><span class="token punctuation" style="color:#8dc891">]</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">153</span><span class="token plain">        </span><span class="token variable" style="color:#d7deea">$this</span><span class="token operator" style="color:#d7deea">-&gt;</span><span class="token function" style="color:#79b6f2">assertResponseStatus</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">200</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">154</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">155</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">We&#x27;re also going to amend our test settings to use the array backend for the cache, as this does not require any external dependencies, but still allows us to tag our cache keys (I&#x27;ll cover that in a future instalment). Change the cache settings in <code>phpunit.xml</code> as follows:</p><pre><div class="gatsby-highlight" data-language="xml"><pre class="prism-code language-xml" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">env</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#8dc891">=</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag attr-value" style="color:#8dc891">CACHE_DRIVER</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">value</span><span class="token tag attr-value punctuation attr-equals" style="color:#8dc891">=</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag attr-value" style="color:#8dc891">array</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag punctuation" style="color:#8dc891">/&gt;</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Let&#x27;s run our tests to make sure everything&#x27;s fine:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">$ vendor/bin/phpunit </span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">PHPUnit </span><span class="token number" style="color:#5a9bcf">5.5</span><span class="token plain">.4 by Sebastian Bergmann and contributors.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">..</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token punctuation" style="color:#8dc891">..</span><span class="token plain">                                                      </span><span class="token number" style="color:#5a9bcf">12</span><span class="token plain"> / </span><span class="token number" style="color:#5a9bcf">12</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">100</span><span class="token plain">%</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain">Time: </span><span class="token number" style="color:#5a9bcf">859</span><span class="token plain"> ms, Memory: </span><span class="token number" style="color:#5a9bcf">18</span><span class="token plain">.00MB</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain">OK </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token number" style="color:#5a9bcf">12</span><span class="token plain"> tests, </span><span class="token number" style="color:#5a9bcf">44</span><span class="token plain"> assertions</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">At present our <code>User</code> controller doesn&#x27;t actually return anything, and the auth only ever returns the token, so it&#x27;s not worth while adding a transformer now.</p><h2 class="py-4 text-2xl font-bold">Wrapping up</h2><p class="py-2">That ends this lesson. We haven&#x27;t added any functionality, but we have improved the design of our API, and we&#x27;re now ready to develop it further. As usual, the backend repository has been tagged as <code>lesson-4</code>.</p><p class="py-2">Next time we&#x27;ll start adding the additional functionality we need to our API.</p></section><hr/><div class="py-4"><a class="p-category" href="/blog/categories/php/"><span class="inline-block px-4 py-2 my-2 mr-2 text-sm font-bold text-gray-900 bg-purple-200 rounded-full hover:bg-purple-800 hover:text-gray-200 transition-colors duration-500">php</span></a><a class="p-category" href="/blog/categories/laravel/"><span class="inline-block px-4 py-2 my-2 mr-2 text-sm font-bold text-gray-900 bg-purple-200 rounded-full hover:bg-purple-800 hover:text-gray-200 transition-colors duration-500">laravel</span></a><a class="p-category" href="/blog/categories/javascript/"><span class="inline-block px-4 py-2 my-2 mr-2 text-sm font-bold text-gray-900 bg-purple-200 rounded-full hover:bg-purple-800 hover:text-gray-200 transition-colors duration-500">javascript</span></a><a class="p-category" href="/blog/categories/angular/"><span class="inline-block px-4 py-2 my-2 mr-2 text-sm font-bold text-gray-900 bg-purple-200 rounded-full hover:bg-purple-800 hover:text-gray-200 transition-colors duration-500">angular</span></a><a class="p-category" href="/blog/categories/phonegap/"><span class="inline-block px-4 py-2 my-2 mr-2 text-sm font-bold text-gray-900 bg-purple-200 rounded-full hover:bg-purple-800 hover:text-gray-200 transition-colors duration-500">phonegap</span></a><a class="p-category" href="/blog/categories/laravel-phonegap-tutorial/"><span class="inline-block px-4 py-2 my-2 mr-2 text-sm font-bold text-gray-900 bg-purple-200 rounded-full hover:bg-purple-800 hover:text-gray-200 transition-colors duration-500">laravel-phonegap-tutorial</span></a></div><nav class="pt-4 clear-both box-border"><a rel="prev" class="float-left w-1/2 p-2 shadow-sm hover:bg-gray-200 dark:hover:bg-gray-800 transition duration-300 ease-in-out" href="/blog/2016/10/24/creating-an-azure-storage-adapter-for-laravel/"><p><strong class="font-bold clear-both">← Previous page</strong></p><p class="pl-6">Creating an Azure storage adapter for Laravel</p></a><a rel="next" class="float-right w-1/2 p-2 shadow-sm hover:bg-gray-200 dark:hover:bg-gray-800 transition duration-300 ease-in-out" href="/blog/2016/11/26/easy-static-asset-versioning-in-php/"><p><strong>→ Next page</strong></p><p class="pl-6">Easy static asset versioning in PHP</p></a></nav><div id="disqus_thread"></div></article></main></div><footer class="w-full p-4 text-gray-100 bg-gray-800"><ul class="flex flex-row flex-wrap justify-center w-full p-2 mx-auto text-center md:w-2/3 box-border"><li class="w-1/3 my-2 md:w-1/6"><a href="/posts/1">Blog</a></li><li class="w-1/3 my-2 md:w-1/6"><a href="/about">About</a></li><li class="w-1/3 my-2 md:w-1/6"><a href="/contact">Contact</a></li><li class="w-1/3 my-2 md:w-1/6"><a href="https://twitter.com/mattbd">Twitter</a></li><li class="w-1/3 my-2 md:w-1/6"><a href="https://github.com/matthewbdaly">Github</a></li><li class="w-1/3 my-2 md:w-1/6"><a href="/rss.xml">Feed</a></li></ul><div class="w-full p-4 mx-auto text-center md:w-2/3"><p>© Matthew Daly <!-- -->2021</p></div></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-17043630-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/2016/11/13/building-a-phonegap-app-with-laravel-and-angular-part-4/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-6860dcd81490c6aa82f7.js"],"app":["/app-d77411d2a9a71ac63dc7.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-f73ba0fd1f8ccd9c9e51.js"],"component---src-pages-contact-tsx":["/component---src-pages-contact-tsx-675fa12544e3b3a03f7e.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-5205a883277333822a72.js"],"component---src-pages-search-tsx":["/component---src-pages-search-tsx-73edb3a3894897c2442d.js"],"component---src-templates-404-tsx":["/component---src-templates-404-tsx-ab0075b3d63edf37ce8b.js"],"component---src-templates-archives-tsx":["/component---src-templates-archives-tsx-d6565df0adcf40921e81.js"],"component---src-templates-categories-tsx":["/component---src-templates-categories-tsx-9d8c91434e407a29b108.js"],"component---src-templates-category-tsx":["/component---src-templates-category-tsx-c4b49257550e7ce69c55.js"],"component---src-templates-chunk-tsx":["/component---src-templates-chunk-tsx-8964f592e3e995933e96.js"],"component---src-templates-page-tsx":["/component---src-templates-page-tsx-26f553a9953981738a84.js"],"component---src-templates-post-tsx":["/component---src-templates-post-tsx-cc8c6bdbcd5a1c0c91b6.js"]};/*]]>*/</script><script src="/polyfill-6860dcd81490c6aa82f7.js" nomodule=""></script><script src="/component---src-templates-post-tsx-cc8c6bdbcd5a1c0c91b6.js" async=""></script><script src="/7840d69eefded84ab93ff6e879351e9a3a16821f-3cc77dc4aa7437d407dd.js" async=""></script><script src="/15a3be27178e285ff113e12c60c30466a8f4d4c5-05c94d59cdf70f961f79.js" async=""></script><script src="/751e6587c41c404721231b94fec2753859fa1aad-238a8becfca1bae1e52b.js" async=""></script><script src="/f0e45107-1ab5e6e9877396d2cf44.js" async=""></script><script src="/app-d77411d2a9a71ac63dc7.js" async=""></script><script src="/framework-aeedefbd40854c93cd6e.js" async=""></script><script src="/webpack-runtime-18e46328f4c5ead59e69.js" async=""></script></body></html>