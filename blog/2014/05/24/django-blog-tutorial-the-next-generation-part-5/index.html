<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta http-equiv="Content-Security-Policy" content="base-uri &#x27;self&#x27;; default-src &#x27;self&#x27; *.google-analytics.com disqus.com *.disqus.com *.disquscdn.com getform.io; script-src &#x27;self&#x27; localhost:* *.addthis.com *.google-analytics.com *.googletagmanager.com *.disquscdn.com *.disqus.com disqus.com *.addthisedge.com graph.facebook.com &#x27;unsafe-inline&#x27; &#x27;unsafe-eval&#x27;; style-src &#x27;self&#x27; fonts.googleapis.com *.addthis.com google-analytics.com *.disquscdn.com *.disqus.com &#x27;unsafe-inline&#x27;; object-src &#x27;none&#x27;; form-action &#x27;self&#x27; getform.io; font-src &#x27;self&#x27; data: fonts.google-apis.com fonts.gstatic.com; connect-src &#x27;self&#x27; ws://localhost:* *.google-analytics.com stats.g.doubleclick.net; img-src &#x27;self&#x27; *.google-analytics.com *.disquscdn.com *.disqus.com stats.g.doubleclick.net; child-src &#x27;self&#x27;; frame-src disqus.com *.addthis.com;"/><meta name="generator" content="Gatsby 4.25.9"/><meta data-react-helmet="true" name="description" content="Hello again! I was originally planning to cover implementing a search system, adding more feeds, and tidying up the front end in this instalment. However, I felt it was time for a…"/><meta data-react-helmet="true" property="og:title" content="Django blog tutorial - the next generation - part 5"/><meta data-react-helmet="true" property="og:description" content="Hello again! I was originally planning to cover implementing a search system, adding more feeds, and tidying up the front end in this instalment. However, I felt it was time for a…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta name="theme-color" content="#374151"/><style data-href="/styles.bbe6b9a56ec85678e6a0.css" data-identity="gatsby-global-css">/* ! tailwindcss v3.4.3 | MIT License | https://tailwindcss.com */*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}:host,html{-webkit-text-size-adjust:100%;font-feature-settings:normal;-webkit-tap-highlight-color:transparent;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-variation-settings:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-feature-settings:normal;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em;font-variation-settings:normal}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{font-feature-settings:inherit;color:inherit;font-family:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.float-right{float:right}.float-left{float:left}.float-none{float:none}.clear-both{clear:both}.m-0{margin:0}.mx-0{margin-left:0;margin-right:0}.mx-auto{margin-left:auto;margin-right:auto}.my-2{margin-bottom:.5rem;margin-top:.5rem}.my-4{margin-bottom:1rem;margin-top:1rem}.-mb-4{margin-bottom:-1rem}.-mb-8{margin-bottom:-2rem}.mr-2{margin-right:.5rem}.mr-8{margin-right:2rem}.mt-16{margin-top:4rem}.mt-2{margin-top:.5rem}.box-border{box-sizing:border-box}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.hidden{display:none}.h-2{height:.5rem}.h-4{height:1rem}.min-h-screen{min-height:100vh}.w-1\/2{width:50%}.w-1\/3{width:33.333333%}.w-1\/4{width:25%}.w-3\/4{width:75%}.w-full{width:100%}.flex-grow{flex-grow:1}.list-disc{list-style-type:disc}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.justify-center{justify-content:center}.space-y-16>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(4rem*var(--tw-space-y-reverse));margin-top:calc(4rem*(1 - var(--tw-space-y-reverse)))}.space-y-32>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(8rem*var(--tw-space-y-reverse));margin-top:calc(8rem*(1 - var(--tw-space-y-reverse)))}.space-y-8>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(2rem*var(--tw-space-y-reverse));margin-top:calc(2rem*(1 - var(--tw-space-y-reverse)))}.divide-y>:not([hidden])~:not([hidden]){--tw-divide-y-reverse:0;border-bottom-width:calc(1px*var(--tw-divide-y-reverse));border-top-width:calc(1px*(1 - var(--tw-divide-y-reverse)))}.divide-gray-800>:not([hidden])~:not([hidden]){--tw-divide-opacity:1;border-color:rgb(31 41 55/var(--tw-divide-opacity))}.overflow-x-auto{overflow-x:auto}.overflow-x-scroll{overflow-x:scroll}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:.5rem}.rounded-t-lg{border-top-left-radius:.5rem;border-top-right-radius:.5rem}.border-2{border-width:2px}.border-b-2{border-bottom-width:2px}.border-b-4{border-bottom-width:4px}.border-l-8{border-left-width:8px}.border-gray-100{--tw-border-opacity:1;border-color:rgb(243 244 246/var(--tw-border-opacity))}.border-gray-500{--tw-border-opacity:1;border-color:rgb(107 114 128/var(--tw-border-opacity))}.border-gray-800{--tw-border-opacity:1;border-color:rgb(31 41 55/var(--tw-border-opacity))}.border-green-400{--tw-border-opacity:1;border-color:rgb(74 222 128/var(--tw-border-opacity))}.border-transparent{border-color:transparent}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246/var(--tw-bg-opacity))}.bg-gray-300{--tw-bg-opacity:1;background-color:rgb(209 213 219/var(--tw-bg-opacity))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251/var(--tw-bg-opacity))}.bg-gray-800{--tw-bg-opacity:1;background-color:rgb(31 41 55/var(--tw-bg-opacity))}.bg-purple-200{--tw-bg-opacity:1;background-color:rgb(233 213 255/var(--tw-bg-opacity))}.bg-red-200{--tw-bg-opacity:1;background-color:rgb(254 202 202/var(--tw-bg-opacity))}.bg-gradient-to-b{background-image:linear-gradient(to bottom,var(--tw-gradient-stops))}.bg-gradient-to-r{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.from-gray-200{--tw-gradient-from:#e5e7eb var(--tw-gradient-from-position);--tw-gradient-to:rgba(229,231,235,0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.from-green-400{--tw-gradient-from:#4ade80 var(--tw-gradient-from-position);--tw-gradient-to:rgba(74,222,128,0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.via-blue-500{--tw-gradient-to:rgba(59,130,246,0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from),#3b82f6 var(--tw-gradient-via-position),var(--tw-gradient-to)}.to-gray-300{--tw-gradient-to:#d1d5db var(--tw-gradient-to-position)}.to-purple-500{--tw-gradient-to:#a855f7 var(--tw-gradient-to-position)}.p-2{padding:.5rem}.p-4{padding:1rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-4{padding-left:1rem;padding-right:1rem}.px-8{padding-left:2rem;padding-right:2rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.py-4{padding-bottom:1rem;padding-top:1rem}.pb-16{padding-bottom:4rem}.pl-4{padding-left:1rem}.pl-6{padding-left:1.5rem}.pt-4{padding-top:1rem}.text-center{text-align:center}.font-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.font-sans{font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}.text-2xl{font-size:1.5rem;line-height:2rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-bold{font-weight:700}.font-semibold{font-weight:600}.lowercase{text-transform:lowercase}.italic{font-style:italic}.leading-6{line-height:1.5rem}.text-gray-100{--tw-text-opacity:1;color:rgb(243 244 246/var(--tw-text-opacity))}.text-gray-200{--tw-text-opacity:1;color:rgb(229 231 235/var(--tw-text-opacity))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55/var(--tw-text-opacity))}.text-gray-900{--tw-text-opacity:1;color:rgb(17 24 39/var(--tw-text-opacity))}.antialiased{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.shadow-lg{--tw-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color)}.shadow-lg,.shadow-sm{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-sm{--tw-shadow:0 1px 2px 0 rgba(0,0,0,.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-colors{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.duration-300{transition-duration:.3s}.duration-500{transition-duration:.5s}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}code[class*=language-],pre[class*=language-]{display:block}.hover\:border-green-400:hover{--tw-border-opacity:1;border-color:rgb(74 222 128/var(--tw-border-opacity))}.hover\:bg-gray-200:hover{--tw-bg-opacity:1;background-color:rgb(229 231 235/var(--tw-bg-opacity))}.hover\:bg-purple-800:hover{--tw-bg-opacity:1;background-color:rgb(107 33 168/var(--tw-bg-opacity))}.hover\:text-gray-200:hover{--tw-text-opacity:1;color:rgb(229 231 235/var(--tw-text-opacity))}.focus\:border-blue-300:focus{--tw-border-opacity:1;border-color:rgb(147 197 253/var(--tw-border-opacity))}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\:ring:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(3px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}@media (min-width:768px){.md\:float-none{float:none}.md\:block{display:block}.md\:w-1\/6{width:16.666667%}.md\:w-2\/3{width:66.666667%}}@media (min-width:1024px){.lg\:float-right{float:right}.lg\:float-left{float:left}.lg\:mt-4{margin-top:1rem}.lg\:text-left{text-align:left}}@media (prefers-color-scheme:dark){.dark\:divide-gray-200>:not([hidden])~:not([hidden]){--tw-divide-opacity:1;border-color:rgb(229 231 235/var(--tw-divide-opacity))}.dark\:bg-gray-700{--tw-bg-opacity:1;background-color:rgb(55 65 81/var(--tw-bg-opacity))}.dark\:bg-gray-800{--tw-bg-opacity:1;background-color:rgb(31 41 55/var(--tw-bg-opacity))}.dark\:bg-gray-900{--tw-bg-opacity:1;background-color:rgb(17 24 39/var(--tw-bg-opacity))}.dark\:text-gray-100{--tw-text-opacity:1;color:rgb(243 244 246/var(--tw-text-opacity))}.dark\:text-gray-200{--tw-text-opacity:1;color:rgb(229 231 235/var(--tw-text-opacity))}.dark\:text-gray-300{--tw-text-opacity:1;color:rgb(209 213 219/var(--tw-text-opacity))}.dark\:text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55/var(--tw-text-opacity))}.dark\:hover\:bg-gray-800:hover{--tw-bg-opacity:1;background-color:rgb(31 41 55/var(--tw-bg-opacity))}}.prism-code{-webkit-overflow-scrolling:touch;background-color:transparent;border-radius:.2em;float:left;font-size:1rem;margin-bottom:1rem;margin-top:1rem;overflow:initial;padding-bottom:1rem;padding-top:1rem;position:relative}.prism-code.title{border-radius:0 0 .2em .2em}pre.prism-code{float:left;min-width:100%;overflow:initial;padding:20px}.token{display:inline-block}li>code,p>code{word-wrap:break-word;color:#ab79d6;white-space:pre-wrap}.gatsby-highlight{-webkit-overflow-scrolling:touch;font-size:1rem;overflow:auto;position:relative}.gatsby-highlight::-webkit-scrollbar{display:none}.gatsby-highlight>code[class*=language-],.gatsby>pre[class*=language-]{-webkit-hyphens:none;hyphens:none;line-height:1.5;overflow-wrap:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-break:normal;word-spacing:normal}.gatsby-highlight .token-line{border-left:4px solid transparent;margin-left:-20px;margin-right:-20px}.line-number-style{display:inline-block;opacity:.3;padding-left:1em;padding-right:2em;position:relative;text-align:center;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:1.2em}.gatsby-highlight .token-line.highlight-line{background-color:#023751;border-left:4px solid #029bce}.gatsby-highlight .token-line.highlight-line .line-number-style{left:0;opacity:.5;width:calc(1.2em - 4px)}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="search" type="application/opensearchdescription+xml" title="Matthew Daly" href="/opensearch.xml"/><script data-gatsby="web-vitals-polyfill">
              !function(){var e,t,n,i,r={passive:!0,capture:!0},a=new Date,o=function(){i=[],t=-1,e=null,f(addEventListener)},c=function(i,r){e||(e=r,t=i,n=new Date,f(removeEventListener),u())},u=function(){if(t>=0&&t<n-a){var r={entryType:"first-input",name:e.type,target:e.target,cancelable:e.cancelable,startTime:e.timeStamp,processingStart:e.timeStamp+t};i.forEach((function(e){e(r)})),i=[]}},s=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){c(e,t),a()},i=function(){a()},a=function(){removeEventListener("pointerup",n,r),removeEventListener("pointercancel",i,r)};addEventListener("pointerup",n,r),addEventListener("pointercancel",i,r)}(t,e):c(t,e)}},f=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,s,r)}))},p="hidden"===document.visibilityState?0:1/0;addEventListener("visibilitychange",(function e(t){"hidden"===document.visibilityState&&(p=t.timeStamp,removeEventListener("visibilitychange",e,!0))}),!0);o(),self.webVitals={firstInputPolyfill:function(e){i.push(e),u()},resetFirstInputPolyfill:o,get firstHiddenTime(){return p}}}();
            </script><script>window.dataLayer = window.dataLayer || [];window.dataLayer.push({"platform":"gatsby"}); (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl+'';f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer', 'G-68VZX216JS');</script><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><title data-react-helmet="true">Django blog tutorial - the next generation - part 5 | Matthew Daly</title><link data-react-helmet="true" href="https://matthewdaly.co.uk/blog/2014/05/24/django-blog-tutorial-the-next-generation-part-5/" rel="canonical"/><link data-react-helmet="true" href="https://github.com/matthewbdaly" rel="me"/><link data-react-helmet="true" href="https://mstdn.social/@matthewbdaly" rel="me"/><link data-react-helmet="true" href="mailto:matthew@matthewdaly.co.uk" rel="me"/><link data-react-helmet="true" href="/key.pub" rel="pgpkey"/><link data-react-helmet="true" href="https://webmention.io/matthewdaly.co.uk/xmlrpc" rel="pingback"/><link data-react-helmet="true" href="https://webmention.io/matthewdaly.co.uk/webmention" rel="webmention"/><link data-react-helmet="true" rel="authorization_endpoint" href="https://indieauth.com/auth"/><link data-react-helmet="true" rel="token_endpoint" href="https://tokens.indieauth.com/token"/><link data-react-helmet="true" rel="openid.delegate" href="https://matthewdaly.co.uk"/><link data-react-helmet="true" rel="openid.server" href="https://openid.indieauth.com/openid"/><link data-react-helmet="true" rel="alternate" type="application/rss+xml" title="Matthew Daly - feed" href="/rss.xml"/><link data-react-helmet="true" rel="alternate" type="application/atom+xml" title="Matthew Daly - feed" href="/atom.xml"/><link data-react-helmet="true" rel="alternate" type="application/feed+json" title="Matthew Daly - feed" href="/feed.json"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link rel="icon" href="/favicon-32x32.png?v=53aa06cf17e4239d0dba6ffd09854e02" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=53aa06cf17e4239d0dba6ffd09854e02"/></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=G-68VZX216JS" height="0" width="0" style="display: none; visibility: hidden" aria-hidden="true"></iframe></noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="flex flex-col min-h-screen pb-16 font-sans text-lg antialiased text-gray-800 bg-gray-50 dark:text-gray-100 dark:bg-gray-700 leading-6"><div class="w-full h-2 bg-gradient-to-r from-green-400 via-blue-500 to-purple-500"></div><nav class="w-full p-4 mx-auto lowercase md:w-2/3"><h1 class="block float-none py-4 text-4xl text-center lg:float-left lg:text-left"><a href="/">Matthew Daly</a></h1><ul class="py-2 text-center lg:float-right md:block lg:text-left"><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/blog/archives">Archives</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/about">About</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/uses">Uses</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/posts/1">Blog</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/blog/categories">Categories</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/search">Search</a></li></ul></nav><div class="w-full h-4 clear"></div><main class="flex-grow w-full p-4 mx-auto md:w-2/3"><article class="h-entry"><header><h2 class="py-4 text-2xl font-bold e-content p-name"><a class="u-url" href="https://matthewdaly.co.uk/blog/2014/05/24/django-blog-tutorial-the-next-generation-part-5/">Django blog tutorial - the next generation - part 5</a></h2><p class="my-4 text-lg font-semibold">Published by <a href="/" rel="author">Matthew Daly</a> at <!-- -->24th May 2014 7:15 pm</p><time class="hidden dt-published">2014-05-24T19:15:54+00:00</time></header><section><p class="py-2">Hello again! I was originally planning to cover implementing a search system, adding more feeds, and tidying up the front end in this instalment. However, I felt it was time for a change of pace, so instead, we&#x27;re going to look at:</p><ul class="py-2 pl-4"><li class="list-disc">Checking code coverage and getting it to 100%</li><li class="list-disc">Using continuous integration</li><li class="list-disc">Deploying to Heroku</li></ul><p class="py-2">Don&#x27;t worry, the original lesson isn&#x27;t going anywhere. We&#x27;ll still be implementing all of that later on, but today is the day we get your Django blog up and running on the web. That way, you can get a better idea of how Django works in the wild, and you have something concrete to show for your efforts.</p><h1 class="py-4 text-4xl font-bold">Continuous integration</h1><p class="py-2">If you&#x27;re not familiar with continuous integration, it&#x27;s basically a process that carries out some tasks automatically when you push a new commit to the repository. These tasks may include running unit tests, linting your code, and checking it to see what percentage of the code base is covered by the tests (after all, if your tests don&#x27;t actually cover every scenario, then there&#x27;s more of a chance that something might slip through the net. It&#x27;s also possible to implement hooks to automatically deploy your application only if the tests pass.</p><p class="py-2">Typically, you will have a continuous integration server running somewhere that regularly polls your Git repository for changes, and when it finds a new commit, will check it out and run the tests (or whatever other task you configure it to). One of the most popular continuous integration servers around is <a href="http://jenkins-ci.org/" class="border-b-2 border-green-400">Jenkins</a> - I use it at work and can highly recommend it. However, we aren&#x27;t going to cover using Jenkins here because setting it up is quite a big deal and it really is best kept on a server of its own (although feel free to use it if you prefer). Instead, we&#x27;re going to use <a href="https://travis-ci.org/" class="border-b-2 border-green-400">Travis CI</a>, which integrates nicely with GitHub and is free for open source projects. If you don&#x27;t mind your code being publicly available on GitHub, then Travis is a really great way to dip your toe into continuous integration.</p><p class="py-2">NB: You don&#x27;t have to use continuous integration at all if you don&#x27;t want to - this isn&#x27;t a big project so you don&#x27;t really need it. If you don&#x27;t want to put your code on GitHub, then feel free to just follow along and not bother pushing your code to GitHub and configuring Travis.</p><h1 class="py-4 text-4xl font-bold">Code coverage</h1><p class="py-2">As mentioned above, code coverage is a measure of the percentage of the code that is covered by tests. While not infallible, it&#x27;s a fairly good guide to how comprehensive your tests are. If you have 100% code coverage, you can be fairly confident that your tests are comprehensive enough to catch most errors, so it&#x27;s a good rule of thumb to aim for 100% test coverage on a project.</p><p class="py-2">So how do we check our test coverage? The <code>coverage</code> Python module is the most common tool for this. There&#x27;s also a handy Django module called <code>django-jenkins</code>, which is designed to work with Jenkins, but can be used with any continuous integration server, that can not only run your tests, but also check code coverage at the same time. So, make sure your virtualenv is up and running:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ </span><span class="token builtin class-name" style="color:#FAC863">source</span><span class="token plain"> venv/bin/activate</span></div></pre></div></pre><p class="py-2">Then, run the following command:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ pip </span><span class="token function" style="color:#79b6f2">install</span><span class="token plain"> coverage django-jenkins</span></div></pre></div></pre><p class="py-2">Once that&#x27;s done, add these to our requirements file:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ pip freeze </span><span class="token operator" style="color:#d7deea">&gt;</span><span class="token plain"> requirements.txt</span></div></pre></div></pre><p class="py-2">We now need to configure our Django project to use <code>django-jenkins</code>. Add the following to the bottom of the settings file:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">INSTALLED_APPS </span><span class="token operator" style="color:#d7deea">+=</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;django_jenkins&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">JENKINS_TASKS </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain">    </span><span class="token string" style="color:#8dc891">&#x27;django_jenkins.tasks.run_pylint&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain">    </span><span class="token string" style="color:#8dc891">&#x27;django_jenkins.tasks.with_coverage&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain">PROJECT_APPS </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token string" style="color:#8dc891">&#x27;blogengine&#x27;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">This adds <code>django-jenkins</code> to our installed apps and tells it to include two additional tasks, besides running the tests. The first task runs Pylint to check our code quality (but we aren&#x27;t really concerned about that at this point). The second checks the coverage. Finally, we tell <code>django-jenkins</code> that the <code>blogengine</code> app is the only one to be tested.</p><p class="py-2">You&#x27;ll also want to add the following lines to your <code>.gitignore</code>:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">reports/</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">htmlcov/</span></div></pre></div></pre><p class="py-2">These are the reports generated by <code>django-jenkins</code>, and should not be kept under version control. With that done, it&#x27;s time to commit:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">$ </span><span class="token function" style="color:#79b6f2">git</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">add</span><span class="token plain"> .gitignore django_tutorial_blog_ng/ requirements.txt</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">$ </span><span class="token function" style="color:#79b6f2">git</span><span class="token plain"> commit -m </span><span class="token string" style="color:#8dc891">&#x27;Added coverage checking using django-jenkins&#x27;</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Now, let&#x27;s run our tests. From now on, you&#x27;ll use the following command to run your tests:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ python manage.py jenkins</span></div></pre></div></pre><p class="py-2">This ensures we check the coverage at the same time. Now, you&#x27;ll notice that the <code>reports</code> folder has been created, and it will contain three files, including one called <code>coverage.xml</code>. However, XML isn&#x27;t a very friendly format. Happily, we can easily generate reports in HTML instead:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ python manage.py jenkins --coverage-html-report</span><span class="token operator" style="color:#d7deea">=</span><span class="token plain">htmlcov</span></div></pre></div></pre><p class="py-2">Running this command will create another folder called <code>htmlcov/</code>, and in here you will find your report, nicely formatted as HTML. Open up <code>index.html</code> in your web browser and you should see a file-by-file breakdown of your code coverage. Nice, huh?</p><p class="py-2">Now, if your code so far is largely identical to mine, you&#x27;ll notice that the model and view files don&#x27;t have 100% coverage yet. If you click on each one, you&#x27;ll see a handy line-by-line breakdown of the test coverage for each file. You&#x27;ll notice that in the views file, the areas of the code for when tags and categories don&#x27;t exist are highlighted in pink - this tells you that these lines of code are never executed during the tests. So let&#x27;s fix that.</p><p class="py-2">First, our template needs to be able to handle empty lists.</p><pre><div class="gatsby-highlight" data-language="django"><pre class="prism-code language-django" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{%</span><span class="token django language-django"> </span><span class="token django language-django tag keyword" style="color:#c5a5c5">extends</span><span class="token django language-django"> </span><span class="token django language-django string" style="color:#8dc891">&quot;blogengine/includes/base.html&quot;</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">%}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain">    </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{%</span><span class="token django language-django"> </span><span class="token django language-django tag keyword" style="color:#c5a5c5">load</span><span class="token django language-django"> </span><span class="token django language-django variable" style="color:#d7deea">custom_markdown</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">%}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain">    </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{%</span><span class="token django language-django"> </span><span class="token django language-django tag keyword" style="color:#c5a5c5">block</span><span class="token django language-django"> </span><span class="token django language-django variable" style="color:#d7deea">content</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">%}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain">        </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{%</span><span class="token django language-django"> </span><span class="token django language-django tag keyword" style="color:#c5a5c5">if</span><span class="token django language-django"> </span><span class="token django language-django variable" style="color:#d7deea">object_list</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">%}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain">            </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{%</span><span class="token django language-django"> </span><span class="token django language-django tag keyword" style="color:#c5a5c5">for</span><span class="token django language-django"> </span><span class="token django language-django variable" style="color:#d7deea">post</span><span class="token django language-django"> </span><span class="token django language-django keyword" style="color:#c5a5c5">in</span><span class="token django language-django"> </span><span class="token django language-django variable" style="color:#d7deea">object_list</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">%}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">class</span><span class="token tag attr-value punctuation attr-equals" style="color:#8dc891">=</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag attr-value" style="color:#8dc891">post</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">h1</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">a</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">href</span><span class="token tag attr-value punctuation attr-equals" style="color:#8dc891">=</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag attr-value django language-django delimiter punctuation" style="color:#8dc891">{{</span><span class="token tag attr-value django language-django" style="color:#8dc891"> </span><span class="token tag attr-value django language-django variable" style="color:#d7deea">post</span><span class="token tag attr-value django language-django punctuation" style="color:#8dc891">.</span><span class="token tag attr-value django language-django variable" style="color:#d7deea">get_absolute_url</span><span class="token tag attr-value django language-django" style="color:#8dc891"> </span><span class="token tag attr-value django language-django delimiter punctuation" style="color:#8dc891">}}</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{{</span><span class="token django language-django"> </span><span class="token django language-django variable" style="color:#d7deea">post</span><span class="token django language-django punctuation" style="color:#8dc891">.</span><span class="token django language-django variable" style="color:#d7deea">title</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">}}</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">a</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">h1</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">h3</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{{</span><span class="token django language-django"> </span><span class="token django language-django variable" style="color:#d7deea">post</span><span class="token django language-django punctuation" style="color:#8dc891">.</span><span class="token django language-django variable" style="color:#d7deea">pub_date</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">}}</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">h3</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token plain">            </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{{</span><span class="token django language-django"> </span><span class="token django language-django variable" style="color:#d7deea">post</span><span class="token django language-django punctuation" style="color:#8dc891">.</span><span class="token django language-django variable" style="color:#d7deea">text</span><span class="token django language-django operator" style="color:#d7deea">|</span><span class="token django language-django filter function" style="color:#79b6f2">custom_markdown</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">}}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">12</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">div</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">13</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">a</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">href</span><span class="token tag attr-value punctuation attr-equals" style="color:#8dc891">=</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag attr-value django language-django delimiter punctuation" style="color:#8dc891">{{</span><span class="token tag attr-value django language-django" style="color:#8dc891"> </span><span class="token tag attr-value django language-django variable" style="color:#d7deea">post</span><span class="token tag attr-value django language-django punctuation" style="color:#8dc891">.</span><span class="token tag attr-value django language-django variable" style="color:#d7deea">category</span><span class="token tag attr-value django language-django punctuation" style="color:#8dc891">.</span><span class="token tag attr-value django language-django variable" style="color:#d7deea">get_absolute_url</span><span class="token tag attr-value django language-django" style="color:#8dc891"> </span><span class="token tag attr-value django language-django delimiter punctuation" style="color:#8dc891">}}</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{{</span><span class="token django language-django"> </span><span class="token django language-django variable" style="color:#d7deea">post</span><span class="token django language-django punctuation" style="color:#8dc891">.</span><span class="token django language-django variable" style="color:#d7deea">category</span><span class="token django language-django punctuation" style="color:#8dc891">.</span><span class="token django language-django variable" style="color:#d7deea">name</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">}}</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">a</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">14</span><span class="token plain">            </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{%</span><span class="token django language-django"> </span><span class="token django language-django tag keyword" style="color:#c5a5c5">for</span><span class="token django language-django"> </span><span class="token django language-django variable" style="color:#d7deea">tag</span><span class="token django language-django"> </span><span class="token django language-django keyword" style="color:#c5a5c5">in</span><span class="token django language-django"> </span><span class="token django language-django variable" style="color:#d7deea">post</span><span class="token django language-django punctuation" style="color:#8dc891">.</span><span class="token django language-django variable" style="color:#d7deea">tags</span><span class="token django language-django punctuation" style="color:#8dc891">.</span><span class="token django language-django variable" style="color:#d7deea">all</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">%}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">15</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">a</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">href</span><span class="token tag attr-value punctuation attr-equals" style="color:#8dc891">=</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag attr-value django language-django delimiter punctuation" style="color:#8dc891">{{</span><span class="token tag attr-value django language-django" style="color:#8dc891"> </span><span class="token tag attr-value django language-django variable" style="color:#d7deea">tag</span><span class="token tag attr-value django language-django punctuation" style="color:#8dc891">.</span><span class="token tag attr-value django language-django variable" style="color:#d7deea">get_absolute_url</span><span class="token tag attr-value django language-django" style="color:#8dc891"> </span><span class="token tag attr-value django language-django delimiter punctuation" style="color:#8dc891">}}</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{{</span><span class="token django language-django"> </span><span class="token django language-django variable" style="color:#d7deea">tag</span><span class="token django language-django punctuation" style="color:#8dc891">.</span><span class="token django language-django variable" style="color:#d7deea">name</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">}}</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">a</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">16</span><span class="token plain">            </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{%</span><span class="token django language-django"> </span><span class="token django language-django tag keyword" style="color:#c5a5c5">endfor</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">%}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">17</span><span class="token plain">            </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{%</span><span class="token django language-django"> </span><span class="token django language-django tag keyword" style="color:#c5a5c5">endfor</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">%}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">18</span><span class="token plain">        </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{%</span><span class="token django language-django"> </span><span class="token django language-django tag keyword" style="color:#c5a5c5">else</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">%}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">19</span><span class="token plain">            </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain">No posts found</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">p</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">20</span><span class="token plain">        </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{%</span><span class="token django language-django"> </span><span class="token django language-django tag keyword" style="color:#c5a5c5">endif</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">%}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">21</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">22</span><span class="token plain">        </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{%</span><span class="token django language-django"> </span><span class="token django language-django tag keyword" style="color:#c5a5c5">if</span><span class="token django language-django"> </span><span class="token django language-django variable" style="color:#d7deea">page_obj</span><span class="token django language-django punctuation" style="color:#8dc891">.</span><span class="token django language-django variable" style="color:#d7deea">has_previous</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">%}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">23</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">a</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">href</span><span class="token tag attr-value punctuation attr-equals" style="color:#8dc891">=</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag attr-value" style="color:#8dc891">/</span><span class="token tag attr-value django language-django delimiter punctuation" style="color:#8dc891">{{</span><span class="token tag attr-value django language-django" style="color:#8dc891"> </span><span class="token tag attr-value django language-django variable" style="color:#d7deea">page_obj</span><span class="token tag attr-value django language-django punctuation" style="color:#8dc891">.</span><span class="token tag attr-value django language-django variable" style="color:#d7deea">previous_page_number</span><span class="token tag attr-value django language-django" style="color:#8dc891"> </span><span class="token tag attr-value django language-django delimiter punctuation" style="color:#8dc891">}}</span><span class="token tag attr-value" style="color:#8dc891">/</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain">Previous Page</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">a</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">24</span><span class="token plain">        </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{%</span><span class="token django language-django"> </span><span class="token django language-django tag keyword" style="color:#c5a5c5">endif</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">%}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">25</span><span class="token plain">        </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{%</span><span class="token django language-django"> </span><span class="token django language-django tag keyword" style="color:#c5a5c5">if</span><span class="token django language-django"> </span><span class="token django language-django variable" style="color:#d7deea">page_obj</span><span class="token django language-django punctuation" style="color:#8dc891">.</span><span class="token django language-django variable" style="color:#d7deea">has_next</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">%}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">26</span><span class="token plain">        </span><span class="token tag punctuation" style="color:#8dc891">&lt;</span><span class="token tag" style="color:#fc929e">a</span><span class="token tag" style="color:#fc929e"> </span><span class="token tag attr-name" style="color:#c5a5c5">href</span><span class="token tag attr-value punctuation attr-equals" style="color:#8dc891">=</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag attr-value" style="color:#8dc891">/</span><span class="token tag attr-value django language-django delimiter punctuation" style="color:#8dc891">{{</span><span class="token tag attr-value django language-django" style="color:#8dc891"> </span><span class="token tag attr-value django language-django variable" style="color:#d7deea">page_obj</span><span class="token tag attr-value django language-django punctuation" style="color:#8dc891">.</span><span class="token tag attr-value django language-django variable" style="color:#d7deea">next_page_number</span><span class="token tag attr-value django language-django" style="color:#8dc891"> </span><span class="token tag attr-value django language-django delimiter punctuation" style="color:#8dc891">}}</span><span class="token tag attr-value" style="color:#8dc891">/</span><span class="token tag attr-value punctuation" style="color:#8dc891">&quot;</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain">Next Page</span><span class="token tag punctuation" style="color:#8dc891">&lt;/</span><span class="token tag" style="color:#fc929e">a</span><span class="token tag punctuation" style="color:#8dc891">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">27</span><span class="token plain">        </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{%</span><span class="token django language-django"> </span><span class="token django language-django tag keyword" style="color:#c5a5c5">endif</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">%}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">28</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">29</span><span class="token plain">    </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">{%</span><span class="token django language-django"> </span><span class="token django language-django tag keyword" style="color:#c5a5c5">endblock</span><span class="token django language-django"> </span><span class="token django language-django delimiter punctuation" style="color:#8dc891">%}</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Let&#x27;s commit the changes:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">$ </span><span class="token function" style="color:#79b6f2">git</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">add</span><span class="token plain"> templates/blogengine/post_list.html</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">$ </span><span class="token function" style="color:#79b6f2">git</span><span class="token plain"> commit -m </span><span class="token string" style="color:#8dc891">&#x27;Added a &quot;No posts found&quot; message to post list template&#x27;</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Next, we need to write tests to check that we get a &quot;No posts found&quot; message when we view a tag or category that does not exist. Add the following methods to the class <code>PostViewTest()</code>:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">def</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">test_nonexistent_category_page</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">        category_url </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;/category/blah/&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain">        response </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">client</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">category_url</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain">        self</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">assertEquals</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">response</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">status_code</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">200</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain">        self</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">assertTrue</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;No posts found&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">in</span><span class="token plain"> response</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">content</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">def</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">test_nonexistent_tag_page</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain">        tag_url </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;/tag/blah/&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain">        response </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">client</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">tag_url</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token plain">        self</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">assertEquals</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">response</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">status_code</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">200</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token plain">        self</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">assertTrue</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;No posts found&#x27;</span><span class="token plain"> </span><span class="token keyword" style="color:#c5a5c5">in</span><span class="token plain"> response</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">content</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Now, let&#x27;s run our tests again:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ python manage.py jenkins --coverage-html-report</span><span class="token operator" style="color:#d7deea">=</span><span class="token plain">htmlcov</span></div></pre></div></pre><p class="py-2">Assuming they all pass as expected, then your coverage reports will be regenerated. If you reload the coverage report, you should see that your views now have 100% test coverage. Let&#x27;s commit again:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">$ </span><span class="token function" style="color:#79b6f2">git</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">add</span><span class="token plain"> blogengine/tests.py</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">$ </span><span class="token function" style="color:#79b6f2">git</span><span class="token plain"> commit -m </span><span class="token string" style="color:#8dc891">&#x27;Views file now has 100% coverage&#x27;</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Now, our models still don&#x27;t have 100% coverage yet. If you look at the breakdown for <code>models.py</code>, you&#x27;ll see that the line <code>if not self.slug:</code> has only partial coverage, because we missed out setting a slug for the categories and tags in our test. So, let&#x27;s fix that. In <code>PostTest()</code>, amend the <code>test_create_category()</code> and <code>test_create_tag()</code> methods as follows:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">def</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">test_create_category</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">        </span><span class="token comment" style="color:#999999"># Create the category</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain">        category </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> Category</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain">        </span><span class="token comment" style="color:#999999"># Add attributes</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain">        category</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">name </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;python&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain">        category</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">description </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;The Python programming language&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain">        category</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">slug </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;python&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token plain">        </span><span class="token comment" style="color:#999999"># Save it</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token plain">        category</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">save</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">12</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">13</span><span class="token plain">        </span><span class="token comment" style="color:#999999"># Check we can find it</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">14</span><span class="token plain">        all_categories </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> Category</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token builtin" style="color:#D8DEE9">all</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">15</span><span class="token plain">        self</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">assertEquals</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token builtin" style="color:#D8DEE9">len</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">all_categories</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">1</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">16</span><span class="token plain">        only_category </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> all_categories</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">17</span><span class="token plain">        self</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">assertEquals</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">only_category</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> category</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">18</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">19</span><span class="token plain">        </span><span class="token comment" style="color:#999999"># Check attributes</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">20</span><span class="token plain">        self</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">assertEquals</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">only_category</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;python&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">21</span><span class="token plain">        self</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">assertEquals</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">only_category</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">description</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;The Python programming language&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">22</span><span class="token plain">        self</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">assertEquals</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">only_category</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">slug</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;python&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">23</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">24</span><span class="token plain">    </span><span class="token keyword" style="color:#c5a5c5">def</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">test_create_tag</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">25</span><span class="token plain">        </span><span class="token comment" style="color:#999999"># Create the tag</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">26</span><span class="token plain">        tag </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> Tag</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">27</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">28</span><span class="token plain">        </span><span class="token comment" style="color:#999999"># Add attributes</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">29</span><span class="token plain">        tag</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">name </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;python&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">30</span><span class="token plain">        tag</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">description </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;The Python programming language&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">31</span><span class="token plain">        tag</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">slug </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;python&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">32</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">33</span><span class="token plain">        </span><span class="token comment" style="color:#999999"># Save it</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">34</span><span class="token plain">        tag</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">save</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">35</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">36</span><span class="token plain">        </span><span class="token comment" style="color:#999999"># Check we can find it</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">37</span><span class="token plain">        all_tags </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> Tag</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">objects</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token builtin" style="color:#D8DEE9">all</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">38</span><span class="token plain">        self</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">assertEquals</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token builtin" style="color:#D8DEE9">len</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">all_tags</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token number" style="color:#5a9bcf">1</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">39</span><span class="token plain">        only_tag </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> all_tags</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token number" style="color:#5a9bcf">0</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">40</span><span class="token plain">        self</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">assertEquals</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">only_tag</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> tag</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">41</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">42</span><span class="token plain">        </span><span class="token comment" style="color:#999999"># Check attributes</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">43</span><span class="token plain">        self</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">assertEquals</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">only_tag</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;python&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">44</span><span class="token plain">        self</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">assertEquals</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">only_tag</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">description</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;The Python programming language&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">45</span><span class="token plain">        self</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">assertEquals</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">only_tag</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">slug</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;python&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Run the tests again:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ python manage.py jenkins --coverage-html-report</span><span class="token operator" style="color:#d7deea">=</span><span class="token plain">htmlcov</span></div></pre></div></pre><p class="py-2">Then refresh your coverage page, and we should have hit 100% coverage. Excellent news! This means that we can be confident that if any problems get introduced in future, we can pick them up easily. To demonstrate this, let&#x27;s upgrade our Django install to the latest version and check everything still works as expected:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ pip </span><span class="token function" style="color:#79b6f2">install</span><span class="token plain"> Django --upgrade</span></div></pre></div></pre><p class="py-2">This will upgrade the copy of Django in our virtualenv to the latest version. Then we can run our tests again:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ python manage.py jenkins --coverage-html-report</span><span class="token operator" style="color:#d7deea">=</span><span class="token plain">htmlcov</span></div></pre></div></pre><p class="py-2">Our tests should still pass, indicating that the upgrade to our Django version does not appear to have broken any functionality. Let&#x27;s update our <code>requirements.txt</code>:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">$ pip freeze </span><span class="token operator" style="color:#d7deea">&gt;</span><span class="token plain"> requirements.txt</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">$ </span><span class="token function" style="color:#79b6f2">git</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">add</span><span class="token plain"> requirements.txt</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain">$ </span><span class="token function" style="color:#79b6f2">git</span><span class="token plain"> commit -m </span><span class="token string" style="color:#8dc891">&#x27;Upgraded Django version&#x27;</span><span class="token plain"></span></div></pre></div></pre><h1 class="py-4 text-4xl font-bold">Preparing our web app for deployment to Heroku</h1><p class="py-2">As mentioned previously, I&#x27;m going to assume you plan to deploy your site on <a href="https://www.heroku.com/" class="border-b-2 border-green-400">Heroku</a>. It has good Django support, and you can quite happily host a blog there using their free tariff. If you&#x27;d prefer to use another hosting provider, then you should be able to adapt these instructions accordingly.</p><p class="py-2">Now, so far we&#x27;ve used SQLite as our database for development purposes. However, SQLite isn&#x27;t really suitable for production purposes. Heroku provide a Postgresql database for each web app, so we will use that. To configure it, open up <code>settings.py</code> and amend the database configuration section to look like this:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">DATABASES </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">    </span><span class="token string" style="color:#8dc891">&#x27;default&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">{</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain">        </span><span class="token string" style="color:#8dc891">&#x27;ENGINE&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;django.db.backends.&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain">        </span><span class="token string" style="color:#8dc891">&#x27;NAME&#x27;</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain">    </span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">}</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Then, add the following at the end of the file:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain"></span><span class="token comment" style="color:#999999"># Heroku config</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain"></span><span class="token comment" style="color:#999999"># Parse database configuration from $DATABASE_URL</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> dj_database_url</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain">DATABASES</span><span class="token punctuation" style="color:#8dc891">[</span><span class="token string" style="color:#8dc891">&#x27;default&#x27;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"> </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain">  dj_database_url</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">config</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">default</span><span class="token operator" style="color:#d7deea">=</span><span class="token string" style="color:#8dc891">&quot;sqlite:///db.sqlite3&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain"></span><span class="token comment" style="color:#999999"># Honor the &#x27;X-Forwarded-Proto&#x27; header for request.is_secure()</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain">SECURE_PROXY_SSL_HEADER </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&#x27;HTTP_X_FORWARDED_PROTO&#x27;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;https&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token plain"></span><span class="token comment" style="color:#999999"># Allow all host headers</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token plain">ALLOWED_HOSTS </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">[</span><span class="token string" style="color:#8dc891">&#x27;*&#x27;</span><span class="token punctuation" style="color:#8dc891">]</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">12</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">13</span><span class="token plain"></span><span class="token comment" style="color:#999999"># Static asset configuration</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">14</span><span class="token plain">STATIC_ROOT </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;staticfiles&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">15</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">16</span><span class="token plain">STATICFILES_DIRS </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">17</span><span class="token plain">    os</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">path</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">BASE_DIR</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&#x27;static&#x27;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">18</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">A little explanation is called for. Remember when we first started out, we installed the <code>django-toolbelt</code> package, which included <code>dj-database-url</code>? Well, here we use the <code>dj_database_url</code> module to get the database from an environment variable set on Heroku. We set a default value so as to fall back to SQLite when that variable is not set. The other settings are required by Heroku.</p><p class="py-2">You may want to run your tests again to ensure everything is still working before committing:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">$ </span><span class="token function" style="color:#79b6f2">git</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">add</span><span class="token plain"> django_tutorial_blog_ng/settings.py</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">$ </span><span class="token function" style="color:#79b6f2">git</span><span class="token plain"> commit -m </span><span class="token string" style="color:#8dc891">&#x27;Amended settings to work on desktop and Heroku&#x27;</span><span class="token plain"></span></div></pre></div></pre><h1 class="py-4 text-4xl font-bold">Setting up Continuous Integration and coverage</h1><p class="py-2">Now, as mentioned previously, I&#x27;ll be demonstrating how to set up Travis CI for our project. Travis CI is only free for open-source projects, so if you don&#x27;t want to make your code publicly accessible, you may want to use Jenkins instead. I&#x27;ll leave setting that up and running it as an exercise for the reader, but I recommend a plugin called Cobertura which allows you to publish details of your code&#x27;s test coverage.</p><p class="py-2">Unfortunately, Travis CI doesn&#x27;t have the capability to publish your coverage results. Fortunately, you can use <a href="https://coveralls.io/" class="border-b-2 border-green-400">Coveralls.io</a> to pick up the slack. Like Travis, it&#x27;s free for open-source projects, and if you host your code on GitHub, it&#x27;s pretty easy to use.</p><p class="py-2">You can find instructions on setting up a project on Travis CI <a href="http://docs.travis-ci.com/user/getting-started/" class="border-b-2 border-green-400">here</a>. Once you&#x27;ve configured it, you&#x27;ll need to set up your <code>.travis.yml</code> file. This is a simple text file that tells Travis CI how to run your tests. Put the following content in the file:</p><pre><div class="gatsby-highlight" data-language="yml"><pre class="prism-code language-yml" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token key atrule" style="color:#FAC863">language</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> python</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">python</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain"></span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;2.7&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain"></span><span class="token comment" style="color:#999999"># command to install dependencies</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">install</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;pip install -r requirements.txt&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain"></span><span class="token comment" style="color:#999999"># command to run tests</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">script</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"> coverage run </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">include=&quot;blogengine/</span><span class="token important" style="font-weight:400">*&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#8dc891">-</span><span class="token punctuation" style="color:#8dc891">-</span><span class="token plain">omit=&quot;blogengine/migrations/</span><span class="token important" style="font-weight:400">*&quot;</span><span class="token plain"> manage.py test blogengine</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token plain"></span><span class="token key atrule" style="color:#FAC863">after_success</span><span class="token punctuation" style="color:#8dc891">:</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token plain">    coveralls</span></div></pre></div></pre><p class="py-2">Now, this tells Travis that this is a Python application, and we should be using Python 2.7. Please note you can test against multiple versions of Python if you wish - just add another line with the Python version you want to test against.</p><p class="py-2">Then, we see that we use Pip to install our requirements. Finally we run our tests with Coverage, in order to generate coverage data, and afterwards call <code>coveralls</code> to pass the coverage data to Coveralls.io.</p><p class="py-2">We also need to install the <code>coveralls</code> module:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">$ pip </span><span class="token function" style="color:#79b6f2">install</span><span class="token plain"> coveralls</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">$ pip freeze </span><span class="token operator" style="color:#d7deea">&gt;</span><span class="token plain"> requirements.txt</span></div></pre></div></pre><p class="py-2">And we need to keep our coverage data out of version control:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">env/</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">*.pyc</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain">db.sqlite3</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain">blogengine/static/bower_components/</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain">reports/</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain">htmlcov/</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain">.coverage</span></div></pre></div></pre><p class="py-2">You&#x27;ll also want to set up your project on Coveralls, as described <a href="https://coveralls.io/docs" class="border-b-2 border-green-400">here</a> - please note that this requires your project be in a public GitHub repository.</p><p class="py-2">With that done, let&#x27;s commit our changes:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">$ </span><span class="token function" style="color:#79b6f2">git</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">add</span><span class="token plain"> .gitignore .travis.yml requirements.txt</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">$ </span><span class="token function" style="color:#79b6f2">git</span><span class="token plain"> commit -m </span><span class="token string" style="color:#8dc891">&#x27;Added Travis config file and Coveralls support&#x27;</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">With that done, assuming you have Travis CI and Coveralls configured, and your code is already hosted on GitHub, then you should be able to just push your code up to trigger the build:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ </span><span class="token function" style="color:#79b6f2">git</span><span class="token plain"> push origin master</span></div></pre></div></pre><p class="py-2">If you keep an eye on Travis in your browser, you can watch what happens as your tests are run. If for any reason the build fails, then it shouldn&#x27;t be too hard to figure out what has gone wrong using the documentation for Travis and Coveralls - both services are pretty easy to use.</p><p class="py-2">Congratulations - you&#x27;re now using Continuous Integration! That wasn&#x27;t so hard, was it? Now, every time you push to GitHub, Travis will run your tests, and you&#x27;ll get an email if they fail, giving you early warning of any problems, and you can check your coverage at the same time. Both Travis and Coveralls offer badges that you can place in your README file on GitHub to show off your coverage and build status - feel free to add these to your repo.</p><p class="py-2">You may want to try making a change that breaks your tests and committing it, then pushing it up, so that you can see what happens when the build breaks.</p><h1 class="py-4 text-4xl font-bold">Deploying to Heroku</h1><p class="py-2">Our final task today is deploying our blog to Heroku so we can see it in action. First of all, if you don&#x27;t already have an account with Heroku, you&#x27;ll need to sign up <a href="https://www.heroku.com/" class="border-b-2 border-green-400">here</a>. You should also be prompted to install the Heroku toolbelt. Once that&#x27;s done, run the following command:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ heroku login</span></div></pre></div></pre><p class="py-2">You&#x27;ll be prompted for your credentials - enter these and you should be able to log in successfully.</p><p class="py-2">Now, in order to run our Django app on Heroku, we&#x27;ll need to add a <code>Procfile</code> to tell Heroku what command to run in order to start your app. In this case, we will be using Gunicorn as our web server. Assuming our project is called <code>django_tutorial_blog_ng</code>, this is what you need to put in this file:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">web: gunicorn django_tutorial_blog_ng.wsgi</span></div></pre></div></pre><p class="py-2">That tells Heroku that the file we need to run for this application is <code>django_tutorial_blog_ng/wsgi.py</code>. To test it, run the following command:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ foreman start</span></div></pre></div></pre><p class="py-2">That will start our web server on port 5000, using Gunicorn rather than the Django development server. You should be able to see it in action <a href="http://127.0.0.1:5000/" class="border-b-2 border-green-400">here</a>, but you&#x27;ll notice a very serious issue - namely that the static files aren&#x27;t being served. Now, Django has a command called <code>collectstatic</code> that collects all the static files and drops them into one convenient folder. Heroku will run this command automatically, so we need to ensure our static files are available. Amend your <code>.gitignore</code> file so it no longer excludes our static files:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">venv/</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">*.pyc</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain">db.sqlite3</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain">reports/</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain">htmlcov/</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain">.coverage</span></div></pre></div></pre><p class="py-2">We also need to amend our wsgi.py to serve static files:</p><pre><div class="gatsby-highlight" data-language="python"><pre class="prism-code language-python" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> os</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">os</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">setdefault</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token string" style="color:#8dc891">&quot;DJANGO_SETTINGS_MODULE&quot;</span><span class="token punctuation" style="color:#8dc891">,</span><span class="token plain"> </span><span class="token string" style="color:#8dc891">&quot;django_tutorial_blog_ng.settings&quot;</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">from</span><span class="token plain"> django</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">core</span><span class="token punctuation" style="color:#8dc891">.</span><span class="token plain">wsgi </span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> get_wsgi_application</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token plain"></span><span class="token keyword" style="color:#c5a5c5">from</span><span class="token plain"> dj_static </span><span class="token keyword" style="color:#c5a5c5">import</span><span class="token plain"> Cling</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token plain">application </span><span class="token operator" style="color:#d7deea">=</span><span class="token plain"> Cling</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token plain">get_wsgi_application</span><span class="token punctuation" style="color:#8dc891">(</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token punctuation" style="color:#8dc891">)</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">This should solve our problem. Let&#x27;s commit our changes:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">$ </span><span class="token function" style="color:#79b6f2">git</span><span class="token plain"> </span><span class="token function" style="color:#79b6f2">add</span><span class="token plain"> django_tutorial_blog_ng/wsgi.py Procfile blogengine/static/ .gitignore</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">$ </span><span class="token function" style="color:#79b6f2">git</span><span class="token plain"> commit -m </span><span class="token string" style="color:#8dc891">&#x27;Configured app for deployment on Heroku&#x27;</span><span class="token plain"></span></div></pre></div></pre><p class="py-2">Now we&#x27;re ready to deploy our app!</p><h1 class="py-4 text-4xl font-bold">Deployment</h1><p class="py-2">Every Heroku app needs a unique name. If you don&#x27;t specify one, then Heroku will generate one for you. Your app will have the domain name <code>appname.herokuapp.com</code> - however, if you already have a domain name lined up for your blog, you can point that domain name at the Heroku app if you wish. I&#x27;m going to deploy mine with the name <code>blog-shellshocked-info</code>.</p><p class="py-2">You also need to consider where you want to deploy it. Heroku has two regions - North America and EU. By default it will deploy to North America, but as I&#x27;m in the EU, that&#x27;s where I want to deploy my app to - obviously if you&#x27;re in the Americas, you may be better off sticking with North America.</p><p class="py-2">So, let&#x27;s create our app. Here&#x27;s the command you need to run:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ heroku apps:create blog-shellshocked-info --region eu</span></div></pre></div></pre><p class="py-2">You will want to change the app name, or remove it entirely if you&#x27;re happy for Heroku to generate one for you. If you want to host it in North America, drop the <code> --region eu</code> section.</p><p class="py-2">Once completed, this will have created your new app, and added a Git remote for it, but will not have deployed it. To deploy your app, run this command:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style"></span><span class="token plain">$ </span><span class="token function" style="color:#79b6f2">git</span><span class="token plain"> push heroku master</span></div></pre></div></pre><p class="py-2">That will push your code up to Heroku. Please note that building the app may take a little while. Once it&#x27;s done, you can run <code>heroku open</code> to open it in your web browser. You should see an error message stating that the relation <code>blogengine_post</code> does not exist. That&#x27;s because we need to create our database structure. Heroku allows you to easily run commands on your app with <code>heroku run</code>, so let&#x27;s create our database and run our migrations:</p><pre><div class="gatsby-highlight" data-language="bash"><pre class="prism-code language-bash" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token plain">$ heroku run python manage.py syncdb</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token plain">$ heroku run python manage.py migrate</span></div></pre></div></pre><p class="py-2">These are exactly the same commands you would run locally to create your database, but prefaced with <code>heroku run</code> so that they get run by Heroku. As usual, you will be prompted to create a superuser - you&#x27;ll want to do this so you can log into the admin.</p><p class="py-2">That&#x27;s all for today! We&#x27;ve finally got our site up and running on Heroku, and set up continuous integration so our tests will get run for us. You can see an example of the site working <a href="http://blog.shellshocked.info/" class="border-b-2 border-green-400">here</a>. As usual, you can check out the latest version of the code with <code>git checkout lesson-5</code>. If you&#x27;d like a homework assignment, then take a look at <a href="http://docs.travis-ci.com/user/deployment/heroku/" class="border-b-2 border-green-400">automating deployment to Heroku on successful builds</a> and see if you can get it set up successfully.</p><p class="py-2">Next time around, we&#x27;ll get back to implementing our search and tidying up the front end. See you then!</p></section><hr/><div class="py-4"><a class="p-category" href="/blog/categories/python/"><span class="inline-block px-4 py-2 my-2 mr-2 text-sm font-bold text-gray-900 bg-purple-200 rounded-full hover:bg-purple-800 hover:text-gray-200 transition-colors duration-500">python</span></a><a class="p-category" href="/blog/categories/django/"><span class="inline-block px-4 py-2 my-2 mr-2 text-sm font-bold text-gray-900 bg-purple-200 rounded-full hover:bg-purple-800 hover:text-gray-200 transition-colors duration-500">django</span></a><a class="p-category" href="/blog/categories/tdd/"><span class="inline-block px-4 py-2 my-2 mr-2 text-sm font-bold text-gray-900 bg-purple-200 rounded-full hover:bg-purple-800 hover:text-gray-200 transition-colors duration-500">tdd</span></a><a class="p-category" href="/blog/categories/django-blog-tutorial/"><span class="inline-block px-4 py-2 my-2 mr-2 text-sm font-bold text-gray-900 bg-purple-200 rounded-full hover:bg-purple-800 hover:text-gray-200 transition-colors duration-500">django-blog-tutorial</span></a></div><nav class="pt-4 clear-both box-border"><a rel="prev" class="float-left w-1/2 p-2 shadow-sm hover:bg-gray-200 dark:hover:bg-gray-800 transition duration-300 ease-in-out" href="/blog/2014/02/15/django-blog-tutorial-the-next-generation-part-4/"><p><strong class="font-bold clear-both">← Previous page</strong></p><p class="pl-6">Django blog tutorial - the next generation - part 4</p></a><a rel="next" class="float-right w-1/2 p-2 shadow-sm hover:bg-gray-200 dark:hover:bg-gray-800 transition duration-300 ease-in-out" href="/blog/2014/05/25/django-blog-tutorial-the-next-generation-part-6/"><p><strong>→ Next page</strong></p><p class="pl-6">Django Blog Tutorial - the Next Generation - Part 6</p></a></nav><div id="disqus_thread"></div></article></main></div><footer class="w-full p-4 text-gray-100 bg-gray-800"><ul class="flex flex-row flex-wrap justify-center w-full p-2 mx-auto text-center md:w-2/3 box-border"><li class="w-1/3 my-2 md:w-1/6"><a href="/posts/1">Blog</a></li><li class="w-1/3 my-2 md:w-1/6"><a href="/about">About</a></li><li class="w-1/3 my-2 md:w-1/6"><a href="/contact">Contact</a></li><li class="w-1/3 my-2 md:w-1/6"><a href="https://github.com/matthewbdaly">Github</a></li><li class="w-1/3 my-2 md:w-1/6"><a href="/rss.xml">Feed</a></li></ul><div class="w-full p-4 mx-auto text-center md:w-2/3"><p>© Matthew Daly <!-- -->2024</p></div></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-17043630-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/2014/05/24/django-blog-tutorial-the-next-generation-part-5/";window.___webpackCompilationHash="63e6f2b49e44d69bc54f";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-e73936eead92de554461.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-f9985f07495542a76eff.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-4e1d20c4ee0367982951.js"],"component---src-pages-search-tsx":["/component---src-pages-search-tsx-b99acf90d4edb32782cc.js"],"component---src-templates-404-tsx":["/component---src-templates-404-tsx-58cee2c5cafcdef4f352.js"],"component---src-templates-archives-tsx":["/component---src-templates-archives-tsx-eb683d429b41ff760650.js"],"component---src-templates-categories-tsx":["/component---src-templates-categories-tsx-0ebf077cdddbd027dee1.js"],"component---src-templates-category-tsx":["/component---src-templates-category-tsx-85c7819e0a67df13f83c.js"],"component---src-templates-chunk-tsx":["/component---src-templates-chunk-tsx-cb62dcaac71b0fa8e5fc.js"],"component---src-templates-page-tsx":["/component---src-templates-page-tsx-c6d2695b7ceb05c9b33e.js"],"component---src-templates-post-tsx":["/component---src-templates-post-tsx-7224755a5f178c503b89.js"]};/*]]>*/</script><script src="/app-e73936eead92de554461.js" async=""></script><script src="/framework-1ac0b2f1f7100fab8832.js" async=""></script><script src="/webpack-runtime-6ba053917aff128f78e2.js" async=""></script></body></html>