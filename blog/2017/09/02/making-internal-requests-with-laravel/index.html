<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta http-equiv="Content-Security-Policy" content="base-uri &#x27;self&#x27;; default-src &#x27;self&#x27; *.google-analytics.com disqus.com *.disqus.com *.disquscdn.com getform.io; script-src &#x27;self&#x27; localhost:* *.addthis.com *.google-analytics.com *.googletagmanager.com *.disquscdn.com *.disqus.com disqus.com *.addthisedge.com graph.facebook.com &#x27;unsafe-inline&#x27; &#x27;unsafe-eval&#x27;; style-src &#x27;self&#x27; fonts.googleapis.com *.addthis.com google-analytics.com *.disquscdn.com *.disqus.com &#x27;unsafe-inline&#x27;; object-src &#x27;none&#x27;; form-action &#x27;self&#x27; getform.io; font-src &#x27;self&#x27; data: fonts.google-apis.com fonts.gstatic.com; connect-src &#x27;self&#x27; ws://localhost:* *.google-analytics.com stats.g.doubleclick.net; img-src &#x27;self&#x27; *.google-analytics.com *.disquscdn.com *.disqus.com stats.g.doubleclick.net; child-src &#x27;self&#x27;; frame-src disqus.com *.addthis.com;"/><meta name="generator" content="Gatsby 4.20.0"/><meta data-react-helmet="true" name="description" content="Recently I&#x27;ve been working on a Phonegap app that needs to work offline. The nature of relational databases can often make this tricky if you&#x27;re dealing with related objects and…"/><meta data-react-helmet="true" property="og:title" content="Making internal requests with Laravel"/><meta data-react-helmet="true" property="og:description" content="Recently I&#x27;ve been working on a Phonegap app that needs to work offline. The nature of relational databases can often make this tricky if you&#x27;re dealing with related objects and…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="mattbd"/><meta data-react-helmet="true" name="twitter:title" content="Making internal requests with Laravel"/><meta data-react-helmet="true" name="twitter:description" content="Recently I&#x27;ve been working on a Phonegap app that needs to work offline. The nature of relational databases can often make this tricky if you&#x27;re dealing with related objects and…"/><meta name="theme-color" content="#3b82f6"/><style data-href="/styles.3cf90dc5ae50b5d99b6e.css" data-identity="gatsby-global-css">/* ! tailwindcss v3.1.8 | MIT License | https://tailwindcss.com */*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}html{-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-size:100%;font-weight:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::-webkit-backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.float-right{float:right}.float-left{float:left}.float-none{float:none}.clear-both{clear:both}.m-0{margin:0}.mx-auto{margin-left:auto;margin-right:auto}.my-8{margin-bottom:2rem;margin-top:2rem}.my-4{margin-bottom:1rem;margin-top:1rem}.my-2{margin-bottom:.5rem;margin-top:.5rem}.mx-0{margin-left:0;margin-right:0}.mt-2{margin-top:.5rem}.-mb-8{margin-bottom:-2rem}.-mb-4{margin-bottom:-1rem}.mt-8{margin-top:2rem}.mr-8{margin-right:2rem}.mt-16{margin-top:4rem}.mr-2{margin-right:.5rem}.box-border{box-sizing:border-box}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.hidden{display:none}.h-2{height:.5rem}.h-4{height:1rem}.min-h-screen{min-height:100vh}.w-full{width:100%}.w-1\/3{width:33.333333%}.w-2\/3{width:66.666667%}.w-1\/2{width:50%}.w-3\/4{width:75%}.w-1\/4{width:25%}.flex-grow{flex-grow:1}.resize-none{resize:none}.list-disc{list-style-type:disc}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.justify-center{justify-content:center}.space-y-32>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(8rem*var(--tw-space-y-reverse));margin-top:calc(8rem*(1 - var(--tw-space-y-reverse)))}.space-y-16>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(4rem*var(--tw-space-y-reverse));margin-top:calc(4rem*(1 - var(--tw-space-y-reverse)))}.space-y-8>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(2rem*var(--tw-space-y-reverse));margin-top:calc(2rem*(1 - var(--tw-space-y-reverse)))}.divide-y>:not([hidden])~:not([hidden]){--tw-divide-y-reverse:0;border-bottom-width:calc(1px*var(--tw-divide-y-reverse));border-top-width:calc(1px*(1 - var(--tw-divide-y-reverse)))}.divide-gray-800>:not([hidden])~:not([hidden]){--tw-divide-opacity:1;border-color:rgb(31 41 55/var(--tw-divide-opacity))}.overflow-x-auto{overflow-x:auto}.overflow-x-scroll{overflow-x:scroll}.rounded-lg{border-radius:.5rem}.rounded-full{border-radius:9999px}.rounded-t-lg{border-top-left-radius:.5rem;border-top-right-radius:.5rem}.border-2{border-width:2px}.border-b-2{border-bottom-width:2px}.border-l-8{border-left-width:8px}.border-b-4{border-bottom-width:4px}.border-green-400{--tw-border-opacity:1;border-color:rgb(74 222 128/var(--tw-border-opacity))}.border-gray-500{--tw-border-opacity:1;border-color:rgb(107 114 128/var(--tw-border-opacity))}.border-gray-800{--tw-border-opacity:1;border-color:rgb(31 41 55/var(--tw-border-opacity))}.border-white{--tw-border-opacity:1;border-color:rgb(255 255 255/var(--tw-border-opacity))}.border-transparent{border-color:transparent}.border-gray-100{--tw-border-opacity:1;border-color:rgb(243 244 246/var(--tw-border-opacity))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246/var(--tw-bg-opacity))}.bg-gray-300{--tw-bg-opacity:1;background-color:rgb(209 213 219/var(--tw-bg-opacity))}.bg-blue-600{--tw-bg-opacity:1;background-color:rgb(37 99 235/var(--tw-bg-opacity))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity))}.bg-gray-800{--tw-bg-opacity:1;background-color:rgb(31 41 55/var(--tw-bg-opacity))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251/var(--tw-bg-opacity))}.bg-red-200{--tw-bg-opacity:1;background-color:rgb(254 202 202/var(--tw-bg-opacity))}.bg-purple-200{--tw-bg-opacity:1;background-color:rgb(233 213 255/var(--tw-bg-opacity))}.bg-gradient-to-b{background-image:linear-gradient(to bottom,var(--tw-gradient-stops))}.bg-gradient-to-r{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.from-gray-200{--tw-gradient-from:#e5e7eb;--tw-gradient-to:rgba(229,231,235,0);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.from-green-400{--tw-gradient-from:#4ade80;--tw-gradient-to:rgba(74,222,128,0);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.via-blue-500{--tw-gradient-to:rgba(59,130,246,0);--tw-gradient-stops:var(--tw-gradient-from),#3b82f6,var(--tw-gradient-to)}.to-gray-300{--tw-gradient-to:#d1d5db}.to-purple-500{--tw-gradient-to:#a855f7}.p-4{padding:1rem}.p-2{padding:.5rem}.px-8{padding-left:2rem;padding-right:2rem}.py-4{padding-bottom:1rem;padding-top:1rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-4{padding-right:1rem}.pl-4,.px-4{padding-left:1rem}.pb-16{padding-bottom:4rem}.pt-4{padding-top:1rem}.pl-6{padding-left:1.5rem}.text-center{text-align:center}.font-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.font-sans{font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}.text-sm{font-size:.875rem;line-height:1.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-2xl{font-size:1.5rem;line-height:2rem}.text-xl{font-size:1.25rem}.text-lg,.text-xl{line-height:1.75rem}.text-lg{font-size:1.125rem}.font-bold{font-weight:700}.font-semibold{font-weight:600}.lowercase{text-transform:lowercase}.italic{font-style:italic}.leading-6{line-height:1.5rem}.text-gray-200{--tw-text-opacity:1;color:rgb(229 231 235/var(--tw-text-opacity))}.text-gray-900{--tw-text-opacity:1;color:rgb(17 24 39/var(--tw-text-opacity))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55/var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.text-black{--tw-text-opacity:1;color:rgb(0 0 0/var(--tw-text-opacity))}.text-gray-100{--tw-text-opacity:1;color:rgb(243 244 246/var(--tw-text-opacity))}.antialiased{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.shadow-lg{--tw-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color)}.shadow-lg,.shadow-sm{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-sm{--tw-shadow:0 1px 2px 0 rgba(0,0,0,.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition-colors{transition-duration:.15s;transition-property:color,background-color,border-color,fill,stroke,-webkit-text-decoration-color;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,-webkit-text-decoration-color;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-text-decoration-color,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-text-decoration-color,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.duration-500{transition-duration:.5s}.duration-300{transition-duration:.3s}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}code[class*=language-],pre[class*=language-]{display:block}.hover\:border-green-400:hover{--tw-border-opacity:1;border-color:rgb(74 222 128/var(--tw-border-opacity))}.hover\:bg-gray-200:hover{--tw-bg-opacity:1;background-color:rgb(229 231 235/var(--tw-bg-opacity))}.hover\:bg-purple-800:hover{--tw-bg-opacity:1;background-color:rgb(107 33 168/var(--tw-bg-opacity))}.hover\:text-gray-200:hover{--tw-text-opacity:1;color:rgb(229 231 235/var(--tw-text-opacity))}.focus\:border-blue-300:focus{--tw-border-opacity:1;border-color:rgb(147 197 253/var(--tw-border-opacity))}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\:ring:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(3px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}@media (prefers-color-scheme:dark){.dark\:divide-gray-200>:not([hidden])~:not([hidden]){--tw-divide-opacity:1;border-color:rgb(229 231 235/var(--tw-divide-opacity))}.dark\:border-black{--tw-border-opacity:1;border-color:rgb(0 0 0/var(--tw-border-opacity))}.dark\:bg-gray-800{--tw-bg-opacity:1;background-color:rgb(31 41 55/var(--tw-bg-opacity))}.dark\:bg-gray-900{--tw-bg-opacity:1;background-color:rgb(17 24 39/var(--tw-bg-opacity))}.dark\:bg-gray-700{--tw-bg-opacity:1;background-color:rgb(55 65 81/var(--tw-bg-opacity))}.dark\:text-gray-300{--tw-text-opacity:1;color:rgb(209 213 219/var(--tw-text-opacity))}.dark\:text-gray-100{--tw-text-opacity:1;color:rgb(243 244 246/var(--tw-text-opacity))}.dark\:text-gray-200{--tw-text-opacity:1;color:rgb(229 231 235/var(--tw-text-opacity))}.dark\:text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55/var(--tw-text-opacity))}.dark\:hover\:bg-gray-800:hover{--tw-bg-opacity:1;background-color:rgb(31 41 55/var(--tw-bg-opacity))}}@media (min-width:768px){.md\:float-none{float:none}.md\:block{display:block}.md\:w-40{width:10rem}.md\:w-2\/3{width:66.666667%}.md\:w-1\/6{width:16.666667%}}@media (min-width:1024px){.lg\:float-right{float:right}.lg\:float-left{float:left}.lg\:mt-4{margin-top:1rem}.lg\:text-left{text-align:left}}.prism-code{-webkit-overflow-scrolling:touch;background-color:transparent;border-radius:.2em;float:left;font-size:1rem;margin-bottom:1rem;margin-top:1rem;overflow:initial;padding-bottom:1rem;padding-top:1rem;position:relative}.prism-code.title{border-radius:0 0 .2em .2em}pre.prism-code{float:left;min-width:100%;overflow:initial;padding:20px}.token{display:inline-block}li>code,p>code{word-wrap:break-word;color:#ab79d6;white-space:pre-wrap}.gatsby-highlight{-webkit-overflow-scrolling:touch;font-size:1rem;overflow:auto;position:relative}.gatsby-highlight::-webkit-scrollbar{display:none}.gatsby-highlight>code[class*=language-],.gatsby>pre[class*=language-]{-webkit-hyphens:none;hyphens:none;line-height:1.5;overflow-wrap:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-break:normal;word-spacing:normal}.gatsby-highlight .token-line{border-left:4px solid transparent;margin-left:-20px;margin-right:-20px}.line-number-style{display:inline-block;opacity:.3;padding-left:1em;padding-right:2em;position:relative;text-align:center;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:1.2em}.gatsby-highlight .token-line.highlight-line{background-color:#023751;border-left:4px solid #029bce}.gatsby-highlight .token-line.highlight-line .line-number-style{left:0;opacity:.5;width:calc(1.2em - 4px)}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="search" type="application/opensearchdescription+xml" title="Matthew Daly" href="/opensearch.xml"/><script data-gatsby="web-vitals-polyfill">
              !function(){var e,t,n,i,r={passive:!0,capture:!0},a=new Date,o=function(){i=[],t=-1,e=null,f(addEventListener)},c=function(i,r){e||(e=r,t=i,n=new Date,f(removeEventListener),u())},u=function(){if(t>=0&&t<n-a){var r={entryType:"first-input",name:e.type,target:e.target,cancelable:e.cancelable,startTime:e.timeStamp,processingStart:e.timeStamp+t};i.forEach((function(e){e(r)})),i=[]}},s=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){c(e,t),a()},i=function(){a()},a=function(){removeEventListener("pointerup",n,r),removeEventListener("pointercancel",i,r)};addEventListener("pointerup",n,r),addEventListener("pointercancel",i,r)}(t,e):c(t,e)}},f=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,s,r)}))},p="hidden"===document.visibilityState?0:1/0;addEventListener("visibilitychange",(function e(t){"hidden"===document.visibilityState&&(p=t.timeStamp,removeEventListener("visibilitychange",e,!0))}),!0);o(),self.webVitals={firstInputPolyfill:function(e){i.push(e),u()},resetFirstInputPolyfill:o,get firstHiddenTime(){return p}}}();
            </script><script>window.dataLayer = window.dataLayer || [];window.dataLayer.push({"platform":"gatsby"}); (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl+'';f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer', 'G-68VZX216JS');</script><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><title data-react-helmet="true">Making internal requests with Laravel | Matthew Daly</title><link data-react-helmet="true" href="https://matthewdaly.co.uk/blog/2017/09/02/making-internal-requests-with-laravel/" rel="canonical"/><link data-react-helmet="true" href="https://twitter.com/mattbd" rel="me"/><link data-react-helmet="true" href="https://github.com/matthewbdaly" rel="me"/><link data-react-helmet="true" href="https://mstdn.social/@matthewbdaly" rel="me"/><link data-react-helmet="true" href="mailto:matthew@matthewdaly.co.uk" rel="me"/><link data-react-helmet="true" href="/key.pub" rel="pgpkey"/><link data-react-helmet="true" href="https://webmention.io/matthewdaly.co.uk/xmlrpc" rel="pingback"/><link data-react-helmet="true" href="https://webmention.io/matthewdaly.co.uk/webmention" rel="webmention"/><link data-react-helmet="true" rel="authorization_endpoint" href="https://indieauth.com/auth"/><link data-react-helmet="true" rel="token_endpoint" href="https://tokens.indieauth.com/token"/><link data-react-helmet="true" rel="openid.delegate" href="https://matthewdaly.co.uk"/><link data-react-helmet="true" rel="openid.server" href="https://openid.indieauth.com/openid"/><link data-react-helmet="true" rel="alternate" type="application/rss+xml" title="Matthew Daly - feed" href="/rss.xml"/><link data-react-helmet="true" rel="alternate" type="application/atom+xml" title="Matthew Daly - feed" href="/atom.xml"/><link data-react-helmet="true" rel="alternate" type="application/feed+json" title="Matthew Daly - feed" href="/feed.json"/><link rel="sitemap" type="application/xml" href="/sitemap/sitemap-index.xml"/><link rel="icon" href="/favicon-32x32.png?v=53aa06cf17e4239d0dba6ffd09854e02" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=53aa06cf17e4239d0dba6ffd09854e02"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=53aa06cf17e4239d0dba6ffd09854e02"/></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=G-68VZX216JS" height="0" width="0" style="display: none; visibility: hidden" aria-hidden="true"></iframe></noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="flex flex-col min-h-screen pb-16 font-sans text-lg antialiased text-gray-800 bg-gray-50 dark:text-gray-100 dark:bg-gray-700 leading-6"><div class="w-full h-2 bg-gradient-to-r from-green-400 via-blue-500 to-purple-500"></div><nav class="w-full p-4 mx-auto lowercase md:w-2/3"><h1 class="block float-none py-4 text-4xl text-center lg:float-left lg:text-left"><a href="/">Matthew Daly</a></h1><ul class="py-2 text-center lg:float-right md:block lg:text-left"><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/blog/archives">Archives</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/about">About</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/uses">Uses</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/posts/1">Blog</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/blog/categories">Categories</a></li><li class="inline-block pr py-2 mr-8 lg:mt-4 text-sm text-gray-900 dark:text-gray-200 border-b-4 border-transparent hover:border-green-400 transition-colors duration-500"><a href="/search">Search</a></li></ul></nav><div class="w-full h-4 clear"></div><main class="flex-grow w-full p-4 mx-auto md:w-2/3"><article class="h-entry"><header><h2 class="py-4 text-2xl font-bold e-content p-name"><a class="u-url" href="https://matthewdaly.co.uk/blog/2017/09/02/making-internal-requests-with-laravel/">Making internal requests with Laravel</a></h2><p class="my-4 text-lg font-semibold">Published by <a href="/" rel="author">Matthew Daly</a> at <!-- -->2nd September 2017 1:45 pm</p><time class="hidden dt-published">2017-09-02T13:45:27+00:00</time></header><section><p class="py-2">Recently I&#x27;ve been working on a Phonegap app that needs to work offline. The nature of relational databases can often make this tricky if you&#x27;re dealing with related objects and you&#x27;re trying to retrofit it to something that wasn&#x27;t built with this use case in mind.</p><p class="py-2">Originally my plan was to push each request that would have been made to a queue in WebSQL, and then on reconnect, make every request individually. It quickly became apparent, however, that this approach had a few problems:</p><ul class="py-2 pl-4"><li class="list-disc">If one request failed, the remaining requests had to be stopped from executing</li><li class="list-disc">It didn&#x27;t allow for storing the failed transactions in a way that made them easy to retrieve</li></ul><p class="py-2">Instead, I decided to create a single <code>sync</code> endpoint for the API that would accept an object containing all the requests that would be made, and then step through each one. If it failed, it would get the failed request and all subsequent ones in the object, and store them in the database. That way, even if the data didn&#x27;t sync correctly, it wasn&#x27;t lost, and if necessary it could be resolved manually.</p><p class="py-2">Since the necessary API endpoints already existed, and were thoroughly tested, it was not a good idea to start duplicating that functionality. Instead, I implemented the functionality to carry out internal requests, and I thought I&#x27;d share how you can do this.</p><p class="py-2">For any service you may build for your Laravel applications, it&#x27;s a good idea to create an interface for it first:</p><pre><div class="gatsby-highlight" data-language="php"><pre class="prism-code language-php" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token php language-php delimiter important" style="font-weight:400">&lt;?php</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token php language-php" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token php language-php"></span><span class="token php language-php keyword" style="color:#c5a5c5">namespace</span><span class="token php language-php"> </span><span class="token php language-php package">App</span><span class="token php language-php package punctuation" style="color:#8dc891">\</span><span class="token php language-php package">Contracts</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token php language-php" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token php language-php"></span><span class="token php language-php keyword" style="color:#c5a5c5">interface</span><span class="token php language-php"> </span><span class="token php language-php class-name-definition class-name" style="color:#FAC863">MakesInternalRequests</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token php language-php"></span><span class="token php language-php punctuation" style="color:#8dc891">{</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token php language-php">    </span><span class="token php language-php comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token php language-php comment" style="color:#999999">     * Make an internal request</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token php language-php comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token php language-php comment" style="color:#999999">     * @param string $action   The HTTP verb to use.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token php language-php comment" style="color:#999999">     * @param string $resource The API resource to look up.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">12</span><span class="token php language-php comment" style="color:#999999">     * @param array  $data     The request body.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">13</span><span class="token php language-php comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">14</span><span class="token php language-php comment" style="color:#999999">     */</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">15</span><span class="token php language-php">    </span><span class="token php language-php keyword" style="color:#c5a5c5">public</span><span class="token php language-php"> </span><span class="token php language-php keyword" style="color:#c5a5c5">function</span><span class="token php language-php"> </span><span class="token php language-php function-definition function" style="color:#79b6f2">request</span><span class="token php language-php punctuation" style="color:#8dc891">(</span><span class="token php language-php keyword type-hint" style="color:#c5a5c5">string</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$action</span><span class="token php language-php punctuation" style="color:#8dc891">,</span><span class="token php language-php"> </span><span class="token php language-php keyword type-hint" style="color:#c5a5c5">string</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$resource</span><span class="token php language-php punctuation" style="color:#8dc891">,</span><span class="token php language-php"> </span><span class="token php language-php keyword type-hint" style="color:#c5a5c5">array</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$data</span><span class="token php language-php"> </span><span class="token php language-php operator" style="color:#d7deea">=</span><span class="token php language-php"> </span><span class="token php language-php punctuation" style="color:#8dc891">[</span><span class="token php language-php punctuation" style="color:#8dc891">]</span><span class="token php language-php punctuation" style="color:#8dc891">)</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">16</span><span class="token php language-php"></span><span class="token php language-php punctuation" style="color:#8dc891">}</span><span class="token php language-php"></span></div></pre></div></pre><p class="py-2">That way you can resolve the service using dependency injection, making it trivial to replace it with a mock when testing.</p><p class="py-2">Now, actually making an internal request is pretty easy. You get the app instance (you can do so by resolving it using dependency injection as I do below, or call the <code>app()</code> helper). Then you put together the request you want to make and pass it as an argument to the app&#x27;s <code>handle()</code> method:</p><pre><div class="gatsby-highlight" data-language="php"><pre class="prism-code language-php" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token php language-php delimiter important" style="font-weight:400">&lt;?php</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token php language-php" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token php language-php"></span><span class="token php language-php keyword" style="color:#c5a5c5">namespace</span><span class="token php language-php"> </span><span class="token php language-php package">App</span><span class="token php language-php package punctuation" style="color:#8dc891">\</span><span class="token php language-php package">Services</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token php language-php" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token php language-php"></span><span class="token php language-php keyword" style="color:#c5a5c5">use</span><span class="token php language-php"> </span><span class="token php language-php package">Illuminate</span><span class="token php language-php package punctuation" style="color:#8dc891">\</span><span class="token php language-php package">Http</span><span class="token php language-php package punctuation" style="color:#8dc891">\</span><span class="token php language-php package">Request</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token php language-php"></span><span class="token php language-php keyword" style="color:#c5a5c5">use</span><span class="token php language-php"> </span><span class="token php language-php package">App</span><span class="token php language-php package punctuation" style="color:#8dc891">\</span><span class="token php language-php package">Contracts</span><span class="token php language-php package punctuation" style="color:#8dc891">\</span><span class="token php language-php package">MakesInternalRequests</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token php language-php"></span><span class="token php language-php keyword" style="color:#c5a5c5">use</span><span class="token php language-php"> </span><span class="token php language-php package">Illuminate</span><span class="token php language-php package punctuation" style="color:#8dc891">\</span><span class="token php language-php package">Foundation</span><span class="token php language-php package punctuation" style="color:#8dc891">\</span><span class="token php language-php package">Application</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token php language-php"></span><span class="token php language-php keyword" style="color:#c5a5c5">use</span><span class="token php language-php"> </span><span class="token php language-php package">App</span><span class="token php language-php package punctuation" style="color:#8dc891">\</span><span class="token php language-php package">Exceptions</span><span class="token php language-php package punctuation" style="color:#8dc891">\</span><span class="token php language-php package">FailedInternalRequestException</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token php language-php" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token php language-php"></span><span class="token php language-php comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token php language-php comment" style="color:#999999"> * Internal request service</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">12</span><span class="token php language-php comment" style="color:#999999"> */</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">13</span><span class="token php language-php"></span><span class="token php language-php keyword" style="color:#c5a5c5">class</span><span class="token php language-php"> </span><span class="token php language-php class-name-definition class-name" style="color:#FAC863">InternalRequest</span><span class="token php language-php"> </span><span class="token php language-php keyword" style="color:#c5a5c5">implements</span><span class="token php language-php"> </span><span class="token php language-php class-name" style="color:#FAC863">MakesInternalRequests</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">14</span><span class="token php language-php"></span><span class="token php language-php punctuation" style="color:#8dc891">{</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">15</span><span class="token php language-php">    </span><span class="token php language-php comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">16</span><span class="token php language-php comment" style="color:#999999">     * The app instance</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">17</span><span class="token php language-php comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">18</span><span class="token php language-php comment" style="color:#999999">     * @var $app</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">19</span><span class="token php language-php comment" style="color:#999999">     */</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">20</span><span class="token php language-php">    </span><span class="token php language-php keyword" style="color:#c5a5c5">protected</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$app</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">21</span><span class="token php language-php" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">22</span><span class="token php language-php">    </span><span class="token php language-php comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">23</span><span class="token php language-php comment" style="color:#999999">     * Constructor</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">24</span><span class="token php language-php comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">25</span><span class="token php language-php comment" style="color:#999999">     * @param Application $app        The app instance.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">26</span><span class="token php language-php comment" style="color:#999999">     * @return void</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">27</span><span class="token php language-php comment" style="color:#999999">     */</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">28</span><span class="token php language-php">    </span><span class="token php language-php keyword" style="color:#c5a5c5">public</span><span class="token php language-php"> </span><span class="token php language-php keyword" style="color:#c5a5c5">function</span><span class="token php language-php"> </span><span class="token php language-php function-definition function" style="color:#79b6f2">__construct</span><span class="token php language-php punctuation" style="color:#8dc891">(</span><span class="token php language-php class-name type-declaration" style="color:#FAC863">Application</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$app</span><span class="token php language-php punctuation" style="color:#8dc891">)</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">29</span><span class="token php language-php">    </span><span class="token php language-php punctuation" style="color:#8dc891">{</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">30</span><span class="token php language-php">        </span><span class="token php language-php variable" style="color:#d7deea">$this</span><span class="token php language-php operator" style="color:#d7deea">-&gt;</span><span class="token php language-php property" style="color:#5a9bcf">app</span><span class="token php language-php"> </span><span class="token php language-php operator" style="color:#d7deea">=</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$app</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">31</span><span class="token php language-php">    </span><span class="token php language-php punctuation" style="color:#8dc891">}</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">32</span><span class="token php language-php" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">33</span><span class="token php language-php">    </span><span class="token php language-php comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">34</span><span class="token php language-php comment" style="color:#999999">     * Make an internal request</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">35</span><span class="token php language-php comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">36</span><span class="token php language-php comment" style="color:#999999">     * @param string $action   The HTTP verb to use.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">37</span><span class="token php language-php comment" style="color:#999999">     * @param string $resource The API resource to look up.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">38</span><span class="token php language-php comment" style="color:#999999">     * @param array  $data     The request body.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">39</span><span class="token php language-php comment" style="color:#999999">     * @throws FailedInternalRequestException Request could not be synced.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">40</span><span class="token php language-php comment" style="color:#999999">     * @return \Illuminate\Http\Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">41</span><span class="token php language-php comment" style="color:#999999">     */</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">42</span><span class="token php language-php">    </span><span class="token php language-php keyword" style="color:#c5a5c5">public</span><span class="token php language-php"> </span><span class="token php language-php keyword" style="color:#c5a5c5">function</span><span class="token php language-php"> </span><span class="token php language-php function-definition function" style="color:#79b6f2">request</span><span class="token php language-php punctuation" style="color:#8dc891">(</span><span class="token php language-php keyword type-hint" style="color:#c5a5c5">string</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$action</span><span class="token php language-php punctuation" style="color:#8dc891">,</span><span class="token php language-php"> </span><span class="token php language-php keyword type-hint" style="color:#c5a5c5">string</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$resource</span><span class="token php language-php punctuation" style="color:#8dc891">,</span><span class="token php language-php"> </span><span class="token php language-php keyword type-hint" style="color:#c5a5c5">array</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$data</span><span class="token php language-php"> </span><span class="token php language-php operator" style="color:#d7deea">=</span><span class="token php language-php"> </span><span class="token php language-php punctuation" style="color:#8dc891">[</span><span class="token php language-php punctuation" style="color:#8dc891">]</span><span class="token php language-php punctuation" style="color:#8dc891">)</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">43</span><span class="token php language-php">    </span><span class="token php language-php punctuation" style="color:#8dc891">{</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">44</span><span class="token php language-php">        </span><span class="token php language-php comment" style="color:#999999">// Create request</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">45</span><span class="token php language-php">        </span><span class="token php language-php variable" style="color:#d7deea">$request</span><span class="token php language-php"> </span><span class="token php language-php operator" style="color:#d7deea">=</span><span class="token php language-php"> </span><span class="token php language-php class-name static-context" style="color:#FAC863">Request</span><span class="token php language-php operator" style="color:#d7deea">::</span><span class="token php language-php function" style="color:#79b6f2">create</span><span class="token php language-php punctuation" style="color:#8dc891">(</span><span class="token php language-php string single-quoted-string" style="color:#8dc891">&#x27;/api/&#x27;</span><span class="token php language-php"> </span><span class="token php language-php operator" style="color:#d7deea">.</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$resource</span><span class="token php language-php punctuation" style="color:#8dc891">,</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$action</span><span class="token php language-php punctuation" style="color:#8dc891">,</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$data</span><span class="token php language-php punctuation" style="color:#8dc891">,</span><span class="token php language-php"> </span><span class="token php language-php punctuation" style="color:#8dc891">[</span><span class="token php language-php punctuation" style="color:#8dc891">]</span><span class="token php language-php punctuation" style="color:#8dc891">,</span><span class="token php language-php"> </span><span class="token php language-php punctuation" style="color:#8dc891">[</span><span class="token php language-php punctuation" style="color:#8dc891">]</span><span class="token php language-php punctuation" style="color:#8dc891">,</span><span class="token php language-php"> </span><span class="token php language-php punctuation" style="color:#8dc891">[</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">46</span><span class="token php language-php">            </span><span class="token php language-php string single-quoted-string" style="color:#8dc891">&#x27;HTTP_Accept&#x27;</span><span class="token php language-php">             </span><span class="token php language-php operator" style="color:#d7deea">=&gt;</span><span class="token php language-php"> </span><span class="token php language-php string single-quoted-string" style="color:#8dc891">&#x27;application/json&#x27;</span><span class="token php language-php punctuation" style="color:#8dc891">,</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">47</span><span class="token php language-php">        </span><span class="token php language-php punctuation" style="color:#8dc891">]</span><span class="token php language-php punctuation" style="color:#8dc891">)</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">48</span><span class="token php language-php" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">49</span><span class="token php language-php">        </span><span class="token php language-php comment" style="color:#999999">// Get response</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">50</span><span class="token php language-php">        </span><span class="token php language-php variable" style="color:#d7deea">$response</span><span class="token php language-php"> </span><span class="token php language-php operator" style="color:#d7deea">=</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$this</span><span class="token php language-php operator" style="color:#d7deea">-&gt;</span><span class="token php language-php property" style="color:#5a9bcf">app</span><span class="token php language-php operator" style="color:#d7deea">-&gt;</span><span class="token php language-php function" style="color:#79b6f2">handle</span><span class="token php language-php punctuation" style="color:#8dc891">(</span><span class="token php language-php variable" style="color:#d7deea">$request</span><span class="token php language-php punctuation" style="color:#8dc891">)</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">51</span><span class="token php language-php">        </span><span class="token php language-php keyword" style="color:#c5a5c5">if</span><span class="token php language-php"> </span><span class="token php language-php punctuation" style="color:#8dc891">(</span><span class="token php language-php variable" style="color:#d7deea">$response</span><span class="token php language-php operator" style="color:#d7deea">-&gt;</span><span class="token php language-php function" style="color:#79b6f2">getStatusCode</span><span class="token php language-php punctuation" style="color:#8dc891">(</span><span class="token php language-php punctuation" style="color:#8dc891">)</span><span class="token php language-php"> </span><span class="token php language-php operator" style="color:#d7deea">&gt;=</span><span class="token php language-php"> </span><span class="token php language-php number" style="color:#5a9bcf">400</span><span class="token php language-php punctuation" style="color:#8dc891">)</span><span class="token php language-php"> </span><span class="token php language-php punctuation" style="color:#8dc891">{</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">52</span><span class="token php language-php">            </span><span class="token php language-php keyword" style="color:#c5a5c5">throw</span><span class="token php language-php"> </span><span class="token php language-php keyword" style="color:#c5a5c5">new</span><span class="token php language-php"> </span><span class="token php language-php class-name" style="color:#FAC863">FailedInternalRequestException</span><span class="token php language-php punctuation" style="color:#8dc891">(</span><span class="token php language-php variable" style="color:#d7deea">$request</span><span class="token php language-php punctuation" style="color:#8dc891">,</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$response</span><span class="token php language-php punctuation" style="color:#8dc891">)</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">53</span><span class="token php language-php">        </span><span class="token php language-php punctuation" style="color:#8dc891">}</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">54</span><span class="token php language-php" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">55</span><span class="token php language-php">        </span><span class="token php language-php comment" style="color:#999999">// Dispatch the request</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">56</span><span class="token php language-php">        </span><span class="token php language-php keyword" style="color:#c5a5c5">return</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$response</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">57</span><span class="token php language-php">    </span><span class="token php language-php punctuation" style="color:#8dc891">}</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">58</span><span class="token php language-php"></span><span class="token php language-php punctuation" style="color:#8dc891">}</span><span class="token php language-php"></span></div></pre></div></pre><p class="py-2">Also note that I&#x27;ve created a custom exception, called <code>FailedInternalRequestException</code>. This is fired if the status code returned from the internal requests is greater than or equal to 400 (thus denoting an error):</p><pre><div class="gatsby-highlight" data-language="php"><pre class="prism-code language-php" style="background-color:#282c34;color:#ffffff"><div class="token-line" style="color:#ffffff"><span class="line-number-style">1</span><span class="token php language-php delimiter important" style="font-weight:400">&lt;?php</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">2</span><span class="token php language-php" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">3</span><span class="token php language-php"></span><span class="token php language-php keyword" style="color:#c5a5c5">namespace</span><span class="token php language-php"> </span><span class="token php language-php package">App</span><span class="token php language-php package punctuation" style="color:#8dc891">\</span><span class="token php language-php package">Exceptions</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">4</span><span class="token php language-php" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">5</span><span class="token php language-php"></span><span class="token php language-php keyword" style="color:#c5a5c5">use</span><span class="token php language-php"> </span><span class="token php language-php package">Illuminate</span><span class="token php language-php package punctuation" style="color:#8dc891">\</span><span class="token php language-php package">Http</span><span class="token php language-php package punctuation" style="color:#8dc891">\</span><span class="token php language-php package">Request</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">6</span><span class="token php language-php"></span><span class="token php language-php keyword" style="color:#c5a5c5">use</span><span class="token php language-php"> </span><span class="token php language-php package">Illuminate</span><span class="token php language-php package punctuation" style="color:#8dc891">\</span><span class="token php language-php package">Http</span><span class="token php language-php package punctuation" style="color:#8dc891">\</span><span class="token php language-php package">Response</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">7</span><span class="token php language-php" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">8</span><span class="token php language-php"></span><span class="token php language-php comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">9</span><span class="token php language-php comment" style="color:#999999"> * Exception for when a bulk sync job fails</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">10</span><span class="token php language-php comment" style="color:#999999"> */</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">11</span><span class="token php language-php"></span><span class="token php language-php keyword" style="color:#c5a5c5">class</span><span class="token php language-php"> </span><span class="token php language-php class-name-definition class-name" style="color:#FAC863">FailedInternalRequestException</span><span class="token php language-php"> </span><span class="token php language-php keyword" style="color:#c5a5c5">extends</span><span class="token php language-php"> </span><span class="token php language-php class-name class-name-fully-qualified punctuation" style="color:#8dc891">\</span><span class="token php language-php class-name class-name-fully-qualified" style="color:#FAC863">Exception</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">12</span><span class="token php language-php"></span><span class="token php language-php punctuation" style="color:#8dc891">{</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">13</span><span class="token php language-php">    </span><span class="token php language-php comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">14</span><span class="token php language-php comment" style="color:#999999">     * Request instance</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">15</span><span class="token php language-php comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">16</span><span class="token php language-php comment" style="color:#999999">     * @var $request</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">17</span><span class="token php language-php comment" style="color:#999999">     */</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">18</span><span class="token php language-php">    </span><span class="token php language-php keyword" style="color:#c5a5c5">protected</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$request</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">19</span><span class="token php language-php" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">20</span><span class="token php language-php">    </span><span class="token php language-php comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">21</span><span class="token php language-php comment" style="color:#999999">     * Response instance</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">22</span><span class="token php language-php comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">23</span><span class="token php language-php comment" style="color:#999999">     * @var $response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">24</span><span class="token php language-php comment" style="color:#999999">     */</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">25</span><span class="token php language-php">    </span><span class="token php language-php keyword" style="color:#c5a5c5">protected</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$response</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">26</span><span class="token php language-php" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">27</span><span class="token php language-php">    </span><span class="token php language-php comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">28</span><span class="token php language-php comment" style="color:#999999">     * Constructor</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">29</span><span class="token php language-php comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">30</span><span class="token php language-php comment" style="color:#999999">     * @param Request  $request  The request object.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">31</span><span class="token php language-php comment" style="color:#999999">     * @param Response $response The response object.</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">32</span><span class="token php language-php comment" style="color:#999999">     * @return void</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">33</span><span class="token php language-php comment" style="color:#999999">     */</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">34</span><span class="token php language-php">    </span><span class="token php language-php keyword" style="color:#c5a5c5">public</span><span class="token php language-php"> </span><span class="token php language-php keyword" style="color:#c5a5c5">function</span><span class="token php language-php"> </span><span class="token php language-php function-definition function" style="color:#79b6f2">__construct</span><span class="token php language-php punctuation" style="color:#8dc891">(</span><span class="token php language-php class-name type-declaration" style="color:#FAC863">Request</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$request</span><span class="token php language-php punctuation" style="color:#8dc891">,</span><span class="token php language-php"> </span><span class="token php language-php class-name type-declaration" style="color:#FAC863">Response</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$response</span><span class="token php language-php punctuation" style="color:#8dc891">)</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">35</span><span class="token php language-php">    </span><span class="token php language-php punctuation" style="color:#8dc891">{</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">36</span><span class="token php language-php">        </span><span class="token php language-php keyword static-context" style="color:#c5a5c5">parent</span><span class="token php language-php operator" style="color:#d7deea">::</span><span class="token php language-php function" style="color:#79b6f2">__construct</span><span class="token php language-php punctuation" style="color:#8dc891">(</span><span class="token php language-php punctuation" style="color:#8dc891">)</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">37</span><span class="token php language-php">        </span><span class="token php language-php variable" style="color:#d7deea">$this</span><span class="token php language-php operator" style="color:#d7deea">-&gt;</span><span class="token php language-php property" style="color:#5a9bcf">request</span><span class="token php language-php"> </span><span class="token php language-php operator" style="color:#d7deea">=</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$request</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">38</span><span class="token php language-php">        </span><span class="token php language-php variable" style="color:#d7deea">$this</span><span class="token php language-php operator" style="color:#d7deea">-&gt;</span><span class="token php language-php property" style="color:#5a9bcf">response</span><span class="token php language-php"> </span><span class="token php language-php operator" style="color:#d7deea">=</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$response</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">39</span><span class="token php language-php">    </span><span class="token php language-php punctuation" style="color:#8dc891">}</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">40</span><span class="token php language-php" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">41</span><span class="token php language-php">    </span><span class="token php language-php comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">42</span><span class="token php language-php comment" style="color:#999999">     * Get request object</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">43</span><span class="token php language-php comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">44</span><span class="token php language-php comment" style="color:#999999">     * @return Request</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">45</span><span class="token php language-php comment" style="color:#999999">     */</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">46</span><span class="token php language-php">    </span><span class="token php language-php keyword" style="color:#c5a5c5">public</span><span class="token php language-php"> </span><span class="token php language-php keyword" style="color:#c5a5c5">function</span><span class="token php language-php"> </span><span class="token php language-php function-definition function" style="color:#79b6f2">getRequest</span><span class="token php language-php punctuation" style="color:#8dc891">(</span><span class="token php language-php punctuation" style="color:#8dc891">)</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">47</span><span class="token php language-php">    </span><span class="token php language-php punctuation" style="color:#8dc891">{</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">48</span><span class="token php language-php">        </span><span class="token php language-php keyword" style="color:#c5a5c5">return</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$this</span><span class="token php language-php operator" style="color:#d7deea">-&gt;</span><span class="token php language-php property" style="color:#5a9bcf">request</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">49</span><span class="token php language-php">    </span><span class="token php language-php punctuation" style="color:#8dc891">}</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">50</span><span class="token php language-php" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">51</span><span class="token php language-php">    </span><span class="token php language-php comment" style="color:#999999">/**</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">52</span><span class="token php language-php comment" style="color:#999999">     * Get response object</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">53</span><span class="token php language-php comment" style="color:#999999">     *</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">54</span><span class="token php language-php comment" style="color:#999999">     * @return Response</span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">55</span><span class="token php language-php comment" style="color:#999999">     */</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">56</span><span class="token php language-php">    </span><span class="token php language-php keyword" style="color:#c5a5c5">public</span><span class="token php language-php"> </span><span class="token php language-php keyword" style="color:#c5a5c5">function</span><span class="token php language-php"> </span><span class="token php language-php function-definition function" style="color:#79b6f2">getResponse</span><span class="token php language-php punctuation" style="color:#8dc891">(</span><span class="token php language-php punctuation" style="color:#8dc891">)</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">57</span><span class="token php language-php">    </span><span class="token php language-php punctuation" style="color:#8dc891">{</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">58</span><span class="token php language-php">        </span><span class="token php language-php keyword" style="color:#c5a5c5">return</span><span class="token php language-php"> </span><span class="token php language-php variable" style="color:#d7deea">$this</span><span class="token php language-php operator" style="color:#d7deea">-&gt;</span><span class="token php language-php property" style="color:#5a9bcf">response</span><span class="token php language-php punctuation" style="color:#8dc891">;</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">59</span><span class="token php language-php">    </span><span class="token php language-php punctuation" style="color:#8dc891">}</span><span class="token php language-php"></span></div><div class="token-line" style="color:#ffffff"><span class="line-number-style">60</span><span class="token php language-php"></span><span class="token php language-php punctuation" style="color:#8dc891">}</span><span class="token php language-php"></span></div></pre></div></pre><p class="py-2">You can catch this exception in an appropriate place and handle it as you wish. Now, if you import the internal request class as <code>$dispatcher</code>, you can just call <code>$dispatcher-&gt;request($action, $resource, $data)</code>, where <code>$action</code> is the HTTP verb, <code>$resource</code> is the API resource to send to, and <code>$data</code> is the data to send.</p><p class="py-2">It&#x27;s actually quite rare to have to do this. In this case, because this was a REST API and every request made to it was changing the state of the application (there were no GET requests, only POST, PUT, PATCH and DELETE), it made sense to just break down the request body and do internal requests against the existing API, since otherwise I&#x27;d have to duplicate the existing functionality. I would not recommend this approach for something like fetching data to render a page on the server side, as there are more efficient ways of accomplishing it. In all honesty I can&#x27;t think of any other scenario where this would genuinely be the best option. However, it worked well for my use case and allowed me to implement this functionality quickly and simply.</p></section><hr/><div class="py-4"><a class="p-category" href="/blog/categories/php/"><span class="inline-block px-4 py-2 my-2 mr-2 text-sm font-bold text-gray-900 bg-purple-200 rounded-full hover:bg-purple-800 hover:text-gray-200 transition-colors duration-500">php</span></a><a class="p-category" href="/blog/categories/laravel/"><span class="inline-block px-4 py-2 my-2 mr-2 text-sm font-bold text-gray-900 bg-purple-200 rounded-full hover:bg-purple-800 hover:text-gray-200 transition-colors duration-500">laravel</span></a></div><nav class="pt-4 clear-both box-border"><a rel="prev" class="float-left w-1/2 p-2 shadow-sm hover:bg-gray-200 dark:hover:bg-gray-800 transition duration-300 ease-in-out" href="/blog/2017/08/19/run-your-tests-locally-with-sismo/"><p><strong class="font-bold clear-both">← Previous page</strong></p><p class="pl-6">Run your tests locally with Sismo</p></a><a rel="next" class="float-right w-1/2 p-2 shadow-sm hover:bg-gray-200 dark:hover:bg-gray-800 transition duration-300 ease-in-out" href="/blog/2017/09/08/installing-nginx-unit-on-ubuntu/"><p><strong>→ Next page</strong></p><p class="pl-6">Installing Nginx Unit on Ubuntu</p></a></nav><div id="disqus_thread"></div></article></main></div><footer class="w-full p-4 text-gray-100 bg-gray-800"><ul class="flex flex-row flex-wrap justify-center w-full p-2 mx-auto text-center md:w-2/3 box-border"><li class="w-1/3 my-2 md:w-1/6"><a href="/posts/1">Blog</a></li><li class="w-1/3 my-2 md:w-1/6"><a href="/about">About</a></li><li class="w-1/3 my-2 md:w-1/6"><a href="/contact">Contact</a></li><li class="w-1/3 my-2 md:w-1/6"><a href="https://twitter.com/mattbd">Twitter</a></li><li class="w-1/3 my-2 md:w-1/6"><a href="https://github.com/matthewbdaly">Github</a></li><li class="w-1/3 my-2 md:w-1/6"><a href="/rss.xml">Feed</a></li></ul><div class="w-full p-4 mx-auto text-center md:w-2/3"><p>© Matthew Daly <!-- -->2023</p></div></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-17043630-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/2017/09/02/making-internal-requests-with-laravel/";window.___webpackCompilationHash="e80133b596c46ec7239a";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-292603999ddf931fbc86.js"],"app":["/app-8ef96426d66185cd6801.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-37b4064d2301b772dd78.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-7654f79315d4f0e1b9ad.js"],"component---src-pages-search-tsx":["/component---src-pages-search-tsx-70464b9f9e03151151f4.js"],"component---src-templates-404-tsx":["/component---src-templates-404-tsx-f9380642b46958eac878.js"],"component---src-templates-archives-tsx":["/component---src-templates-archives-tsx-8b016c619a73e033ac36.js"],"component---src-templates-categories-tsx":["/component---src-templates-categories-tsx-bf6c75af4b505ad059e7.js"],"component---src-templates-category-tsx":["/component---src-templates-category-tsx-f85e55cd0ab88c0868f7.js"],"component---src-templates-chunk-tsx":["/component---src-templates-chunk-tsx-d23f1a5875602efb5d40.js"],"component---src-templates-page-tsx":["/component---src-templates-page-tsx-5227fa4d4eae92f23fc3.js"],"component---src-templates-post-tsx":["/component---src-templates-post-tsx-345b5309a23a0f882930.js"]};/*]]>*/</script><script src="/polyfill-292603999ddf931fbc86.js" nomodule=""></script><script src="/app-8ef96426d66185cd6801.js" async=""></script><script src="/532a2f07-b2bcfc1100f9b94937a1.js" async=""></script><script src="/framework-a6e7e2d9b047634414ab.js" async=""></script><script src="/webpack-runtime-744fd0be0f11882e3f62.js" async=""></script></body></html>