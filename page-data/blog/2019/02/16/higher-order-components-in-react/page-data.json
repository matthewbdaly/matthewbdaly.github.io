{"componentChunkName":"component---src-templates-post-tsx","path":"/blog/2019/02/16/higher-order-components-in-react/","result":{"data":{"site":{"siteMetadata":{"title":"Matthew Daly","siteUrl":"https://matthewdaly.co.uk"}},"mdx":{"id":"54741b7f-f806-5e89-beff-258c13310b2f","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Higher-order components in React\",\n  \"date\": \"2019-02-16 19:00:30 +0000\",\n  \"layout\": \"post\",\n  \"categories\": [\"javascript\", \"react\"],\n  \"comments\": true\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"In the last few weeks I've been working on a big rebuild of the homepage of the legacy application I maintain. As I've been slowly transitioning it to use React on the front end, I used that, and it's by far the largest React project I've worked on to date. This has pushed me to use some more advanced React techniques I hadn't touched on before. I've also had to create some different components that have common functionality.\"), mdx(\"p\", null, \"React used to use mixins to share common functionality, but the consensus is now that \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://reactjs.org/blog/2016/07/13/mixins-considered-harmful.html\"\n  }, \"mixins are considered harmful\"), \", so they have been removed. Instead, developers are encouraged to create higher-order components to contain the shared functionality.\"), mdx(\"p\", null, \"A higher-order component is a function that accepts a React component as an argument, and then returns another component that wraps the provided one. The shared functionality is defined inside the wrapping component, and so any state or methods defined in the wrapping component can then be passed as props into the wrapped one, as in this simple example:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"import React, { Component } from 'react';\\n\\nexport default function hocExample(WrappedComponent) {\\n  class hocExample extends Component {\\n    constructor(props) {\\n      this.state = {\\n        foo: false\\n      };\\n      this.doStuff = this.doStuff.bind(this);\\n    }\\n    doStuff() {\\n      this.setState({\\n        foo: true\\n      });\\n    }\\n    render() {\\n      return (\\n        <WrappedComponent foo={this.state.foo} doStuff={this.doStuff} />\\n      );\\n    }\\n  }\\n  return hocExample;\\n}\\n\")), mdx(\"p\", null, \"If you've been working with React for a while, even if you haven't written a higher-order component, you've probably used one. For instance, \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"withRouter()\"), \" from \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"react-router\"), \" is a good example of a higher-order component that forms part of an existing library.\"), mdx(\"h1\", null, \"A real-world example\"), mdx(\"p\", null, \"A very common use case I've come across is handling a click outside of a component. For instance, if you have a sidebar or popup component, it's common to want to close it when the user clicks outside the component. As such, it's worth taking the time to refactor it to make it reusable.\"), mdx(\"p\", null, \"In principle you can achieve this on any component as follows:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The component should accept two props - an \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"active\"), \" prop that denotes whether the component is active or not, and an \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"onClickOutside()\"), \" prop method that is called on a click outside\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"On mount, an event listener should be added to the document to listen for \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"mousedown\"), \" events, and it should be removed on unmount\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"When the event listener is fired, it should use a ref on the component to determine if the ref contains the event target. If so, and the status is active, the \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"onClickOutside()\"), \" method should be called\")), mdx(\"p\", null, \"Moving this to a higher order component makes a couple of issues slightly more complex, but not very. We can't easily get a ref of the wrapped component, so I had to resort to using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ReactDOM.findDOMNode()\"), \" instead, which is potentially a bit dodgy as they're talking about deprecating that.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"import React, { Component } from 'react';\\nimport { findDOMNode } from 'react-dom';\\n\\nexport default function clicksOutside(WrappedComponent) {\\n  class clicksOutside extends Component {\\n    constructor(props) {\\n      super(props);\\n      this.setWrapperRef = this.setWrapperRef.bind(this);\\n      this.handleClickOutside = this.handleClickOutside.bind(this);\\n    }\\n    componentDidMount() {\\n      document.addEventListener('mousedown', this.handleClickOutside);\\n    }\\n    componentWillUnmount() {\\n      document.removeEventListener('mousedown', this.handleClickOutside);\\n    }\\n    setWrapperRef(node) {\\n      this.wrapperRef = node;\\n    }\\n    handleClickOutside(event) {\\n      const {target} = event;\\n      if (this.wrapperRef && target instanceof Node) {\\n        const ref = findDOMNode(this.wrapperRef);\\n        if (ref && !ref.contains(target) && this.props.active === true) {\\n          this.props.onClickOutside();\\n        }\\n      }\\n    }\\n    render() {\\n      return (\\n        <WrappedComponent {...this.props} ref={this.setWrapperRef} />\\n      );\\n    }\\n  };\\n  return clicksOutside;\\n}\\n\")), mdx(\"p\", null, \"Now we can use this as follows:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-javascript\"\n  }, \"import React, { Component } from 'react';\\nimport ReactDOM from 'react-dom';\\nimport Sidebar from './src/Components/Sidebar';\\nimport clicksOutside from './src/Components/clicksOutside';\\n\\nconst SidebarComponent = clicksOutside(Sidebar);\\n\\nfunction handleClickOutside() {\\n  alert('You have clicked outside');\\n}\\n\\nReactDOM.render(\\n  <SidebarComponent \\n    links={links} \\n    active={true} \\n    onClickOutside={handleClickOutside} \\n  />,\\n  document.getElementById('root')\\n);\\n\")), mdx(\"p\", null, \"Higher order components sound a lot harder than they actually are. In reality, they're actually quite simple to implement, but I'm not sure the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://reactjs.org/docs/higher-order-components.html\"\n  }, \"documentation\"), \" is necessarily the best example to use since it's a bit on the complex side.\"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"In the last few weeks I've been working on a big rebuild of the homepage of the legacy application I maintain. As I've been slowly transitioning it to use React on the front end, Iâ€¦","frontmatter":{"title":"Higher-order components in React","date":"16 February 2019","categories":["javascript","react"]},"fields":{"path":"/blog/2019/02/16/higher-order-components-in-react/"}}},"pageContext":{"previous":{"fields":{"path":"/blog/2019/02/02/creating-your-own-dependency-injection-container-in-php/"},"frontmatter":{"title":"Creating your own dependency injection container in PHP","date":"2019-02-02 21:45:52 +0100","layout":"post"}},"next":{"fields":{"path":"/blog/2019/02/20/searching-content-with-fuse-dot-js/"},"frontmatter":{"title":"Searching content with Fuse.js","date":"2019-02-20 17:25:58 +0000","layout":"post"}}}},"staticQueryHashes":["2909664151"]}