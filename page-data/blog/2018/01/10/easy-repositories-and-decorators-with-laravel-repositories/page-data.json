{"componentChunkName":"component---src-templates-post-tsx","path":"/blog/2018/01/10/easy-repositories-and-decorators-with-laravel-repositories/","result":{"data":{"site":{"siteMetadata":{"title":"Matthew Daly","siteUrl":"https://matthewdaly.co.uk"}},"mdx":{"id":"9816a54a-28af-56b2-8745-6c750894199f","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Easy repositories and decorators with Laravel Repositories\",\n  \"date\": \"2018-01-10 12:22:44 +0000\",\n  \"layout\": \"post\",\n  \"categories\": [\"php\", \"laravel\"],\n  \"comments\": true\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Creating repositories for your Laravel models, as well as creating caching decorators for them, is a useful way of not only implementing caching in your web app, but decoupling the application from a specific ORM. Unfortunately, it can involve writing a fair amount of boilerplate code.\"), mdx(\"p\", null, mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/matthewbdaly/laravel-repositories\"\n  }, \"Laravel Repositories\"), \" is a set of base classes and interfaces for creating repositories and decorators in your application. It consists of:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"A generic interface for repositories\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"A base repository that implements the interface and can be extended for your own repositories\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"A base decorator that also implements the interface and can similarly be extended\")), mdx(\"p\", null, \"By using these, not only are you able to implement caching quickly and easily for most use cases, but you can easily extend the base classes to add additional methods for your use case. By creating new interfaces that extend the base interface, then having your repositories extend the repository and decorator, you can minimise the amount of work required to set up new repositories.\"), mdx(\"p\", null, \"The main interface used is \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Matthewbdaly\\\\LaravelRepositories\\\\Repositories\\\\Interfaces\\\\AbstractRepositoryInterface\"), \", and your interfaces should extend this. Your decorators should extend \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Matthewbdaly\\\\LaravelRepositories\\\\Repositories\\\\Decorators\\\\BaseDecorator\"), \", and your repositories should extend \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Matthewbdaly\\\\LaravelRepositories\\\\Repositories\\\\Base\"), \". Then, if you add any additional methods to your interface and ensure your repository and decorator implement that interface, it should be straightforward to type-hint the interface and get back the decorated repository, which will handle caching for you.\"), mdx(\"p\", null, \"To be able to type-hint the repositories, you need to set them up in a service provider:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-php\"\n  }, \"<?php\\n\\nnamespace App\\\\Providers;\\n\\nuse Illuminate\\\\Support\\\\ServiceProvider;\\n\\nclass AppServiceProvider extends ServiceProvider\\n{\\n    /**\\n     * Bootstrap any application services.\\n     *\\n     * @return void\\n     */\\n    public function boot()\\n    {\\n        //\\n    }\\n\\n    /**\\n     * Register any application services.\\n     *\\n     * @return void\\n     */\\n    public function register()\\n    {\\n        $this->app->singleton('App\\\\Repositories\\\\Interfaces\\\\ExampleRepositoryInterface', function () {\\n            $baseRepo = new \\\\App\\\\Repositories\\\\EloquentExampleRepository(new \\\\App\\\\Example);\\n            $cachingRepo = new \\\\App\\\\Repositories\\\\Decorators\\\\ExampleDecorator($baseRepo, $this->app['cache.store']);\\n            return $cachingRepo;\\n        });\\n    }\\n}\\n\")), mdx(\"p\", null, \"Also, note that the cache backend used must be one that supports tags, such as Redis or Memcached. Data is cached using a tag derived from the model name. This also means you have to be careful when eager-loading relations, as the data will be cached under the main model's name, not that of the relation. You may want to set up separate model events to flush those tags when the related field is updated.\"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"Creating repositories for your Laravel models, as well as creating caching decorators for them, is a useful way of not only implementing caching in your web app, but decoupling theâ€¦","frontmatter":{"title":"Easy repositories and decorators with Laravel Repositories","date":"10 January 2018","categories":["php","laravel"]},"fields":{"path":"/blog/2018/01/10/easy-repositories-and-decorators-with-laravel-repositories/"}}},"pageContext":{"previous":{"fields":{"path":"/blog/2018/01/09/creating-laravel-helpers/"},"frontmatter":{"title":"Creating Laravel Helpers","date":"2018-01-09 17:26:26 +0000","layout":"post"}},"next":{"fields":{"path":"/blog/2018/01/10/adding-opensearch-support-to-your-site/"},"frontmatter":{"title":"Adding OpenSearch support to your site","date":"2018-01-10 22:07:27 +0000","layout":"post"}}}},"staticQueryHashes":["2909664151"]}