{"componentChunkName":"component---src-templates-post-tsx","path":"/blog/2018/06/23/forcing-ssl-in-codeigniter/","result":{"data":{"site":{"siteMetadata":{"title":"Matthew Daly","siteUrl":"https://matthewdaly.co.uk"}},"mdx":{"id":"fd7e53fe-6eb2-5678-8c76-6106cdfe150b","body":"var _excluded = [\"components\"];\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nfunction _objectWithoutProperties(e, t) { if (null == e) return {}; var o, r, i = _objectWithoutPropertiesLoose(e, t); if (Object.getOwnPropertySymbols) { var n = Object.getOwnPropertySymbols(e); for (r = 0; r < n.length; r++) o = n[r], t.indexOf(o) >= 0 || {}.propertyIsEnumerable.call(e, o) && (i[o] = e[o]); } return i; }\nfunction _objectWithoutPropertiesLoose(r, e) { if (null == r) return {}; var t = {}; for (var n in r) if ({}.hasOwnProperty.call(r, n)) { if (e.indexOf(n) >= 0) continue; t[n] = r[n]; } return t; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"title\": \"Forcing SSL in CodeIgniter\",\n  \"date\": \"2018-06-23 13:03:28 +0100\",\n  \"layout\": \"post\",\n  \"categories\": [\"php\", \"codeigniter\"],\n  \"comments\": true\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"I haven't started a new CodeIgniter project since 2014, and don't intend to, but on occasion I've been asked to do maintenance work on legacy CodeIgniter projects. This week I was asked to help out with a situation where a CodeIgniter site was being migrated to HTTPS and there were issues resulting from the migration.\"), mdx(\"p\", null, \"Back in 2012, when working on my first solo project, I'd built a website using CodeIgniter that used HTTPS, but also needed to support an affiliate marketing system that did not support it, so certain pages had to force HTTP, and others had to force HTTPS, so I'd used the hook system to create hooks to enforce this. This kind of requirement is unlikely to reoccur now because HTTPS is becoming more prevalent, but sometimes it may be easier to enforce HTTPS at application level than in the web server configuration or using htaccess. It's relatively straightforward to do that in CodeIgniter.\"), mdx(\"p\", null, \"The first step is to create the hook. Save this as \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"application/hooks/ssl.php\"), \":\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-php\"\n  }, \"<?php\\nfunction force_ssl()\\n{\\n    $CI =& get_instance();\\n    $CI->config->config['base_url'] = str_replace('http://', 'https://', $CI->config->config['base_url']);\\n    if ($_SERVER['SERVER_PORT'] != 443) redirect($CI->uri->uri_string());\\n}\\n?>\\n\")), mdx(\"p\", null, \"Next, we register the hook. Update \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"application/configs/hooks.php\"), \" as follows:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-php\"\n  }, \"<?php  if ( ! defined('BASEPATH')) exit('No direct script access allowed');\\n/*\\n| -------------------------------------------------------------------------\\n| Hooks\\n| -------------------------------------------------------------------------\\n| This file lets you define \\\"hooks\\\" to extend CI without hacking the core\\n| files.  Please see the user guide for info:\\n|\\n|   http://codeigniter.com/user_guide/general/hooks.html\\n|\\n*/\\n\\n$hook['post_controller_constructor'][] = array(\\n                                'function' => 'force_ssl',\\n                                'filename' => 'ssl.php',\\n                                'filepath' => 'hooks'\\n                                );\\n\\n/* End of file hooks.php */\\n/* Location: ./application/config/hooks.php */\\n\")), mdx(\"p\", null, \"This tells CodeIgniter that it should looks in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"application/hooks\"), \" directory for a file called \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ssl.php\"), \", and return the function \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"force_ssl\"), \".\"), mdx(\"p\", null, \"Finally, we enable hooks. Update \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"application/config/config.php\"), \":\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-php\"\n  }, \"$config['enable_hooks'] = TRUE;\\n\")), mdx(\"p\", null, \"If you only want to force SSL in production, not development, you may want to amend the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ssl.php\"), \" file to only perform the redirect in non-development environments, perhaps by using an environment variable via DotEnv.\"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"I haven't started a new CodeIgniter project since 2014, and don't intend to, but on occasion I've been asked to do maintenance work on legacy CodeIgniter projects. This week I wasâ€¦","frontmatter":{"title":"Forcing SSL in CodeIgniter","date":"23rd June 2018 12:03 pm","isoDate":"2018-06-23T12:03:28+00:00","categories":["php","codeigniter"]},"fields":{"path":"/blog/2018/06/23/forcing-ssl-in-codeigniter/"}}},"pageContext":{"previous":{"fields":{"path":"/blog/2018/06/03/logging-to-the-elk-stack-with-laravel/"},"frontmatter":{"title":"Logging to the ELK stack with Laravel","date":"2018-06-03 16:30:54 +0100","layout":"post"}},"next":{"fields":{"path":"/blog/2018/07/25/better-strings-in-php/"},"frontmatter":{"title":"Better strings in PHP","date":"2018-07-25 22:25:17 +0100","layout":"post"}}}},"staticQueryHashes":["1776624730","3528622268"]}